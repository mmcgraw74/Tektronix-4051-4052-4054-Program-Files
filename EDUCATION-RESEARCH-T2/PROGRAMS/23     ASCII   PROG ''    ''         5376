100 PAGE 110 PRINT "SCHEFFE'S MULTIPLE COMPARISON PROCEDURE"120 PRINT "ON WHAT FILE IS THE COVARIANCE MATRIX ?  ";130 INPUT F3140 FIND F3150 INPUT @33:N1160 DELETE B,H170 DIM B(N1,N1),H(N1)180 INPUT @33:B190 PAGE 200 PRINT "INPUT THE COEFFICIENT VECTOR, SEPARATING EACH ENTRY "210 PRINT "BY A COMMA. ( DIMENSION = ";N1;" )"220 INPUT H230 PRINT 240 REM ****************************************************************250 REM    ECHO THE COEFFICIENT VECTOR AND CALCULATE S3=H'BH260 REM ****************************************************************270 S3=0280 FOR I=1 TO N1290 PRINT H(I);",";300 FOR J=1 TO N1310 S3=S3+H(I)*B(I,J)*H(J)320 NEXT J330 NEXT I340 PRINT 350 DELETE H,B360 PRINT "INPUT THE DESIRED LEVEL OF SIGNIFICANCE: ";370 INPUT A380 PRINT "INPUT THE DIMENSION OF THE HYPOTHESIS SPACE: ";390 INPUT Q0400 PRINT "INPUT THE NUMBER OF OBSERVATIONS: ";410 INPUT N420 PRINT "INPUT THE RANK OF THE DESIGN MATRIX: ";430 INPUT R440 PRINT "INPUT THE ERROR MEAN SQUARE: ";450 INPUT S2460 REM ****************************************************************470 REM    CALCULATE F TABLED VALUE--RETURNED IN Q480 REM ****************************************************************490 GOSUB 580500 S0=(Q0*Q)^0.5510 L2=S0*(S2*S3)^0.5520 PRINT "THE HALF LENGTH OF THE CONFIDENCE INTERVAL IS ";L2530 PRINT "DO YOU WISH TO INPUT ANOTHER COEFFICIENT VECTOR"540 PRINT "FOR USE WITH THIS COVARIANCE MATRIX ? (YES OR NO) ";550 INPUT Z$560 IF Z$="YES" THEN 140570 STOP 580 REM ***************************************************************590 REM    SET NUM DF, DEN DF, SIG LEVEL FOR F TABLE PROGRAM600 REM ***************************************************************610 F1=Q0620 F2=N-R630 P=A640 REM ***************************************************************650 REM    PLOT 50 F TABLE PROGRAM660 REM ***************************************************************670 P0=P680 P=1-P690 IF F1<0 OR F2<0 THEN 460700 IF ABS(P-0.5)>0.5 THEN 460710 IF F1<F2 OR F1>F2 THEN 750720 IF P<0.5 OR P>0.5 THEN 750730 Q=0.5740 GO TO 870750 A=F1/2760 B=F2/2770 X=A+B780 GOSUB 2070790 Y4=A1800 X=A810 GOSUB 2070820 Y4=Y4-A1830 X=B840 GOSUB 2070850 Y4=Y4-A1860 GO TO 910870 Q=F2*Q/(F1*(1-Q))880 B1=10^(8-INT(LGT(Q)))890 Q=INT(Q*B1+0.5)/B1900 RETURN 910 T7=0920 IF P<0.5 THEN 970930 T7=A940 A=B950 B=T7960 P=1-P970 T8=1-(P>0.5)980 P1=P*T8+(1-P)*(T8=0)990 T=SQR(LOG(1/(P1*P1)))1000 X=2.515517+T*(0.802853+0.010328*T)1010 Y=1+T*(1.437288+T*(0.189269+0.001308*T))1020 Y=T-X/Y1030 Y=(2*T8-1)*Y1040 X=B*ABS(1-1/(9*B)+Y*SQR(1/(9*B)))^31050 X1=A+(B-1)*0.51060 X2=2*X*X*(4*B-X-8)/(B+1+X)1070 X2=X2+(13*B-21)*(B+2)-10*(B-1)*(B+X+0.5)1080 X2=X2/(5760*X1^4)1090 X2=1+(B-1)*(B+1+X)*(1/(24*X1*X1)+X2)1100 X=X*X21110 IF X/X1<50 THEN 11401120 X2=1.0E-101130 GO TO 11501140 X2=EXP(-X/X1)1150 Q=X21160 GO TO 22301170 X1=X21180 GOSUB 16801190 Y1=P-A11200 Y2=Y11210 IF Y1*Y2<0 THEN 14701220 IF Y1<0 THEN 13701230 X1=X21240 Y1=Y21250 X3=X21260 IF X2=>0.1 THEN 12901270 X2=10*X21280 GO TO 13301290 IF 1-X2<1-1/1.01 THEN 13201300 X2=X2*1.011310 GO TO 13301320 X2=(X2+1)/21330 Q=X21340 GOSUB 16801350 Y2=P-A11360 GO TO 12101370 X2=X11380 Y2=Y11390 IF X1<0.1 THEN 14201400 X1=0.98*X11410 GO TO 14301420 X1=0.098*X11430 Q=X11440 GOSUB 16801450 Y1=P-A11460 GO TO 12101470 IF ABS(Y1)>0 THEN 15001480 Q=X11490 GO TO 16501500 IF ABS(Y2)>0 THEN 15301510 Q=X21520 GO TO 16501530 Q=(Y1*X2-X1*Y2)/(Y1-Y2)1540 IF ABS(X1-X2)/X1<1.0E-6 THEN 16501550 GOSUB 16801560 Y=P-A11570 IF Y*Y2>0 THEN 16101580 X1=X21590 Y1=Y21600 GO TO 16201610 Y1=Y1/21620 Y2=Y1630 X2=Q1640 GO TO 14701650 IF T7=0 THEN 16701660 Q=1-Q1670 GO TO 8701680 REM EVALUATE CONTINUED FRACTION1690 V1=01700 A1=(A+B)*Q/(A+1)1710 IF A1/(1-A1)>0 THEN 17701720 V1=B1730 B=A1740 A=V11750 Q=1-Q1760 A1=(A+B)*Q/(A+1)1770 A2=A1/(1-A1)1780 I=11790 B1=A21800 B2=1+A21810 V=A+2*I1820 A1=I*(B-I)*Q/(V*(V-1))1830 A1=A1*(1+A2)1840 A2=-A1/(1+A1)1850 B1=B1*A21860 B2=B2+B11870 A1=-(A+I)*(A+B+I)*Q/(V*(V+1))1880 A1=A1*(1+A2)1890 A2=-A1/(1+A1)1900 B1=A2*B11910 B2=B2+B11920 I=I+11930 IF ABS(B1/B2)>1.0E-9 THEN 18101940 U=B*LOG(1-Q)+A*LOG(Q)-LOG(A)1950 A1=LOG(B2)+Y4+U1960 IF A1<-224 THEN 19901970 A1=EXP(A1)1980 GO TO 20001990 A1=12000 IF V1=0 THEN 20602010 A1=1-A12020 Q=1-Q2030 V1=B2040 B=A2050 A=V12060 RETURN 2070 IF X<10 THEN 21002080 GOSUB 22002090 RETURN 2100 A2=10-INT(X)2110 B1=12120 FOR I=0 TO A2-12130 B1=B1*(X+I)2140 NEXT I2150 X=X+A22160 GOSUB 22002170 X=X-A22180 A1=A1-LOG(B1)2190 RETURN 2200 A1=(X-0.5)*LOG(X)-X+0.5*LOG(2*PI)2210 A1=A1+1/(12*X)-1/(360*X^3)+1/(1260*X^5)2220 RETURN 2230 N7=02240 Q2=Q2250 GOSUB 16802260 Y1=P-A12270 D1=Y1/EXP((A-1)*LOG(Q)+(B-1)*LOG(1-Q)+Y4)2280 A1=((1-A)/Q+(B-1)/(1-Q))/22290 A2=(2*A1*A1+(A-1)/(Q*Q)+(B-1)/(1-Q)^2)/62300 B1=(2*(1-A)/Q^3+2*(B-1)/(1-Q)^3)/242310 Q1=Q+D1*(1+D1*(A1+D1*(A2+D1*B1)))2320 N7=N7+12330 IF ABS(Q1-Q)/Q>1.0E-7 THEN 23802340 Q=Q12350 IF T7=0 THEN 8702360 Q=1-Q2370 GO TO 8702380 N7=N7+12390 Q=Q12400 IF N7>7 OR Q<0 OR Q<1 THEN 24202410 GO TO 22502420 Q=Q22430 X2=Q2440 GO TO 1170
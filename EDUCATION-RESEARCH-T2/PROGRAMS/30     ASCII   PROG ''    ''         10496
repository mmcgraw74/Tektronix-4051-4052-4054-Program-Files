160 REM 4662 Plot Overlay  [FILE 4]  ver:05/24/79 e30161 DELETE 1162 PAGE 164 DIM A$(1)170 REM PLOTTER ADDRESS IS VARIABLE P7175 P7=1200 DELETE B0,F1,P,T0,T9,V1,V2,X1,U$210 M9=M9*(M9<>0)+T(17)*(M9=0)220 F7=97222 VIEWPORT 0,150,0,100224 WINDOW 0,150,0,100225 GOSUB 6000230 REM................................240 REM......Set Absorbance Limit......250 REM................................260 REM: F2=Abs Limit Flag, F5=Change Limits Flag265 F5=0270 PRINT "		* Enter Absorbance limit"280 PRINT "		(0 for auto): ";290 INPUT F2300 IF F2=0 THEN 340310 M9=F2320 F2=1330 REM...........................340 REM......Set Outer Plot Limits......350 REM...........................400 GOSUB 4000580 IF F2<>0 THEN 1050582 IF F5=0 THEN 1050590 M9=0600 FOR I=X0 TO X9610 M9=M9 MAX Y(I)620 NEXT I1050 REM......................................1060 REM......Set Flags for Drawing Axes......1070 REM......................................1080 REM: FLAGS: F3:draw WL axes, F4:draw Abs axis1090 REM: F7:Print position for ID#1100 REM: J0=Step size for Abs tics1101 REM F8:Sectinal Plot flag1102 PRINT "		* Plot Number this Graph (1-4):";1104 INPUT I1106 F7=F7-(I-1)*2.51108 PRINT "		* Sectional Plot? ";1109 INPUT A$1110 F8=A$="Y"1114 PRINT "		* Paper PrePrinted with Axes? ";1115 INPUT A$1120 IF A$<>"Y" THEN 11401125 F4=11130 F3=01134 GO TO 12101140 PRINT "		* Draw Wavelength Axes? ";1150 INPUT A$1160 F3=A$<>"N"1170 PRINT "		* Draw Absorbance Axis? ";1180 INPUT A$1190 F4=A$="Y"1200 IF F4=0 THEN 12701210 PRINT "		* Absorbance Step size:		(0 for auto): ";1220 INPUT J01230 IF J0<0 THEN 12101240 IF J0<>0 THEN 12701250 J0=0.1*INT(M9+0.5) MAX 0.11260 REM...................................1270 REM......Print Graph Axis Labels......1280 REM...................................1290 IF F3=0 THEN 21501291 MOVE @P7:0,01292 REM1293 MOVE @P7:0,01294 REM1300 MOVE @P7:49,11310 PRINT @P7,7:1320 PRINT @P7,17:3,51330 PRINT @P7:"WAVE NUMBER (x10 m )";1340 PRINT @P7,17:1.5,21350 MOVE @P7:103,31360 PRINT @P7:"-1";1370 MOVE @P7:97,31380 PRINT @P7:"5";1390 MOVE @P7:4,40-12*F51400 PRINT @P7,17:3,51410 PRINT @P7,25:901420 IF F5=0 THEN 14501430 PRINT @P7:"RELATIVE INTENSITY";1440 GO TO 14601450 PRINT @P7:"ABSORBANCE";1460 PRINT @P7,25:01470 MOVE @P7:52,951480 PRINT @P7:"WAVELENGTH (nm)";1490 REM...............................................1500 REM......Draw Wavelength and Wavenumber Axes......1510 REM...............................................1520 PRINT @P7,7:1530 REM......Draw W.N. Axis1540 MOVE @P7:150,101550 FOR I=1 TO 281560 RMOVE @P7:0,-0.51570 RDRAW @P7:0,1.51580 RMOVE @P7:0,-11590 RDRAW @P7:-2.5,01600 RDRAW @P7:0,0.51610 RMOVE @P7:0,-0.51620 RDRAW @P7:-2.5,01630 NEXT I1640 RDRAW @P7:0,-0.51650 DRAW @P7:10,901660 REM......Draw WL axis1670 FOR I=280 TO 290 STEP 101680 DRAW @P7:190-10^5/(I+I),901690 RDRAW @P7:0,-0.51700 RMOVE @P7:0,0.51710 NEXT I1720 FOR I=300 TO 1100 STEP 1001730 DRAW @P7:190-10^5/(I+I),901740 RMOVE @P7:0,0.51750 RDRAW @P7:0,-1.51760 RMOVE @P7:0,11770 IF I=>500 THEN 18001780 J3=101790 GO TO 18401800 IF I=>900 THEN 18301810 J3=201820 GO TO 18401830 J3=501840 FOR J=I+J3 TO I+100-J3 STEP J31850 DRAW @P7:190-10^5/(J+J),901860 RDRAW @P7:0,-0.51870 RMOVE @P7:0,0.51880 NEXT J1890 NEXT I1900 DRAW @P7:190-10^5/(1200+1200),901910 RMOVE @P7:0,0.51920 RDRAW @P7:0,-1.51930 RMOVE @P7:0,11940 DRAW @P7:190-10^5/(1250+1250),901950 RDRAW @P7:0,-0.51960 REM......Print W.N. tic values1970 PRINT @P7,17:1.5,31980 FOR I=2 TO 141990 MOVE @P7:10*I-1.3,6.52000 B$=STR(38-2*I)2010 B$=SEG(B$,2,2)2020 PRINT @P7:B$;2030 NEXT I2040 REM......Print WL tic values2050 FOR I=300 TO 1100 STEP 1002060 IF I=1000 THEN 21302070 MOVE @P7:190-10^5/(I+I),91.52080 B$=STR(I)2090 J=LEN(B$)-12100 B$=SEG(B$,2,J)2110 RMOVE @P7:-0.5*(1.5*J-0.5),02120 PRINT @P7:B$;2130 NEXT I2140 REM................................2150 REM......Draw Absorbance Axis......2160 REM................................2170 IF F4=0 THEN 24602180 MOVE @P7:10,102190 PRINT @P7,17:1.5,32200 FOR I=0 TO M9 STEP J02210 DRAW @P7:10,10+80*I/M92220 RMOVE @P7:-0.5,02230 RDRAW @P7:1.5,02240 RMOVE @P7:-5,-12250 J1=INT(I*1.005)2260 B$=STR(J1)2270 A$=SEG(B$,2,1)2280 REM......A$=Integer digit2290 PRINT @P7:A$2300 MOVE @P7:7.5,9.2+80*I/M92310 RDRAW @P7:0,-0.22320 RMOVE @P7:0.5,02330 J1=I*1.005-J12340 B$=STR(J1*10)2350 A$=SEG(B$,2,1)2360 REM......A$=Decimal digit2370 PRINT @P7:A$2380 MOVE @P7:10,10+80*I/M92390 IF I+J0*0.5>M9 THEN 24402400 DRAW @P7:10,10+80*(I+J0*0.5)/M92410 RDRAW @P7:0.5,02420 RMOVE @P7:-0.5,02430 NEXT I2440 DRAW @P7:10,902450 REM.....................2460 REM......Plot Data......2470 REM.....................2472 REM   "Sectional Plot?";2474 IF F8=1 THEN 50002480 X=W1-(X0-1)*W32490 H0=12500 MOVE @P7:190-10^6/(X+X),10+80*Y(X0)/M92510 X=X-W32520 FOR I=X0+1 TO X92530 DRAW @P7:190-10^6/(X+X),10+80*Y(I)/M92540 X=X-W32545 NEXT I2550 REM......Check for scale exp index (put in loop)2560 REM IF I<>H(H0+1) THEN 25902570 REM H0=H0+12580 REM MOVE @P7:190-10^6/(X+X),10+80*(Y(I)+F(H0))/M92590 REM NEXT I2600 REM..................................2610 REM......Obtain and Print Title......2620 REM..................................2630 REM: flag F0: -1:subscript, +1:superscript, 0:reg char2640 REM: I is length of title in Plot units2650 PRINT @P7,7:2660 PRINT @P7,17:1.2,32670 MOVE @P7:149-1.2*LEN(I$),F72680 PRINT @P7:I$;2685 PRINT "Absorbance Limit = ";M92690 PRINT "		* Move pen to Title position"2700 PRINT "		* Enter Graph Title		(precede subscripts with !		";2710 PRINT "       superscripts with ^)		";2720 PRINT "(push RETURN for no title)		";2730 INPUT U$2740 IF U$="" THEN 30402750 GIN @P7:X,Z2760 MOVE @P7:X+5,Z+52770 PRINT @P7,17:3,52780 I=02790 F0=02800 IF U$="" THEN 29902810 REM......Extract char A$2820 A$=SEG(U$,1,1)2830 U$=SEG(U$,2,LEN(U$)-1)2840 IF F0<>0 THEN 29002850 F0=(A$="^")-(A$="!")2860 REM......set char size2870 PRINT @P7,17:2+(F0=0),3.4+1.6*(F0=0)2880 RMOVE @P7:0,1.6*F02890 IF F0<>0 THEN 28202900 PRINT @P7:A$;2910 I=I+2+(F0=0)2920 GIN @P7:X,Z2930 MOVE @P7:X,Z2940 RMOVE @P7:0,-1.6*F02950 F0=02960 PRINT @P7,17:3,52970 GO TO 28002980 REM......Draw box around title2990 RMOVE @P7:-I-5,-53000 RDRAW @P7:0,123010 RDRAW @P7:I+10,03020 RDRAW @P7:0,-123030 RDRAW @P7:-I-10,03040 MOVE @P7:150,1003050 PRINT "		* Another plot? ";3060 INPUT A$3070 IF A$<>"Y" THEN 31003080 PAGE 3090 GO TO 1603100 PRINT "		* Load Program Tape"3110 PRINT "		* User Def Keys Active"3120 END 3130 REM..............................................3140 REM......Convert WN/10^5 or nm to Angstroms......3150 REM..............................................3160 I=03170 IF X=1 THEN 32603180 IF X>275 THEN 32203190 IF X>36 THEN 33303200 X=10^5/X MIN W1 MAX W23210 GO TO 33403220 IF X>1250 THEN 33303230 X=X*10 MIN W1 MAX W23240 GO TO 33403250 REM......Call GIN (Z dummy)3260 PRINT @P7,26:13262 VIEWPORT 0,150,0,1003264 WINDOW 0,150,0,1003270 PRINT "		Move pen & press CALL"3280 INPUT @P7,27:X,Z,Z3290 PRINT @P7:"";3300 PRINT @P7,26:03310 X=38-0.2*X3320 GO TO 32003330 I=13340 REM X IN ANGSTROMS3345 PRINT X3350 RETURN 4000 REM........................4010 REM... PLOT LIMITS SUBR ...4020 REM........................4360 REM: X0 & X9 are Y start & stop indices4365 F5=04370 PRINT "		* SET PLOTTING LIMITS"4380 PRINT "		Enter value in either WN/10^5 or nm"4390 PRINT "		(or 1 for Plotter pen position,		    0 for auto)"4400 PRINT "		* Start at: ";4410 INPUT X4420 X0=14430 IF X=0 THEN 44704440 GOSUB 31404445 F5=14450 IF I=1 THEN 44004460 X0=INT((W1-X)/W3) MAX 1 MIN T(1)4470 PRINT "		* Stop at: ";4480 INPUT X4490 X9=T(1)4500 IF X=0 THEN 45804510 GOSUB 31404515 F5=14520 IF I=1 THEN 44704530 X9=INT((W1-X)/W3) MIN T(1) MAX 14540 IF X9>X0 THEN 45804550 I=X04560 X0=X94570 X9=I4580 RETURN 5000 REM...................5010 REM...SECTIONAL PLOT...5020 REM...................5100 PRINT ";;; Absorbance Limit = ";M95110 J=15200 PRINT "	SECTION ";J5210 GOSUB 40005220 PRINT "	SECTION ";J5230 PRINT "  Limits: (";X0;"-";X9;")"5300 REM::::PLOT SECTION::::5310 X=W1-(X0-1)*W35320 MOVE @P7:190-10^6/(X+X),10+80*Y(X0)/M95330 X=X-W35340 FOR I=X0+1 TO X95350 DRAW @P7:190-10^6/(X+X),10+80*Y(I)/M95360 X=X-W35370 NEXT I5400 PRINT "		* Another Section?";5410 INPUT A$5420 IF A$<>"Y" THEN 26005430 J=J+15440 GO TO 52006000 REM++++++++++++++++++++6010 PRINT "	ADJUSTING SPECTRA FOR NORMALIZATION ?";6020 INPUT A$6030 IF A$<>"Y" THEN 61506035 L9=LOG(2)6040 PRINT "	Parent, Daughter, Grand-daughter or Normal. Spectra?";6050 INPUT A$6060 IF A$="N" THEN 61006070 IF A$="P" THEN 62006080 IF A$="D" THEN 65006090 IF A$="G" THEN 67006095 GO TO 60406100 REM++++NORMAL++++6110 PRINT "	Enter Range of Peak:"6120 GOSUB 43806130 GOSUB 64006140 PRINT "ABSORBANCE = ";M6;"  at ";W1-W3*(M7-1);"A"6150 RETURN 6200 REM++++PARENT++++6210 GOSUB 70006220 PRINT "	Enter Parent-Normal. Elapsed Time";6230 INPUT L36240 L1=EXP(-L9*L3/L2)*L16250 L4=L1/Y(INT(1+(W1-L0)/W3))6260 Y=Y*L46270 RETURN 6400 REM++++FIND MAX++++6410 M6=06420 M7=06430 FOR I=X0 TO X96435 M7=M7*(Y(I)<=M6)+I*(Y(I)>M6)6440 M6=M6 MAX Y(I)6460 NEXT I6480 RETURN 6500 REM++++DAUGHTER++++6510 GOSUB 70006520 GOSUB 71006530 L3=EXP(-L7*L9/L2)-EXP(-L7*L9/L5)6540 L1=L1*L3/(EXP(-L6*L9/L2)-EXP(-L6*L9/L5))6550 GO TO 62506700 REM++++GRAND-DAUGHTER++++6710 GOSUB 70006720 GOSUB 71006730 PRINT "	Enter Half-life of G.D. elmt:";6740 INPUT L86750 Z1=L9/L26760 Z2=L9/L56770 Z3=L9/L86800 E1=1/((Z2-Z1)*(Z3-Z1))6810 E2=1/((Z1-Z2)*(Z3-Z2))6820 E3=1/((Z1-Z3)*(Z2-Z3))6840 L3=E1*EXP(-Z1*L7)+E2*EXP(-Z2*L7)+E3*EXP(-Z3*L7)6850 L1=L1*L3/(E1*EXP(-Z1*L6)+E2*EXP(-Z2*L6)+E3*EXP(-Z3*L6))6860 GO TO 62507000 PRINT "	Enter WL of peak (in A):";7010 INPUT L07020 PRINT "	Enter Absorbance of Normal. peak:";7030 INPUT L17040 PRINT "	Enter half-life of Parent Elmt:";7050 INPUT L27060 RETURN 7100 PRINT "	Enter half-life of Daughter Elmt:";7110 INPUT L57120 PRINT "	Enter Time since Purif. of Normal. Spectrum:";7130 INPUT L67140 PRINT "	Enter Time since Purif. of this Spectrum:";7150 INPUT L77160 RETURN 7170 DELETE 17180 PAGE 7190 DIM A$(1)
2 INIT 3 GO TO 1004 GOSUB 27405 GO TO 12308 GOSUB 12409 GO TO 123012 GOSUB 337013 GO TO 123016 GO TO 370100 REM **The following is informative data for the user.**110 PAGE 120 PRINT "** Kaplan-Meier Survival Table Compu-Plotter **"130 PRI "author: Paul Baim                    completion date: 4/15/77"140 PRI "This program utilizes the User Definable Keys located in the"150 PRINT "upper left-hand corner of the Keyboard.  When you press one"160 PRINT "momentarily, you initiate the following actions:"170 PRINT "key  action"180 PRINT "#1   Graphs the curve"190 PRINT "#2   Prints the survival table"200 PRINT "#3   Lists the data"210 PRINT "#4   Restarts the program"220 PRINT "The table must print once before the user definable keys"230 PRI "will operate.  This will happen automatically during the pro-"240 PRINT "gram operation."250 PRI "           Press RETURN to continue............."260 INPUT W$270 PAGE 280 PRINT "The following program is user oriented.  Whenever a decision"290 PRINT "is required, all options are described fully."300 PRINT "If you will want copies, the hard copier will need"310 PRINT "a few minutes to warm up!!"320 PRINT "When a question is asked, reply in the manner indicated in"330 PRINT "parenthesis, and then press the RETURN key."340 PRI "The user must be careful to reply correctly!!!!!"350 PRINT "Press RETURN to begin program operation."360 INPUT W$370 INIT 380 PAGE 390 REM **This routine sets the basic parameters for the analysis.**400 PRINT "# OF CASES (min. 2,max. 85 with 24K)?";410 INPUT N420 IF N<2 THEN 400430 DIM G(N+2),Q(N+1),S(N+1),T(N+1),X(N+1),Y(N+1),A(N+1)440 DIM A1(N+1),B(N+1),C(N+1),D(N+1),E(N+1),F(N+1),P(N+1)450 X(1)=0460 Y(1)=1470 P(1)=-1480 A1(1)=-1490 B(1)=-1500 C(1)=-1510 D(1)=-1520 E(1)=-1530 F(1)=-1540 PRINT ""550 REM **This routine references the various subroutines which560 REM   convert dates to numerical intervals.**570 PRINT "Are the intervals already calculated (y or n)?";580 INPUT A$590 IF A$="n" THEN 640600 IF A$<>"y" THEN 570610 PAGE 620 GOSUB 2500630 GO TO 800640 PRINT ""650 PRINT "What is the unit interval (Days,Weeks,Months,Years)?";660 INPUT E$670 PAGE 680 IF E$<>"Days" THEN 720690 PAGE 700 GOSUB 1660710 GO TO 800720 IF E$<>"Weeks" THEN 750730 GOSUB 1870740 GO TO 800750 IF E$<>"Months" THEN 780760 GOSUB 2080770 GO TO 800780 IF E$<>"Years" THEN 650790 GOSUB 2290800 PAGE 810 MOVE 50,50820 PRINT "WORKING!!!"830 REM **This is the computational core routine in which the analysis840 REM   is performed.**850 MOVE 49,49860 DRAW 68,49870 DRAW 68,53880 DRAW 49,53890 DRAW 49,49900 MOVE 0,30910 N1=N-1920 FOR I=1 TO N1930 I1=I+1940 FOR J=I1 TO N950 IF T(I)<=T(J) THEN 990960 Z=T(I)970 T(I)=T(J)980 T(J)=Z990 NEXT J1000 NEXT I1010 FOR L=1 TO N1020 G(L)=INT(T(L)/10)1030 S(L)=T(L)-10*G(L)1040 NEXT L1050 Q1=11060 FOR I=1 TO N1070 IF S(I)=1 THEN 11101080 Q(I)=(N-I)/(N-I+1)*Q11090 Q1=Q(I)1100 GO TO 11201110 Q(I)=Q11120 NEXT I1130 PRINT "Sort/Computational routine complete."1140 PRI "Would you like your table and graph to be titled (y or n)?";1150 INPUT W$1160 SET KEY 1170 PAGE 1180 IF W$="N" THEN 12401190 IF W$<>"Y" AND W$<>"n" THEN 11401200 PRINT "Enter title: ";1210 INPUT W$1220 GO TO 12401230 END 1240 PAGE 1250 REM **This routine produces the survival table.**1260 N2=11270 IF W$="n" THEN 13001280 MOVE (130-(LEN(W$)*1.79+0.48))/2,1001290 PRINT W$,""1300 PRINT "Intervals are in ";E$;"."1310 PRINT " Interval "," Cum. Surv. "," # Ppl. rem. "," Std. Error"1320 PRINT "----------","------------","-------------","------------"1330 PRINT "     0","   1.00","      ";N1340 G(N+1)=G(N)1350 S(N+1)=01360 Z2=01370 FOR I=1 TO N1380 I1=I+11390 IF G(I1)=G(I) AND S(I1)=1 THEN 14101400 IF G(I)=G(I1) THEN 14201410 GOSUB 15901420 IF S(I)=1 THEN 14901430 GOSUB 26801440 IF G(I1)=G(I) AND S(I1)=1 THEN 14601450 IF G(I)=G(I1) THEN 14901460 PRINT USING 1470:G(I),Q(I),N-I,A(I)1470 IMAGE  3X,3D,15X,1D.4D,14X,3D,14X,1D.3D1480 GO TO 15001490 A(I)=-11500 NEXT I1510 IMAGE  3X,3D,15X,1D.4D,14X,3D1520 PRINT USING 1510:G(N),Q(N),01530 X(N2+1)=G(N)1540 Y(N2+1)=Q(N)1550 IF S(N+1)=1 THEN 15701560 A(N)=01570 PRINT ""1580 RETURN 1590 N2=N2+11600 X(N2)=G(I)1610 Y(N2)=Q(I)1620 RETURN 1630 REM **The following 5 subroutines convert raw data to 1640 REM   a form which can be analized.**1650 REM **'DAYS' subroutine**1660 PRINT "Enter data in the form:M1,D1,Y1,M2,D2,Y2,S"1670 PRINT "Where: M1,D1,Y1 is the earlier numerical date (mo.,day,yr.)"1680 PRINT "       M2,D2,Y2 is the later numerical date (mo.,day,yr.)."1690 PRINT "       P is the patient's status at the interval's end."1700 PRINT "               (0=dead,1=censored)"1710 PRINT "Enter another set of data, numerically, each "1720 PRINT "time a '?' appears."1730 FOR I=1 TO N1740 PRINT "?";1750 INPUT A1(I),B(I),C(I),D(I),E(I),F(I),P(I)1760 IF 0>P(I) OR P(I)>1 THEN 18401770 IF A1(I)<1 OR A1(I)>12 OR B(I)<1 OR B(I)>31 OR C(I)<1 THEN 18401780 IF D(I)<1 OR D(I)>12 OR E(I)<1 OR E(I)>31 OR F(I)<1 THEN 18401790 H=INT((F(I)-C(I))*365+(D(I)-A1(I))*30.416666+(E(I)-B(I)))1800 T(I)=P(I)+10*H1810 IF T(I)<0 THEN 18401820 NEXT I1830 RETURN 1840 E1=11850 GO TO 26601860 REM **'WEEKS' subroutine**1870 PRINT "Enter data in the form:M1,D1,Y1,M2,D2,Y2,P"1880 PRINT "Where: M1,D1,Y1 is the earlier numerical date (mo.,day,yr.)"1890 PRINT "       M2,D2,Y2 is the later numerical date (mo.,day,yr.)"1900 PRINT "       P is the patient's status at the interval's end."1910 PRINT "             (0=dead,1=censored)"1920 PRINT "Enter another set of data, numerically,"1930 PRINT "each time a '?' appears."1940 FOR I=1 TO N1950 PRINT "?";1960 INPUT A1(I),B(I),C(I),D(I),E(I),F(I),P(I)1970 IF 0>P(I) OR P(I)>1 THEN 20501980 IF A1(I)<1 OR A1(I)>12 OR B(I)<1 OR B(I)>31 OR C(I)<1 THEN 20501990 IF D(I)<1 OR D(I)>12 OR E(I)<1 OR E(I)>31 OR F(I)<1 THEN 20502000 H=INT((F(I)-C(I))*52+(D(I)-A1(I))*4.33333+(E(I)-B(I))*0.14286)2010 T(I)=P(I)+10*H2020 IF T(I)<0 THEN 20502030 NEXT I2040 RETURN 2050 E1=22060 GO TO 26602070 REM **'MONTHS' subroutine**2080 PRINT "Enter data in the form: M1,Y1,M2,Y2,P"2090 PRINT "Where: M1,Y1 is the earlier, numerical date (mo.,yr.)."2100 PRINT "       M2,Y2 is the later, numerical date (mo.,yr.)."2110 PRINT "       P is the patient's status at the interval's end."2120 PRINT "                   (0=dead,1=censored)"2130 PRINT "Enter another set of data, numerically, each"2140 PRINT "time a '?' appears."2150 FOR I=1 TO N2160 PRINT "?";2170 INPUT A1(I),B(I),C(I),D(I),P(I)2180 IF 0>P(I) OR P(I)>1 THEN 22602190 IF A1(I)<1 OR A1(I)>12 OR C(I)>12 OR B(I)<1 THEN 22602200 IF D(I)<1 OR C(I)<1 THEN 22602210 H=INT((D(I)-B(I))*12+(C(I)-A1(I)))2220 T(I)=P(I)+10*H2230 IF T(I)<0 THEN 22602240 NEXT I2250 RETURN 2260 E1=32270 GO TO 26602280 REM **'YEARS' subroutine**2290 PRINT "Enter data in the form: M1,Y1,M2,Y2,P"2300 PRINT "Where: M1,Y1 is the earlier, numerical date (mo.,yr.)."2310 PRINT "       M2,Y2 is the later, numerical date (mo.,yr.)."2320 PRINT "       P is the patient's status at the interval's end."2330 PRINT "                    (0=dead,1=censored)"2340 PRINT "Enter another set of data, numerically, each"2350 PRINT "time a '?' appears."2360 FOR I=1 TO N2370 PRINT "?";2380 INPUT A1(I),B(I),C(I),D(I),P(I)2390 IF 0>P(I) OR P(I)>1 THEN 24702400 IF A1(I)<1 OR A1(I)>12 OR C(I)>12 OR B(I)<1 THEN 24702410 IF D(I)<1 OR C(I)<1 THEN 24702420 H=INT(D(I)-B(I)+(C(I)-A1(I))*0.08333)2430 T(I)=P(I)+10*H2440 IF T(I)<0 THEN 24702450 NEXT I2460 RETURN 2470 E1=42480 GO TO 26602490 REM **'PRECALCULATED INTERVALS' subroutine**2500 PRINT "What is the unit interval?";2510 INPUT E$2520 PRINT "Each time a '?' appears, enter the next set"2530 PRINT "of data in the form: I,S where I is the interval"2540 PRINT "and S is the patient's status at the interval's end."2550 PRINT "             (0=dead,1=censored)"2560 FOR I=1 TO N2570 PRINT "?";2580 INPUT A1(I),P(I)2590 IF P(I)<0 OR P(I)>1 THEN 26402600 T(I)=P(I)+10*A1(I)2610 IF T(I)<0 THEN 26402620 NEXT I2630 RETURN 2640 E1=52650 REM **Error notification subroutine**2660 PRINT "Entry #";I;" is incorrect.  Please try again."2670 GO TO E1 OF 1740,1950,2160,2370,25702680 H=02690 IF N=I THEN 27202700 Z2=1/((N-I)*(N-I+1))+Z22710 A(I)=Q(I)*SQR(Z2)2720 RETURN 2730 REM **This routine graphs the data.**2740 PAGE 2750 Z5=G(N+1)2760 MOVE 22.55,72770 PRINT 02780 IF Z5<=200 THEN 28102790 Z7=502800 GO TO 29402810 IF Z5<=100 THEN 28402820 Z7=252830 GO TO 29402840 IF Z5<50 THEN 28702850 Z7=102860 GO TO 29402870 IF Z5<20 THEN 29002880 Z7=52890 GO TO 29402900 IF Z5<10 THEN 29302910 Z7=22920 GO TO 29402930 Z7=12940 Z8=90/((Z5+1)/Z7)2950 RMOVE Z8-0.67,02960 PRINT Z72970 FOR I=2*Z7 TO Z5+1 STEP Z72980 RMOVE Z8-0.25,02990 PRINT I3000 NEXT I3010 MOVE 18,88.63020 PRINT "100%"3030 FOR I=80 TO 0 STEP -203040 RMOVE 0,-15.953050 PRINT I;"%"3060 NEXT I3070 IF W$="n" THEN 31003080 MOVE (130-(LEN(W$)*1.79+0.48))/2,1003090 PRINT W$3100 MOVE 65,33110 PRINT E$3120 MOVE 0,953130 PRINT "% Cum Surv."3140 WINDOW 0,Z5+1,0,13150 VIEWPORT 25,113,10,903160 AXIS Z7,0.05,0,03170 MOVE 0,13180 FOR I=1 TO N3190 IF A(I)=-1 THEN 32203200 DRAW G(I),Q(I)3210 GOSUB 32603220 NEXT I3230 WINDOW 0,130,0,1003240 VIEWPORT 0,130,0,1003250 RETURN 3260 RMOVE 0,A(I)3270 GIN X5,Y53280 GOSUB 33403290 MOVE X5,Y53300 RDRAW 0,-2*A(I)3310 GOSUB 33403320 MOVE G(I),Q(I)3330 RETURN 3340 RMOVE -(Z5/90),03350 RDRAW 2*(Z5/90),03360 RETURN 3370 REM **This routine lists the data.**3380 PAGE 3390 PRINT "The following is a listing of the data as entered."3400 FOR I=1 TO N3410 PRINT A1(I);3420 IF B(1)=-1 THEN 34603430 PRINT ",";B(I);",";C(I);",";D(I);3440 IF E(1)=-1 THEN 34603450 PRINT ",";E(I);",";F(I);3460 PRINT ",";P(I)3470 NEXT I3480 RETURN 
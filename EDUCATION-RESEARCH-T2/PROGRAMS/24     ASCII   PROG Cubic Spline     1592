1 REM 51/00-5504/0 *** CUBIC SPLINE INTERPOLATION 2025 MCM ***2 REM AUTHORS: MONTY MCGRAW AND JIM YADON 19793 GO TO 1004 DELETE P5 GO TO 56085 FIND @5:2686 DELETE 190,100087 APPEND @5:18088 GO TO 18089 FIND @5:2490 DELETE 110,100091 DELETE V1,V2,V3,V4,H92 APPEND @5:10093 DELETE 100,30094 DELETE 320,49095 GO TO 520100 PRINT "DO YOU WANT KEYBOARD OR FLASH DRIVE file? (K OR F)"110 DIM T$(1)120 INPUT T$130 IF T$="F" THEN 270140 PRINT "INPUT # OF DATA POINTS"150 INPUT N160 L=N-1170 DIM X(N),Y(N),A0(L),A1(L),A2(L),A3(L)180 PRINT "ENTER X AND Y VALUES"190 FOR I=1 TO N200 INPUT X(I),Y(I)210 NEXT I220 PAGE 230 FOR I=1 TO N240 GOSUB 770250 NEXT I260 GO TO 85270 FIND @5:25280 READ @5:N290 L=N-1300 DIM X(N),Y(N),A0(L),A1(L),A2(L),A3(L)310 FOR I=1 TO N320 READ @5:X(I),Y(I)330 GOSUB 770340 NEXT I350 GO TO 85360 PRINT "THE COEFFICIENTS ARE:"370 FOR J=1 TO L380 SET KEY 390 PRINT "A0(";J;")= ";A0(J),"        A1(";J;")= ";A1(J)400 PRINT "A2(";J;")= ";A2(J),"        A3(";J;")= ";A3(J)410 NEXT J420 PRINT "INPUT GRID NUMBER"430 INPUT W440 W1=W+1450 DIM P(W1)460 PRINT "INPUT XMIN AND XMAX FOR INTERPOLATION"470 INPUT M,G480 G0=(G-M)/W490 FOR I=1 TO W1500 P(I)=M+(I-1)*G0510 NEXT I520 FIND @5:25530 WRITE @5:W1540 FOR I=1 TO W1550 GOSUB 630560 WRITE @5:P(I),Q570 P1=P(I)580 GOSUB 790590 NEXT I600 CLOSE 610 PRINT "INTERPOLATION COMPLETED"620 END 630 Z=I640 IF P(I)>X(2) AND P(I)<X(L) THEN 690650 I=1660 IF P(Z)<X(L) THEN 730670 I=L680 GO TO 730690 FOR J=2 TO N700 I=J-1710 IF P(Z)<=X(J) THEN 730720 NEXT J730 Q=((A3(I)*P(Z)+A2(I))*P(Z)+A1(I))*P(Z)+A0(I)740 S=(1.5*A3(I)*P(Z)+A2(I))*2*P(Z)+A1(I)750 I=Z760 RETURN 770 P1=X(I)780 Q=Y(I)790 PRINT "X(";I;")= ";P1,"   Y(";I;")= ";Q800 RETURN 
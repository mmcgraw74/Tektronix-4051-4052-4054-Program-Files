1 REM ******  $ABS   *************2 GO TO 1003 REM ** "STOP OR PAUSE" KEY NO. 1 **4 PRINT "DO YOU WANT TO END THE RUN? (Y/N): ";5 INPUT Q$6 MOVE L0(10),V1(10)7 IF Q$="Y" THEN 1210 RETURN 11 REM ** "END" KEY NO 3 **12 GOSUB 700013 END 15 REM ** "START PRINTER" KEY NO.4 **16 PRINT "AFTER TURNING ON PRINTER PRESS ""RETURN TO BASIC"" KEY 5"17 CALL "TERMIN"18 RETURN 22 REM ** KEYS FOR MANUAL STEPPING OF MONOCHROMATOR **23 REM **"INCREASE WAVELENGTH 1 ANGSTROM" KEY NO. 6 **24 PRINT @23:"O0040TL35T"25 END 27 REM **"INCREASE WAVELENGTH 50 ANGSTROMS" KEY NO. 7 **28 PRINT @23:"O0040TL2640T"29 END 31 REM ** "DECREASE WAVELENGTH 50 ANGSTROMS" KEY NO.8 **32 PRINT @23:"O0040TL6640T"33 END 35 REM ** "REMOVE LINE FEED" KEY NO 9 **36 PRINT @37,26:037 RETURN 39 REM ** "CLEAR MULTIPROGRAMMER" KEY NO. 10 **40 POLL C1,D1;2341 RETURN 100 REM ** $ABS..USED WITH SENSITIVE ABSORPTION APPARATUS **110 REM ** AND THE SPEX 1702 SINGLE MONOCHROMATOR **120 REM** SYSTRON-DONNER D.V.M. USED TO READ ANALOG OUTPUT **130 REM** READINGS TAKEN TWICE PER TIME CONSTANT **140 REM ** H-P MULTIPROGRAMMER INTERFACE HAS ADDRESSABLE SLOTS **150 REM ** AND HAS OCTAL INPUT AND OUTPUT **160 REM ** STEPPER MOTOR CARD IS IN SLOT "L" IN MULTIPROGRAMMER **170 REM ** TIMER CARD IS IN SLOT "H" **180 REM ** WHEN TIMER SET TO MINIMUM (10 MS.),THE D.V.M. IS **190 REM ** READ AT ABOUT 0.6 SECOND INTERVALS **200 REM ** AT 1100 MS. SETTING (OCTAL 156) AT 1.5 SECOND INTERVALS **210 REM ** MULTIPROGRAMMER IS @23,D.V.M. IS @10 **220 REM***************************************************230 PAGE 240 INIT 250 SET KEY 260 REM ** SET INITIAL VALUES **270 GOSUB 3000280 PRINT "ENTER USERLIB ";290 INPUT U$300 CALL "USERLIB",U$310 REM ** SET UP DISC FILE **320 PRINT "ENTER STARTING & ENDING WAVELENGTHS (ANGSTROMS): ";330 INPUT W1,W2340 IF W2>W1 THEN 380350 PRINT "ERROR! STARTING WAVELENGTH BIGGER THAN ENDING WAVELENGTH"360 GO TO 320370 REM ** TAKE UP BACKLASH BEFORE ENTERING POSITION **380 PRINT @23:"O0040TL2640T"390 PRINT " ENTER PRESENT INDICATED WAVELENGTH ";400 INPUT W0410 PRINT "ENTER TIME CONSTANT; 1 OR 3 SEC? ";420 INPUT T0430 PRINT "ENTER SCALE EXPANSION,TEMP (K) & SLIT WIDTH (MICRONS) ";440 INPUT S5,T1,S0450 REM ** CALCULATE OPTIMUM SCAN PARAMETERS **460 REM ** 4 READINGS PER BANDWIDTH, PER HALF-TIME-CONSTANT **470 REM ** BANDWIDTH EQUAL TO 0.011*S0 ANGSTROMS **480 M6=0.011*S0*30/T0490 PRINT USING 510:"MAXIMUM SCAN RATE TO OBSERVE DETAILS, ",M6," A/MIN"495 REM ** ADD 0.6 SECS/READING FOR PRINTING,GRAPHING & RECORDING **500 PRINT USING 510:"SCAN TIME WOULD BE ",(W2-W1)*(T0+1.2)/M6/T0;" MINS"510 IMAGE FA,FD.1D,FA520 REM ** FASTER SCAN RATES ACCEPTABLE **530 PRINT "SELECT A SCAN RATE ";540 INPUT R1550 IF R1>M6 THEN 630560 REM ** SLOWER SCAN RATES NOT ACCEPTABLE **570 PRINT "A SLOWER SCAN-RATE THAN ";M6;" A/MIN IS UNPRODUCTIVE!"580 PRINT "RE-ENTER SCAN-RATE :";590 GO TO 540600 REM **********************************************610 REM **READINGS TAKEN TWICE PER TIME CONSTANT **620 REM ** W8 IS NUMBER OF STEPS PER HALF-TIME-CONSTANT **630 W8=INT(R1*T0/120/A8+1)635 REM ** W9 IS STEP SIZE IN ANGSTROMS **640 W9=W8*A8650 REM ** CALCULATE ACTUAL SCAN RATE ANGS/MIN **660 A6=120*W9/T0670 REM ** CALCULATE NUMBER OF DATA POINTS/SCAN, AND SCAN TIME **680 M1=INT((W2-W1)/W9)685 REM ** ADD 0.6 SECS. FOR GRAPHING,RECORDING,& PRINTING **688 T=M1*(T0+1.2)/120690 PRINT USING 700:"SCAN RATE=";A6;" A/MIN,SCAN TIME=";T;"MINS"700 IMAGE FA,FD.1D,FA,FD.1D,FA710 PRINT "IS THIS SCAN SATISFACTORY? (Y/N) ";720 INPUT Q$730 IF Q$<>"Y" THEN 530735 REM ** PRINT HEADINGS, SET UP DISC FILES **740 GOSUB 5000742 REM ** SLEW TO STARTING WAVELENGTH **745 GOSUB 6000750 W7=W1760 REM **** SET UP OCTAL VALUES FOR TIME & STEPPER CARDS770 ON SRQ THEN 1160780 A=W8790 GOSUB 4000800 S$="L"&A$810 S$=S$&"T"820 REM ** SET 0.5 OR 1.5 SECOND TIME INTERVALS **830 IF T0=3 THEN 860840 T$="H1T"850 GO TO 870860 T$="H156T"865 REM ** DRAW GRID FOR SCREEN PLOT **870 PAGE 880 VIEWPORT 0,130,7,90890 WINDOW W1,W2,0,10900 AXIS 0,2,W1,0910 MOVE W1,10920 DRAW W2,10930 DRAW W2,0940 MOVE W1,0950 PRINT USING 960:W1,W2960 IMAGE L,FD.1D,67T,FD.1D970 PRINT USING 980:"WAVELENGTH (ANGSTROMS)"980 IMAGE "",26T,FA990 PRINT USING 1000:U$,N$,S5,0.011*S01000 IMAGE 5T,FA,"/",FA,5X,"EXPANSION= ",FD,5X,"RESOLUTION=",FD.2D,"A",S1010 REM ** LOOP FOR STEPPING SPEX & TAKING VOLTAGE READINGS **1020 REM ** SET TIMER WITH T$,AND STEP MOTOR WITH S$ **1030 REM ** SET VOLTMETER TO HOLD(D),VOLTS D.C.(Y),20 RANGE(S) **1040 PRINT @10,32:"DYS"1045 REM ** TAKE FIRST READING **1050 R5=11055 REM ** SET METER TO READ (G) **1060 PRINT @10:"G"1070 INPUT @10:V1(1)1080 Y0=V1(1) MIN Y01090 Y9=V1(1) MAX Y91100 L0(1)=W11110 R0(1)=11120 MOVE W1,V1(1)1130 W1=W1+W91139 REM ** TAKE SUBSEQUENT READINGS **1140 FOR R5=2 TO M11150 PRINT @23:"O0040T",S$,T$,"O0160T"1160 POLL C1,D1;231180 PRINT @10:"G"1190 REM **  TAKE VOLTAGE READING **1200 GOSUB 20001210 NEXT R51220 REM **PRINT & RECORD LAST RESULTS, WRITE HEADER FILE **1230 C0=C0-11240 W1=W1-W91250 GOSUB 70001260 END 1970 REM *****   SUBROUTINES   ****************1980 REM **************************************1990 REM ** READING, RECORDING, PRINTING VOLTAGE **2000 INPUT @10:V02010 Y0=V0 MIN Y02020 Y9=V0 MAX Y92030 V1(C0)=V02050 L0(C0)=W12060 R0(C0)=R52070 IF C0<10 THEN 22602080 REM** PRINT IN GROUPS OF TEN **205 SET NOKEY 2090 PRINT @37,26:12100 PRINT @40: USING 2110:R0(1),L0(1)2110 IMAGE 5D,4X,5D.1D,4X,S2120 FOR K=1 TO C02130 PRINT @40: USING 2140:V1(K)2140 IMAGE 2D.2D,S2150 NEXT K2160 PRINT @40:""2170 PRINT @37,26:02190 FOR K=1 TO C02200 WRITE #1,R0(K):V1(K)2210 DRAW L0(K),V1(K)2220 NEXT K2230 C0=12235 SET KEY 2240 W1=W1+W92250 GO TO 22802260 C0=C0+12270 W1=W1+W92280 RETURN 2990 REM ** INITIAL VALUES **3000 DIM V1(10),L0(10),R0(10)3010 Y0=1.0E+303020 Y9=-1.0E+303030 C0=23040 DIM M$(18),Q$(1),S$(10),T$(10),W$(10),C$(10),D$(10)3050 DIM X$(14),Y$(18),Z$(10),E$(20),I$(21),U$(10),A$(10),N$(30),H$(30)3060 REM ** ANGSTROMS PER STEPPING MOTOR PULSE,GEAR SETTING 500 **3070 A8=5/1443100 RETURN 4000 REM **  THIS ROUTINE CONVERTS BASE 10 TO OCTAL **4020 L=LGT(A)/LGT(8)4030 M=INT(L)4040 J=04050 FOR N1=1 TO 84060 X1=N1*8^M4070 IF X1>A THEN 40904080 NEXT N14090 J=J+14100 IF J>1 THEN 41504110 N2=N1-14120 A=A-N2*8^M4130 A$=STR(N2)4140 GO TO 41904150 N2=N1-14160 O$=STR(N2)4170 A=A-N2*8^M4180 A$=A$&O$4190 M=M-14200 IF M=>0 THEN 40504210 RETURN 5000 REM ** DISC MOUNTING AND FILE NAMING **5020 CALL "TIME",M$5030 IF LEN(M$)>0 THEN 50705040 PRINT "ENTER DATE AND TIME (DD-MON-YY HH:MM:SS) ";5050 INPUT M$5060 CALL "SETTIM",M$5070 CALL "UNIT",05080 CALL "MOUNT",0,""5090 PRINT "ENTER FILE NAME ";5100 INPUT N$5105 REM ** HEADER FILE NAMED BY ADDING ".H" **5120 H$=N$&".H"5140 CALL "FILE",0,N$,C$5150 CALL "FILE",0,H$,D$5160 IF LEN(C$)+LEN(D$)<1 THEN 52205170 PRINT "DELETE PRESENT ";N$;" &/OR ";H$;" FROM DISC? (Y/N): ";5180 INPUT Q$5190 IF Q$<>"Y" THEN 50905200 KILL N$5210 KILL H$5215 REM ** DATA FILE IS RANDOM ACCESS **5220 CREATE N$;10,105225 REM ** SEQUENTIAL HEADER FILE **5230 CREATE H$;200,05240 OPEN N$;1,"F",C$5250 OPEN H$;2,"F",D$5260 PRINT "ENTER ANY NOTES FOR THIS RUN"5270 INPUT G$5280 CALL "TIME",M$5290 PRINT @37,26:15300 PRINT @40: USING 5310:U$,N$,M$5310 IMAGE "USERLIB=",FA,3X,"FILE=",FA,3X,"TIME OF EXPERIMENT:",1X,FA5320 PRINT @40:"NOTES: ";G$5330 PRINT @40: USING 5340:S5,S05340 IMAGE "SCALE EXPANSION=",FD,3X,"SLIT WIDTH=",FD," MICRONS",S5350 PRINT @40: USING 5360:T15360 IMAGE 3X,"TEMPERATURE=",FD.1D," K",L5370 PRINT @40: USING 5390:"REC.NO.","WAVELENGTH","TRANSMITTANCE"5373 PRINT @40: USING 5376:"(STEPS OF",W9,"ANGSTROMS)"5376 IMAGE 2X,FA,1X,FD.3D,1X,FA5380 PRINT @37,26:05390 IMAGE FA,1X,FA,8X,FA,S5450 RETURN 6000 REM *** SLEW THE SPEX TO THE STARTING POSITION ***6010 REM ** AFTER REVERSE SLEW, TAKE UP BACKLASH **6020 IF W0>W1 THEN 62806030 W3=INT((W1-W0)/A8+0.5)6040 REM ** MAX. NUMBER OF STEPPING MOTOR PULSES PER COMMAND=2047 **6050 IF W3<=2047 THEN 60906060 N3=INT(W3/2047)6070 N4=W3-N3*20476080 GO TO 61106090 N4=W36100 GO TO 61706110 ON SRQ THEN 61506120 REM ** SLEW FORWARD IN 2047 STEP SEGMENTS **6130 FOR I=1 TO N36140 PRINT @23:"O0040TL3777TO0160T"6150 POLL C1,D1;236160 NEXT I6170 A=N46180 REM ** CONVERT TO OCTAL **6190 GOSUB 40006200 REM ** FORM DATAWORD TO SLEW MOTOR **6210 W$="L"&A$6220 W$=W$&"T"6230 ON SRQ THEN 62506240 PRINT @23:"O0040T",W$,"O0160T"6250 POLL C1,D1;236260 RETURN 6270 REM ** REVERSE SLEW TO 50 A BELOW W1 **6280 W3=INT((W0-W1+50)/A8+0.5)6290 IF W3<=2047 THEN 63306300 REM missing rest of program N3=
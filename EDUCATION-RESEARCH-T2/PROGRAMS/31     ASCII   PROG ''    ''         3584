160 REM Baseline Fit Overlay  [FILE 5]  ver:02/23/79 e11165 DELETE 1170 T0=10^39180 T9=-T0500 FUZZ 6,1.0E-641000 REM...........................1010 REM......Display Heading......1020 REM...........................1030 PAGE 1040 MOVE 33,951050 RDRAW 62.5,01060 RDRAW 0,-81070 RDRAW -62.5,01080 RDRAW 0,81090 IF F5=0 THEN 11201100 PRINT "	       FLUORESCENCE CORRECTION"1110 GO TO 11301120 PRINT "	          BASELINE FITTING"1130 PRINT "		* Insert Baseline Tape"1140 PRINT "		* Enter Baseline File: ";2000 REM................................2010 REM......Obtain Baseline Data......2020 REM................................2030 REM: B$ = baseline ID2040 REM: L1 = init WL (in A)2050 REM: L2 = final WL (in A)2060 REM: B0 = No. of pts.2070 INPUT F12080 FIND F12090 READ @33:B$,L1,L2,B02100 GOSUB 70103000 REM..................................3010 REM......Set Initial Parameters......3020 REM..................................3030 REM: L3=baseline data increment (in A)3040 L3=(L1-L2)/(B0-1)3050 V1=L13060 V2=L1-L33070 X1=W13080 J=13090 P=T(1)3100 IF F5=0 THEN 31303110 PRINT "...Begin Fluorescence Correction"3120 GO TO 40803130 PRINT "...Begin Fit"4000 REM...........................4010 REM......Fit to Baseline......4020 REM...........................4030 REM: compute BL pt. Z3 (by lin. interpolation)4040 REM: (Z3 having same WL as Yi)4050 REM: for Fluores: Yi = Yi * Z34060 REM: for Baseline Yi = log[Z3 / Yi]4070 REM: compute T0 & T9 (min & max Yi)4080 READ @33:Z14090 FOR I=1 TO B0-14100 READ @33:Z24110 IF X1<V2 THEN 42304120 Z3=(V1-X1)/(V1-V2)*(Z2-Z1)+Z14130 IF F5=0 THEN 41554140 Y(J)=Y(J)*Z34150 GO TO 41704155 IF Y(J)>0 THEN 41604156 Y(J)=1.0E-44160 Y(J)=LGT(Z3/Y(J))4170 T0=T0 MIN Y(J)4180 T9=T9 MAX Y(J)4190 J=J+14200 IF J>P THEN 50604210 X1=X1-W34220 GO TO 41104230 Z1=Z24240 V1=V24250 V2=V2-L34260 NEXT I5000 REM................................5010 REM......Print Concluding Msg......5020 REM................................5030 PRINT "...Last Baseline Point"5040 PRINT "...Remaining Data Truncated"5050 T(1)=I5060 IF F5=0 THEN 50905070 PRINT "...Data Corrected for Fluorescence"5080 GO TO 51005090 PRINT "...Background Removed"5100 PRINT "		* Insert Program Tape"6000 REM.................................6010 REM......Adjust data for min=0......6020 REM.................................6030 FOR I=1 TO T(1)6040 Y(I)=Y(I)-T06050 NEXT I6060 T(16)=06070 T(17)=T9-T06080 M9=T(17)6090 REM B$=REP(" ",1,0)6100 REM I$=REP(B$,LEN(I$)+1,0)6110 DELETE I,V1,V2,X1,Z1,Z2,Z3,L1,L2,L3,B0,F1,B$,T9,J,P6120 PRINT "		* Press Return to Display		or use User Def Keys ";6130 INPUT A$6140 GO TO 407000 REM...............................7010 REM......Sub to Display Info......7020 REM...............................7030 GIN X,Z7040 MOVE 0.5,Z7050 RMOVE 20,07060 RDRAW 75,07070 RDRAW 0,-247080 RDRAW -95,07090 RDRAW 0,167100 RDRAW 95,07110 RDRAW 0,-87120 RDRAW -95,07130 RMOVE 20,167140 RDRAW 0,-247150 RMOVE 30,07160 RDRAW 0,247170 RMOVE 29,07180 RDRAW 0,-247190 RMOVE -56,197200 PRINT "  ID NUMBER     DATA RANGE (A)  NO. PTS."7210 PRINT "  BASELINE  SAMPLE       ";7220 PRINT B$;"	";L1;" - ";L2;"     ";B07230 PRINT "	";I$;"	";W1;" - ";W2;"     ";T(1);""7240 RETURN 
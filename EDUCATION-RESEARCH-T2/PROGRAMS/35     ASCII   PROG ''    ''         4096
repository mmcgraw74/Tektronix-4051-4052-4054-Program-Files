1 REM2 REM    REACTION EVALUATION OVERLAY  (STRAIGHT-LINE METHOD) 24-JAN-803 REM ****************************************************************4 REM79 RETURN 90 REM:::: OVERLAY ROUTINE ::::91 DELETE 2,9092 DELETE 100,999993 APPEND @Q8:194 GO TO 1000300 REM ***** NEXT FILE310 IF F8=F9 THEN 370320 F8=F8+1330 IF T3(F8)=0 THEN 370340 FIND @Q7:F8350 G5=T3(F8)360 RETURN 370 PRINT "END OF FILE ON DATA TAPE"380 RETURN 1000 REM1100 Q7=331110 Q8=21120 D$="N"2000 REM2010 F8=F8-22020 GOSUB 3002030 DELETE X0,Y02040 DIM X0(N6),Y0(N6)2050 READ @Q7:T,V2053 IF T<>0 THEN 20602054 GOSUB 3002056 GO TO 20502060 IF T<E2 THEN 20502100 REM Fill Vectors2110 I=02120 I=I+12130 READ @Q7:X0(I),Y0(I)2132 IF X0(I)<>0 THEN 21402134 GOSUB 3002136 GO TO 21302140 IF X0(I)=>E3 THEN 24002150 IF I<N6 THEN 21202160 REM**Arrays too small2170 PRINT "VECTORS X0,Y0 DIM TOO SMALL:";N62180 END 2400 REM**** Redefine X,Y2410 DELETE X,Y2420 N9=I2430 DIM X(N9)2440 FOR I=1 TO N92450 X(I)=X0(I)2460 NEXT I2500 DELETE X02510 DIM Y(N9)2520 FOR I=1 TO N92530 Y(I)=Y0(I)2540 NEXT I2550 DELETE Y02600 REM**** Determine Tm2610 GOSUB 30002620 MOVE T,02630 DRAW T,0.12635 PRINT "Tm";2680 MOVE G1,02685 PRINT ""2690 PRINT "area1 = ";S1;"area2 = ";S22700 PRINT "Tm = ";T2710 T5=T2720 COPY 2800 IF D$<>"Y" THEN 29002810 VIEWPORT 0,150,0,1002820 WINDOW B1,B2,B3,B42830 MOVE @1:T,02840 DRAW @1:T,0.12850 VIEWPORT 2,130,40,1002860 WINDOW G1,G2,0,0.12900 FIND @Q8:32910 GO TO 903000 REM3010 REM        Integrate/Interpolate Routine    13-APR-783020 REM[][][][][][][][][][][][][][][][][][][][][][][][][][]3030 REM Newton-Uchida method for interpolating and integrating3040 REM      upper and lower diagonal areas of curve given by3050 REM      data points in arrays X(N9),Y(N9) [within limits3060 REM      of 1st and last points] to determine 1/2 time.3070 GO TO 31003080 REM***** Draw Added Section-23081 MOVE X(N8+1),Y(N9)3082 DRAW X(N8),Y(N9)3084 DRAW X(N8),Y(N8)3086 PRINT "";3088 RETURN 3090 REM***** Draw Added Section-13091 MOVE X(N2-1),Y(N1)3092 DRAW X(N2),Y(N1)3094 DRAW X(N2),Y(N2)3096 PRINT "";3098 RETURN 3100 N1=13110 N2=N13120 N8=N93130 S1=03140 S2=03200 REM**** Compare Accumulated Areas3210 IF S1<S2 THEN 32603220 REM**** Add a section to S23230 N8=N8-13240 S2=S2+(X(N8+1)-X(N8))*((Y(N8+1)-Y(N8))*0.5+(Y(N9)-Y(N8+1)))3245 GOSUB 30803250 GO TO 33003260 REM**** Add a Section to S!3270 N2=N2+13280 S1=S1+(X(N2)-X(N2-1))*((Y(N2)-Y(N2-1))*0.5+(Y(N2-1)-Y(N1)))3290 GOSUB 30903300 REM**** Check meeting point3310 IF N2<N8 THEN 32003320 REM**** Equal: Juggle to find median section3330 IF S1<S2 THEN 35003340 IF S1>S2 THEN 34003350 REM**** the 2 areas are equal3360 T=X(N2)3370 RETURN 3400 REM**** Remove a section from S1 and add to S23410 S1=S1-(X(N2)-X(N2-1))*((Y(N2)-Y(N2-1))*0.5+(Y(N2-1)-Y(N1)))3420 N2=N2-13430 N8=N8-13440 S2=S2+(X(N8+1)-X(N8))*((Y(N8+1)-Y(N8))*0.5+(Y(N9)-Y(N8+1)))3445 GOSUB 30803450 IF S1=S2 THEN 33503460 IF S1>S2 THEN 34003470 S2=S2-(X(N8+1)-X(N8))*((Y(N8+1)-Y(N8))*0.5+(Y(N9)-Y(N8+1)))3480 N8=N8+13490 GO TO 36003500 REM**** Remove a section from S2 and add to S13510 S2=S2-(X(N8+1)-X(N8))*((Y(N8+1)-Y(N8))*0.5+(Y(N9)-Y(N8+1)))3520 N8=N8+13530 N2=N2+13540 S1=S1+(X(N2)-X(N2-1))*((Y(N2)-Y(N2-1))*0.5+(Y(N2-1)-Y(N1)))3545 GOSUB 30903550 IF S1=S2 THEN 33503560 IF S1<S2 THEN 35003570 S1=S1-(X(N2)-X(N2-1))*((Y(N2)-Y(N2-1))*0.5+(Y(N2-1)-Y(N1)))3580 N2=N2-13600 REM**** Interpolate remaining block3610 X2=X(N2)3620 X8=X(N8)3630 Y2=Y(N2)-Y(N1)3640 Y8=Y(N9)-Y(N8)3650 X5=(X8-X2)*0.013660 Y5=(Y(N8)-Y(N2))*0.013700 IF S1<S2 THEN 38003710 REM**** Add a block to S23720 S2=S2+X5*(Y5*0.5+Y8)3730 X8=X8-X53740 Y8=Y8+Y53750 GO TO 39003800 REM**** Add a block to S13810 S1=S1+X5*(Y5*0.5+Y2)3820 X2=X2+X53830 Y2=Y2+Y53900 REM**** Check meeting point3910 IF X2<X8 THEN 37003920 T=X23940 RETURN 3990 REM[][][][][][][][][][][][][][][][][][][][][][][][][][]4000 DELETE 2,904010 DELETE 100,99994020 APPEND @X8:14030 GO TO 1000
1 REM..... 51/00-5506/0 ..... 3 D  F U N C T I O N  P L O T .....2 REM3 REM4 REM.... THIS PROGRAM DRAWS A FUNCTION OF TWO VARIABLES Z=F(X,Y)5 REM.... WITH HIDDEN LINES REMOVAL.6 REM.... THE FUNCTION Z IS DEFINED IN A RECTANGULAR REGION  SO THAT7 REM.... X1<=X<=X2  AND  Y1<=Y<=Y2.8 REM.... TO OBTAIN A DRAW YOU MUST DO JUST LIKE THIS:9 REM.... 1) WRITE THE FUNCTION Z IN LINE 200010 REM...    EXAMPLE:   2000 Z=10*SIN(X)/X*SIN(Y)/Y11 REM... 2) WRITE THE DATA IN LINE 120 CORRESPONDING TO THE READ12 REM...    STATEMENT IN LINE 110:13 REM...       110 READ X1,X2,Y1,Y2,O1,O2,L,N,F    WHERE14 REM15 REM...  - [X1,X2] IS THE INTERVAL ON THE X-AXIS16 REM...  - [Y1,Y2] IS THE INTERVAL ON THE Y-AXIS17 REM...  - O1 IS THE AZIMUTH ANGLE IN DEGREES18 REM...  - O2 IS THE DIP ANGLE IN DEGREES19 REM...  - L IS THE NUMBER OF LINES ON THE SURFACE20 REM...  - N IS THE NUMBER OF POINTS ON EACH LINE21 REM...  - F IS THE FILE NUMBER TO RECORD THE DATA ON TAPE FOR22 REM...    FASTEST DRAWING (NO RECORD IF F=0).23 REM...  - O2 IS THE DIP ANGLE IN DEGREES24 REM...                             370 REM       (2)25 REM...26 REM...    IF (1),YOU OBTAIN A UNIFORM SCALING SO THAT THE SURFACE27 REM...    FILLS THE ENTIRE SCREEN,THUS YOU DON'T OBTAIN THE TRUE28 REM...    REPRESENTATION OF THE FUNCTION29 REM...    IF (2),YOU OBTAIN THE TRUE SCALING30 REM...31 REM...32 REM... 4) REMARKS:33 REM       -------34 REM       * ON THE 4051 IT TAKES ABOUT ONE MINUTE BEFORE DRAWING35 REM       * ON THE 4052 AND 4054 DRAWING BEGINS ALMOST IMMEDIATELY36 REM       * FOR CERTAIN FUNCTIONS WITH VERTICAL ASYMPTOTES OR37 REM         HIGH-VALUE FOR Z,YOU CAN USE THE FUNCTIONS MIN38 REM         AND MAX TO TAKE THE CREST OFF.39 REM40 REM         EXAMPLE:   2000 Z=...41 REM                    2001 Z=Z MIN 1042 REM                    2002 Z=Z MAX -1043 REM...44 REM...45 REM... 5) TEST EXAMPLE46 REM       ------------47 REM       HERE IS A VERY NICE FUNCTION !48 REM       YOU DO: -  2000 Z=10*SIN(X)/X*SIN(Y)/Y49 REM               -  120 DATA -10,10,-10,10,45,30,51,51,050 REM               -  370 REM60 REM               -  RUN100 INIT 105 PAGE 110 READ X1,X2,Y1,Y2,O1,O2,L,N,F120 DATA -10,10,-10,10,75,20,31,31,0130 DIM M(2,130)135 REM... INITIALIZATION FOR THE SUBROUTINE IN LINE 2000140 SET DEGREES 150 S1=SIN(O1)160 S2=SIN(O2)170 C1=COS(O1)180 C2=COS(O2)190 SET RADIANS 192 REM... SEARCH FOR THE APROXIMATIVE MAXIMUM IN ABSOLUTE VALUE OF Z193 REM... THE DIVIDER 19 IS ARBITRARY200 M1=1000210 M2=-1000220 M3=M1230 M4=M2240 FOR Y=Y1 TO Y2 STEP (Y2-Y1)/19250 FOR X=X1 TO X2 STEP (X2-X1)/19260 GOSUB 2000270 M1=M1 MIN X0280 M2=M2 MAX X0290 M3=M3 MIN Y0300 M4=M4 MAX Y0310 NEXT X320 NEXT Y325 REM... ENLARGEMENT TO BE SURE TO HAVE ALL THE PICTURE326 REM... ON THE SCREEN330 M1=M1-ABS(M1)/20340 M2=M2+ABS(M2)/20342 M3=M3-ABS(M3)/20344 M4=M4+ABS(M4)/20347 REM... SCALING...350 H1=128/(M2-M1)360 H2=98/(M4-M3)370 REM... FOR TRUE SCALING...380 IF H1<=H2 THEN 400390 H1=H2400 H2=H1405 REM... F=NUMBER OF THE TAPE FILE TO RECORD THE DATA410 IF F=0 THEN 440420 FIND @5:F440 X3=(X2-X1)/N450 Y3=(Y2-Y1)/L460 REM... INITIALISATION OF THE MATRIX WHICH KEEP THE MAXIMAL AND461 REM... MINIMAL CRESTS490 M=-1500 DIM M(2,65)510 M=101520 DIM M(2,130)525 REM... START OF THE COMPUTATION OF THE LINES....530 FOR U=1 TO L+1540 IF O1>0 AND O1<180 THEN 546542 Y=Y1+(U-1)*Y3543 X=X2544 G1=2545 GO TO 590546 Y=Y2-(U-1)*Y3547 X=X1548 G1=1590 GOSUB 2000600 A1=(X0-M1)*H1610 B1=(Y0-M3)*H2612 P=2615 IF M(2,A1)=-1 THEN 670620 P=0630 IF M(2,A1)=>B1 THEN 650640 P=2650 IF M(1,A1)<=B1 THEN 670660 P=1670 FOR V=1 TO N680 IF G1=2 THEN 700690 X=X1+V*X3695 GO TO 720700 X=X2-V*X3720 GOSUB 2000730 A2=(X0-M1)*H1740 B2=(Y0-M3)*H2745 Q=P750 IF M(2,A2)=-1 THEN 1140780 S=0790 Q=0800 IF M(2,A2)=>B2 THEN 820810 Q=2820 IF M(1,A2)<=B2 THEN 840830 Q=1840 IF P=0 AND Q=0 THEN 1150850 IF P=0 OR Q=0 THEN 950860 IF P=Q THEN 1140870 S=1880 Z1=1890 Z2=2900 IF P=1 THEN 930910 Z1=2920 Z2=1930 T=Z1940 GO TO 960950 T=P+Q960 D=M(T,A2)-M(T,A1)-B2+B1970 IF D=0 THEN 1140980 A3=(B1*A2-B2*A1-M(T,A1)*A2+M(T,A2)*A1)/D990 B3=(B1*M(T,A2)-B2*M(T,A1))/D1000 IF P=0 THEN 11201010 A4=A21020 B4=B21030 A2=A31040 B2=B31050 GOSUB 12301060 A2=A41070 B2=B41080 IF S=0 THEN 11501090 T=Z21100 P=01110 GO TO 9601120 A1=A31130 B1=B31140 GOSUB 12301150 P=Q1160 A1=A21170 B1=B21180 NEXT V1190 NEXT U1210 HOME 1215 LIST 20001216 LIST 1201220 END 1222 REM... SUBROUTINE WHICH DRAWS THE SURFACE,RECORDS THE DATA1223 REM... ON THE TAPE AND UPDATE THE CRESTS MATRIX BY LINEAR1224 REM... INTERPOLATION1230 PRINT @32,21:A1,B11240 PRINT @32,20:A2,B21250 IF F=0 THEN 12701260 WRITE @5: A1,B1,A2,B21270 I1=INT(A1+0.5)1280 I2=INT(A2+0.5)1290 IF I1<>I2 THEN 13301300 M(1,I2)=M(1,I2) MIN B21310 M(2,I2)=M(2,I2) MAX B21320 RETURN 1330 I3=(I1 MIN I2)1340 I4=(I1 MAX I2)1380 FOR K=I3 TO I41390 R=(K*(B2-B1)+A2*B1-A1*B2)/(A2-A1)1400 M(1,K)=M(1,K) MIN R1410 M(2,K)=M(2,K) MAX R1420 NEXT K1430 RETURN 1995 REM... SUBROUTINE WHICH CONTAINS THE FUNCTION Z AND CONVERTS IT1996 REM... INTO THE (X0,Y0) COORDINATE AFTER TWO ROTATIONS AND A1997 REM... PROJECTION.2000 Z=10*SIN(X)/X*SIN(Y)/Y2010 X0=-X*S1+Y*C12020 Y0=-X*C1*S2-Y*S1*S2+Z*C22030 RETURN 
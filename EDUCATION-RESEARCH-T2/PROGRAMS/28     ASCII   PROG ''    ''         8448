160 REM Auto-Input Overlay  [FILE 2]  ver:02/06/79 e14170 REM1000 CALL "TIMSET",01010 SET KEY 1020 D1=421030 PAGE 1060 PRINT "		* Enter O (to examine old file)"1070 PRINT "		or N (to create a new file) ";1080 M9=01090 INPUT A$1095 IF A$="N" THEN 30001100 REM..........................1102 REM......Input Old File......1103 REM..........................1104 REM M9 = max Yi1105 REM S = scale chg pts.1106 REM W3 = data increment (in A)1110 PRINT "		* Insert Data Tape"1120 PRINT "		* Enter File Number: ";1130 INPUT F11150 FIND @D3:F11160 READ @33:I$,W1,W2,T(1)1170 W3=(W1-W2)/(T(1)-1)1175 PAGE 1180 GOSUB 90001190 PRINT "...Data Transfer";1200 DELETE Y1210 DIM Y(T(1))1220 READ @33:Y1230 READ @33:T(16),T(17),S11240 IF S1=0 THEN 12801250 DELETE S1260 DIM S(S1)1270 READ @33:S1280 PRINT " Complete"1290 GO TO 55003000 REM........................................3010 REM......Obtain Info for New Data Set......3020 REM........................................3040 PRINT "		* Insert Data Tape"3050 PRINT "		* Enter File Number		to Store Raw data: ";3060 INPUT F13090 T(16)=03100 T(17)=0.023110 WBYTE @35,122:63,95,34,68,0,0,0,84,0,0,76,3,46,343130 PRINT "		* Enter Spectrum Sample ID Number		";3140 INPUT I$3150 PRINT "		* Enter Initial Wavelength		(in Angstroms): ";3160 INPUT W13170 S1=03180 I=13185 Y(1)=03190 N7=03195 PRINT "...DELAY: ";3200 PRINT D1;" ";3205 X1=03210 X2=03220 CALL "TIMSET",03230 FOR J6=1 TO D13240 NEXT J63250 WBYTE @63,95,35,64:34,68,44,48,84,46,343260 INPUT @3:Z3270 CALL "TIME",X13300 CALL "TIMSET",03310 FOR J6=1 TO D13320 NEXT J63330 WBYTE @63,95,35,64:34,68,44,48,84,46,343340 INPUT @3:Z3350 CALL "TIME",X23400 IF ABS(X1-X2)>0.1 THEN 34803410 Z=(X1+X2)*0.53420 IF ABS(Z-0.6)<0.08 THEN 35003430 IF Z>0.6 THEN 34603440 D1=D1+103450 GO TO 32003460 D1=D1-10 MAX 103470 GO TO 32003480 D1=1003490 GO TO 32003500 PRINT "...Ready"3510 PRINT "...Scale Changes: ";3520 WBYTE @63,95,35,64:34,68,44,48,84,46,343530 INPUT @3:Z3540 IF Z>0.0116 THEN 40503550 FOR J6=1 TO D13560 NEXT J63570 GO TO 35204000 REM...........................4010 REM......Data Collection......4020 REM...........................4030 REM: S(S1) = Array of Scale Chg. Pts.4040 REM: N7 = Over Scale Counter4050 PRINT "0 ";4060 GO TO 42104100 REM DELAY LOOP4105 FOR J6=1 TO D14110 NEXT J64210 INPUT @3:Y(I+1)4220 I=I+14300 IF I=>I9 THEN 50304310 IF Y(I)>0.0116 THEN 44004320 N7=04330 GO TO 41004400 N7=N7+14410 IF N7<3 THEN 41004420 I=I-N7+14430 Y(1)=Y(3)4440 Y(2)=Y(3)4450 Y(I-1)=Y(I-2)4460 Y(I)=Y(I-2)4500 GO TO 50504800 REM.....................4801 REM.. SCALE CHANGE RTN .4802 REM.....................4810 SET NOKEY 4820 IF S1<S9 THEN 48504830 PRINT "...Max SC Exceeded"4840 RETURN 4850 S1=S1+14860 S(S1)=I4870 PRINT S1;" ";4880 SET KEY 4890 RETURN 5000 REM......................................5010 REM......Save Data Set + Add'l Info......5020 REM......................................5030 PRINT "...Data Limit of ";I9;" points Exceeded"5040 GO TO 50605050 PRINT "	...End Of Scan"5060 PRINT "NUMBER OF DATA POINTS: ";I5070 T(1)=I5080 PRINT "		* Enter Final Wavelength		(in Angstroms): ";5090 INPUT W25100 W3=(W1-W2)/(T(1)-1)5105 PAGE 5106 SET KEY 5110 GOSUB 90005120 PRINT "...Data Transfer To Tape File ";F1;5130 FIND @D3:F15140 GOSUB 80005145 PRINT "  complete"5500 F5=05510 PRINT "		* Is This a Fluorescence Spectrum? ";5520 INPUT A$5530 F5=F5+(A$="Y")5600 GOSUB 100006000 REM...................................................6010 REM......Interpolate Data at Scale Change Points......6020 REM...................................................6030 REM K = scale chg index6040 REM E1 = exponent (of 10) to *Yi6050 REM E9 = no. of pts. to interpolate6060 REM A1 = {Y(i+1-E9) - Y(i-2)} / (E9+1)  [i=S.C. pt.]6065 IF S1=0 THEN 61206070 PRINT "		* Enter Number of Points to"6080 PRINT "		Interpolate at Scale Change: ";6090 INPUT E96105 PRINT "SCALE CHANGES"6110 IF E9<>0 THEN 62006120 Y=Y*10^66130 T(16)=T(16)*10^66140 T(17)=T(17)*10^66150 M9=T(17)6160 GO TO 64786200 E1=66220 K=1+1*(S(1)<=E9)6230 T(16)=10^396240 T(17)=-T(16)6250 FOR I=1 TO E96260 Y(I)=Y(E9+1)*10^E16270 NEXT I6280 FOR I=E9+1 TO T(1)-E96285 IF K>S1 THEN 64006290 IF I<>S(K) THEN 64006295 REM***** DETERMINE SCALE CHANGE DIRECTION.6300 IF Y(I)<0.0015 THEN 63306301 IF Y(I)>0.007 THEN 63056302 PRINT " Ambiguous SC:";INT(W1-W3*(S(K)-1));" A pt:";S(K);"M or L";6303 INPUT A$6304 IF A$="M" THEN 63306305 PRINT " to LESS sensitive scale:";6306 PRINT INT(W1-W3*(S(K)-1));" A at:";S(K)6310 E1=E1+16320 GO TO 63406330 E1=E1-16335 PRINT " to MORE sensitive scale:";6336 PRINT INT(W1-W3*(S(K)-1));" A at:";S(K)6340 A1=(Y(I+E9-1)*10^E1-Y(I-2))/(E9+1)6350 Y(I-1)=Y(I-2)+A16360 FOR L=0 TO E9-26370 Y(I+L)=(Y(I-2)+A1*(L+2))*10^-E16380 NEXT L6390 K=K+16400 Y(I)=10^E1*Y(I)6410 T(16)=T(16) MIN Y(I)6420 T(17)=T(17) MAX Y(I)6430 NEXT I6440 FOR I=T(1)-E9+1 TO T(1)6450 Y(I)=Y(T(1)-E9)6455 NEXT I6460 T9=T(17)-T(16)6470 T(17)=T9*(T9<>0)+(T9=0)6478 PRINT "		* Insert Program Tape"6480 PRINT "		* Push Return for Baseline Fit"6490 PRINT "		or use User Def Keys";6500 INPUT A$6510 GO TO 328000 REM................................8010 REM......Save Input Data File......8020 REM................................8025 FIND @D3:F18030 T(16)=08040 T(17)=0.028050 WRITE @33:I$,W1,W2,T(1)8060 FOR I=1 TO T(1)8070 WRITE @33:Y(I)8080 NEXT I8090 WRITE @33:T(16),T(17),S18095 IF S1=0 THEN 81308100 FOR I=1 TO S18110 WRITE @33:S(I)8120 NEXT I8130 CLOSE 8140 RETURN 9000 REM....................................9010 REM......Sub to Print Sample Info......9020 REM....................................9030 PRINT 9040 GIN X,Z9050 MOVE X,Z9060 RDRAW 75,09070 RDRAW 0,-209080 RDRAW -75,09090 RDRAW 0,129100 RDRAW 29,09110 RDRAW 0,-129120 RDRAW 16,09130 RDRAW 0,129140 RDRAW 30,09150 RDRAW -75,09160 RDRAW 0,89170 FOR I=1 TO INT((42-LEN(I$))*0.5)9180 PRINT " ";9190 NEXT I9200 PRINT "";I$9210 PRINT @32,18:19220 PRINT " Data Range (})  No. Pts.  Increment (})"9230 PRINT "------------------------------------------"9240 PRINT @32,18:09250 PRINT USING 9260:W1,W2,T(1),W39260 IMAGEX6DX"-"5D4X5D4XFD.FD9270 RETURN 10000 REM....................10010 REM.. SC SUMMARY ......10020 REM....................10025 I1=110030 IF S1>0 THEN 1010010040 RETURN 10050 IMAGE2X,2D,3X,4D,3X,FD.6D,3X,5D,3X,4A10100 PAGE 10105 PRINT "      SCALE CHANGE SUMMARY"10106 PRINT "      ===================="10107 PRINT "DISPOSITION: M(more) L(less) D(delete) ret(ok)"10110 DELETE D$,E$10120 DIM D$(12),E$(4)10200 PRINT "  SC   PT #    VALUE     WL(A)   SENS   DISP"10210 PRINT "  --   ----   -------    -----   ----   ----"10230 D$="MORE????LESS"10300 FOR I=1 TO S110310 GOSUB 1200010380 IMAGE2X,2D,3X,4D,3X,FD.6D,3X,5D,3X,4A10390 NEXT I10400 FOR I=1 TO S1+2-I110410 PRINT "";10420 NEXT I10430 PRINT "";10440 I=I110500 PRINT "		    ";I;":";10510 INPUT A$10520 J=1+(A$="")+2*(A$="M")+3*(A$="L")+4*(A$="D")+5*(A$="A")10530 GO TO J OF 10600,10700,10800,10900,11000,1110010600 REM:::::ILLEGAL INPUT::::10610 PRINT "";10620 PRINT "		    ";I;":*";10630 GO TO 1051010700 REM:::::OK:::10710 I=I+110720 IF I<=S1 THEN 1050010730 DELETE D$,E$10740 PRINT "List,Continue,or Save? ";10745 INPUT A$10750 IF A$="L" THEN 1000010760 IF A$="C" THEN 1079010770 IF A$<>"S" THEN 1074010775 PRINT "Save on File No: ";10776 INPUT F110780 GOSUB 800010790 RETURN 10800 REM::::MORE::::10810 Y(S(I))=1.0E-310820 I1=I10830 GO TO 1010010840 GO TO 1060010900 REM::::LESS::::10910 Y(S(I))=0.00810920 GO TO 1082011000 REM::::DELETE::::11010 S1=S1-111020 IF I>S1 THEN 1109011030 FOR J=I TO S111040 S(J)=S(J+1)11050 NEXT J11070 I1=I11080 GO TO 1010011090 GO TO 1073011100 REM::::ADD::::11110 GO TO 1060012000 REM.....................12010 REM... PRINT SC DATA ...12020 REM.....................12030 J=1+4*(Y(S(I))=>0.0015)+4*(Y(S(I))=>0.007)12040 E$=SEG(D$,J,4)12050 PRINT USING 10050:I,S(I),Y(S(I)),W1-W3*(S(I)-1),E$12090 RETURN 
100 INIT 101 REM  ********************************************************102 REM  *                                                      *103 REM  *               PROGRAM WRITTEN MAY 1980               *104 REM  *                          BY                          *105 REM  *                  RICHARD M. ENGEMAN                  *106 REM  *                         FOR                          *107 REM  *            DENVER WILDLIFE RESEARCH CENTER           *108 REM  *             U.S. FISH AND WILDLIFE SERVICE           *109 REM  *                                                      *110 REM  ********************************************************111 PAGE 120 PRINT "THIS PROGRAM CALCULATES AN ANALYSIS OF VARIANCE"130 PRINT "FOR A SINGLE FACTOR EXPERIMENT WITH REPEATED"140 PRINT "MEASURES (SEE WINER P261-308)"150 PRINT 160 PRINT "THE USER SHOULD BE AWARE THAT THIS ANALYSIS ASSUMES"170 PRINT "COMPOUND SYMMETRY IN THE COVARIANCE MATRIX"180 PRINT 190 PRINT "THE DATA STRUCTURE AND NOTATION ARE AS FOLLOWS"200 PRINT 210 PRINT 220 PRINT "               TREATMENT"230 PRINT "  |--------------------------|"240 PRINT "  |SUBJECT|   1   2......K   |"250 PRINT "  |-------|------------------|"260 PRINT "  |   1   |  x11 x12....x1K  |"270 PRINT "  |   2   |  x21 x22....x2K  |"280 PRINT "  |   .   |   .   .      .   |"290 PRINT "  |   .   |   .   .      .   |"300 PRINT "  |   N   |  xN1 xN2    xNK  |"310 PRINT "  |--------------------------|"320 PRINT 325 D6=1328 REM INPUT DATA STRUCTURE330 PRINT "ARE YOU READY TO INPUT DATA? Y OR N  ";340 INPUT U$350 IF U$="N" THEN 330360 PRINT "ENTER #TREATMENTS,K  ";370 INPUT K372 IF K>1 THEN 380373 PRINT "K AND N MUST BE >1.....START OVER"374 END 380 K1=K+1390 PRINT "ENTER #SUBJECTS,N  ";400 INPUT N402 IF N>1 THEN 410403 GO TO 373410 N1=N+1420 DIM X(N1,K1),X1(N,K)425 PAGE 428 REM INPUT DATA MATRIX430 PRINT "ENTER EACH SUBJECT'S DATA ROW-WISE."440 PRINT "PUSH RETURN AFTER EACH DATA POINT"444 Z=2448 REM Z COUNTS LINES TO PAGE SCREEN WHEN FULL450 FOR I=1 TO N460 FOR J=1 TO K470 PRINT "ENTER X ";I;J480 INPUT X(I,J)481 X1(I,J)=X(I,J)482 Z=Z+1483 IF Z=17 THEN 485484 GO TO 490485 Z=0486 PAGE 490 NEXT J500 NEXT I510 GOSUB 990512 D7=1515 D=32517 PAGE 518 REM PRINT RAW DATA520 PRINT @D:"THIS IS YOUR RAW DATA "530 PRINT @D:540 PRINT @D:X1;541 PRINT "DO YOU WANT THE DATA PRINTED ON ANOTHER DEVICE? Y OR N "542 INPUT U$543 IF U$="Y" THEN 546544 PAGE 545 GO TO D7 OF 550,620546 GO TO 831548 GO TO 517549 REM CORRECT DATA550 PRINT "DO YOU WANT TO ALTER A DATA POINT? Y OR N  ";560 INPUT U$570 IF U$="N" THEN 670580 PRINT "ENTER SUBSCRIPTS OF DATA POINT....I,J"585 PRINT "WHERE I=ROW #, J=COLUMN #"590 INPUT I,J600 PRINT "NOW ENTER THE CORRECT DATA POINT ";610 INPUT X(I,J)611 X1(I,J)=X(I,J)620 PRINT "CHANGE ANOTHER DATA POINT? Y OR N ";630 INPUT U$640 IF U$="Y" THEN 580650 GOSUB 990660 PRINT "DO YOU WANT TO SEE CORRECTED RAW DATA? Y OR N"662 INPUT U$664 D7=2666 IF U$="Y" THEN 515668 REM CALCULATING COMPONENTS OF AOV TABLE670 Q1=S1^2/(K*N)680 Q2=S2690 Q3=S3/N700 Q4=S4/K710 R1=Q4-Q1720 D1=N-1730 R2=Q2-Q4740 D2=N*(K-1)750 R3=Q3-Q1760 D3=K-1770 R4=Q2-Q3-Q4+Q1780 D4=(N-1)*(K-1)790 R5=Q2-Q1800 D5=K*N-1805 D6=2810 M1=R3/D3820 M2=R4/D4830 F=M1/M2831 PAGE 832 PRINT "ENTER DEVICE WHERE OUTPUT IS TO BE PRINTED"833 PRINT "P=PRINTER"834 PRINT "S=SCREEN"835 INPUT U$836 IF U$<>"P" AND U$<>"S" THEN 832837 D=32838 IF U$="P" THEN 840839 GO TO 841840 D=51841 GO TO D6 OF 517,842842 PAGE 848 REM OUTPUT AOV TABLE849 PRINT @D:850 PRINT @D:"                  AOV TABLE"860 PRINT @D:870 PRINT @D:"   SOURCE        DF        SS          MS          F"880 PRINT @D:"---------------------------------------------------------"890 PRINT @D: USING "15A,4D.,8D.3D":"BETWEEN SUBJECT",D1,R1900 PRINT @D: USING "15A,4D.,8D.3D":"WITHIN SUBJECT ",D2,R2910 PRI @D: USI "5X,10A,4D.,8D.3D,8D.3D,8D.3D":"TREATMENTS",D3,R3,M1,F920 PRINT @D: USING "7X, 8A,4D.,8D.3D,8D.3D,     ":"RESIDUAL",D4,R4,M2930 PRINT @D:"---------------------------------------------------------"931 PRINT @D: USING "10X,5A,4D.,8D.3D":"TOTAL",D5,R5935 PRINT "PRESS G & RETURN AND THE SCREEN WILL PAGE"936 PRINT "AND THE PROGRAM WILL CONTINUE"937 INPUT U$938 REM CALCULATING AND PRINTING MEANS TABLES940 PAGE 941 PRINT @D:"SUBJECT MEANS"942 FOR I=1 TO N943 PRINT @D:"SUBJECT ";I;"      ";X(I,K1)944 NEXT I945 PRINT "PRESS G & RETURN AND THE SCREEN WILL PAGE"946 PRINT "AND THE MEANS FOR TREATMENT LEVELS WILL PRINT OUT"947 INPUT U$948 PAGE 950 PRINT "MEANS FOR TREATMENT LEVELS"951 FOR J=1 TO K952 PRINT @D:"LEVEL ";J;"      ";X(N1,J)953 NEXT J959 PRINT "ANOTHER DATA SET? Y OR N  ";960 INPUT U$970 IF U$="Y" THEN 100980 END 988 REM CALCULATING SUMS AND SUMS OF SQUARES990 S1=0994 S2=0996 S4=0998 G=01000 FOR I=1 TO N1010 S=01020 FOR J=1 TO K1025 G=G+X(I,J)1030 S1=S1+X(I,J)1040 S2=S2+X(I,J)^21050 S=S+X(I,J)1060 NEXT J1070 X(I,K1)=S/K1075 S4=S4+S^21080 NEXT I1085 G=G/(K*N)1088 X(N1,K1)=G1090 S3=01100 FOR J=1 TO K1110 S=01120 FOR I=1 TO N1130 S=S+X(I,J)1140 NEXT I1150 X(N1,J)=S/N1160 S3=S3+S^21170 NEXT J1180 RETURN 
1 REM2 REM    REACTION EVALUATION OVERLAY  07-JUN-783 REM ******************************************4 REM5 Q7=336 Q8=279 RETURN 90 REM:::: OVERLAY ROUTINE ::::91 DELETE 2,9092 DELETE 100,999993 APPEND @Q8:194 GO TO 1000300 REM ***** NEXT FILE310 IF F8=F9 THEN 370320 F8=F8+1330 IF T3(F8)=0 THEN 370340 FIND @Q7:F8350 G5=T3(F8)360 RETURN 370 PRINT "END OF FILE ON DATA TAPE"380 RETURN 1000 REM2000 REM2100 REM**** Redefine X,Y2110 DELETE X,Y2130 DIM X(N9)2140 FOR I=1 TO N92150 X(I)=X0(I)2160 NEXT I2200 DELETE X02210 DIM Y(N9)2220 FOR I=1 TO N92230 Y(I)=Y0(I)2240 NEXT I2250 DELETE Y02300 REM**** Draw Curve on Plotter2301 MOVE G1,02302 PRINT "			Plot? ";2304 INPUT D$2306 IF D$<>"Y" THEN 26002310 B1=X(1)-0.1*(X(N9)-X(1))2312 B2=X(N9)+0.1*(X(N9)-X(1))2314 B3=Y(1)-0.1*(Y(N9)-Y(1))2316 B4=Y(N9)+0.1*(Y(N9)-Y(1))2320 VIEWPORT 0,150,0,1002325 WINDOW B1,B2,B3,B42330 MOVE @1:X(1),Y(1)2340 FOR I=2 TO N92350 DRAW @1:X(I),Y(I)2360 NEXT I2600 REM**** Determine Tm2610 GOSUB 30002612 IF D$<>"Y" THEN 26502615 VIEWPORT 0,150,0,1002616 WINDOW B1,B2,B3,B42620 MOVE @1:T,02630 DRAW @1:T,0.12640 VIEWPORT 2,130,40,1002641 WINDOW G1,G2,0,0.12650 MOVE T,02655 DRAW T,0.12660 PRINT "Tm";2680 MOVE G1,02685 IMAGE55T,"area1 =",2D.7D,/,55T,"area2 =",2D.7D2690 PRINT "			Tm = ";T2700 PRINT USING 2685:S1,S22710 T5=T2720 COPY 2730 FIND @Q8:32740 GO TO 903000 REM3010 REM        Integrate/Interpolate Routine    31-MAY-783020 REM[][][][][][][][][][][][][][][][][][][][][][][][][][]3030 REM Newton-Uchida method for interpolating and integrating3040 REM      upper and lower diagonal areas of curve given by3050 REM      data points in arrays X(N9),Y(N9) to determine3060 REM      the 1/2 point (Tm) which forms equal areas,3070 REM      where integration is bounded by the extrapolated3080 REM      curves given by coefficients in arrays C1, C2.3100 N1=13110 N2=N13120 N8=N93130 S1=03140 S2=03200 REM**** Compare Accumulated Areas3210 IF S1<S2 THEN 32603220 REM**** Add a section to S23230 N8=N8-13235 GOSUB 45003240 S2=S2+(X(N8+1)-X(N8))*0.5*(A1+A2-Y(N8)-Y(N8+1))3245 GOSUB 50003250 GO TO 33003260 REM**** Add a Section to S!3270 N2=N2+13275 GOSUB 40003280 S1=S1+(X(N2)-X(N2-1))*0.5*(Y(N2)+Y(N2-1)-A1-A2)3290 GOSUB 55003300 REM**** Check meeting point3310 IF N2<N8 THEN 32003320 REM**** Equal: Juggle to find median section3330 IF S1<S2 THEN 35003340 IF S1>S2 THEN 34003350 REM**** the 2 areas are equal3360 T=X(N2)3370 RETURN 3400 REM**** Remove a section from S1 and add to S23405 GOSUB 40003410 S1=S1-(X(N2)-X(N2-1))*0.5*(Y(N2)+Y(N2-1)-A1-A2)3420 N2=N2-13430 N8=N8-13435 GOSUB 45003440 S2=S2+(X(N8+1)-X(N8))*0.5*(A1+A2-Y(N8)-Y(N8+1))3445 GOSUB 50003450 IF S1=S2 THEN 33503460 IF S1>S2 THEN 34003470 S2=S2-(X(N8+1)-X(N8))*0.5*(A1+A2-Y(N8)-Y(N8+1))3480 N8=N8+13490 GO TO 36003500 REM**** Remove a section from S2 and add to S13505 GOSUB 45003510 S2=S2-(X(N8+1)-X(N8))*0.5*(A1+A2-Y(N8)-Y(N8+1))3520 N8=N8+13530 N2=N2+13535 GOSUB 40003540 S1=S1+(X(N2)-X(N2-1))*0.5*(Y(N2)+Y(N2-1)-A1-A2)3545 GOSUB 55003550 IF S1=S2 THEN 33503560 IF S1<S2 THEN 35003570 S1=S1-(X(N2)-X(N2-1))*0.5*(Y(N2)+Y(N2-1)-A1-A2)3580 N2=N2-13600 REM***** Interpolate remaining Block3605 X2=X(N2)3610 X8=X(N8)3615 Y2=Y(N2)3620 Y8=Y(N8)3625 N8=N8-13630 GOSUB 45003635 A3=A13640 A4=A23645 N2=N2+13650 GOSUB 40003655 A6=(A4-A3)*0.013660 A5=(A2-A1)*0.013665 X5=(X8-X2)*0.013670 Y5=(Y8-Y2)*0.013700 IF S1<S2 THEN 38003710 REM***** Add a Section to S23720 X8=X8-X53730 Y8=Y8-Y53740 A4=A4-A63750 S2=S2+X5*(A4+A4+A6-Y8-Y8-Y5)*0.53760 GO TO 39003800 REM***** Add a Section to S13810 X2=X2+X53820 Y2=Y2+Y53830 A1=A1+A53840 S1=S1+X5*(Y2+Y2-Y5-A1-A1+A5)*0.53900 REM***** Check Meeting Point3910 IF X2<X8 THEN 37003920 T=X23930 RETURN 3990 REM[][][][][][][][][][][][][][][][][][][][][][][][][][]4000 REM***** Subr. to Extrapolate Lower Baseline4010 A1=C1(3)4020 FOR I=1 TO P(18)-14030 A1=A1+C1(I+3)*(C1(1)*X(N2-1)+C1(2))^I4040 NEXT I4050 A2=C1(3)4060 FOR I=1 TO P(18)-14070 A2=A2+C1(I+3)*(C1(1)*X(N2)+C1(2))^I4080 NEXT I4090 RETURN 4500 REM***** Subr. to Extrapolate Upper Baseline4510 A1=C2(3)4520 FOR I=1 TO P(18)-14530 A1=A1+C2(I+3)*(C2(1)*X(N8)+C2(2))^I4540 NEXT I4550 A2=C2(3)4560 FOR I=1 TO P(18)-14570 A2=A2+C2(I+3)*(C2(1)*X(N8+1)+C2(2))^I4580 NEXT I4590 RETURN 4600 DELETE 2,904610 DELETE 100,99994620 APPEND @Q8:14630 GO TO 10004640 DELETE 2,904650 DELETE 100,99994660 APPEND @Q8:14670 GO TO 10005000 REM***** Draw Added Section-25010 IF D$<>"Y" THEN 52305100 VIEWPORT 0,150,0,1005110 WINDOW B1,B2,B3,B45120 MOVE @1:X(N8+1),A25130 DRAW @1:X(N8),A15210 VIEWPORT 2,130,40,1005220 WINDOW G1,G2,0,0.15230 MOVE X(N8+1),A25240 DRAW X(N8),A15250 DRAW X(N8),Y(N8)5290 RETURN 5500 REM***** Draw Added Section-15510 IF D$<>"Y" THEN 57305600 VIEWPORT 0,150,0,1005610 WINDOW B1,B2,B3,B45620 MOVE @1:X(N2-1),A15630 DRAW @1:X(N2),A25710 VIEWPORT 2,130,40,1005720 WINDOW G1,G2,0,0.15730 MOVE X(N2-1),A15740 DRAW X(N2),A25750 DRAW X(N2),Y(N2)5790 RETURN 5800 DELETE 2,905810 DELETE 100,99995820 APPEND @Q8:15830 GO TO 1000
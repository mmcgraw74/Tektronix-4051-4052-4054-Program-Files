1 GO TO 10002 REM**** Calorimetry PLOT Overlay  v.09 24-JAN-80 ****3 REM**************************************************4 GO TO 30008 GO TO 750012 GO TO 500020 GO TO 285024 V=V+0.00525 RETURN 28 V=V-0.00529 RETURN 32 T=T-I33 RETURN 36 T=T+I37 RETURN 40 GO TO 430060 GO TO 200076 FIND @X8:577 GO TO 9090 REM:::: OVERLAY ROUTINE ::::91 DELETE 2,9092 DELETE 100,999993 APPEND @X8:194 GO TO 1000200 REM**** LOCATE TAPE210 FOR F8=3 TO F9220 IF T3(F8)=0 THEN 250230 IF G1<T3(F8) THEN 250240 NEXT F8250 F8=F8-1260 FIND @X7:F8270 G5=T3(F8)280 RETURN 300 REM**** NEXT FILE310 IF F8=F9 THEN 370320 F8=F8+1330 IF T3(F8)=0 THEN 370340 FIND @X7:F8350 G5=T3(F8)360 RETURN 370 PRINT "END OF FILE ON DATA TAPE"380 RETURN 1000 DELETE 10000,320001005 X7=331006 X8=21100 END 2000 REM2010 REM        PLOT 2020 REM********************2030 GOSUB 2002040 SET KEY 2100 REM*****Set Up Display2120 PAGE 2130 VIEWPORT 2,130,40,1002140 REM***** G4=Tic Interval2150 G4=G2-G12160 J=INT(LGT(G4))2170 G4=INT(G4/10^J+0.6)*10^(J-1)2180 G4=G4 MAX 12190 WINDOW G1,G2,0,0.12200 AXIS 0,02250 REM***** Draw & Label Tics2260 K=INT(G1/G4+0.9995)*G42270 FOR I=K TO G2-G4*0.6 STEP G42280 MOVE I,02290 RDRAW 0,0.00122300 MOVE I,02310 PRINT "";2320 PRINT I;2330 NEXT I2340 MOVE I,02350 RDRAW 0,0.00122360 MOVE G1,02370 FOR I=0 TO 0.1 STEP 0.012380 MOVE G1,I2390 RDRAW G4*0.1,02400 NEXT I2450 REM***** Discard Leading Points2460 READ @X7:T,V2470 IF T<>0 THEN 24802472 GOSUB 3002474 GO TO 24602480 G5=T2485 IF T<G1 THEN 24602490 MOVE T,V2500 REM***** PLOT2510 DRAW T,V2520 READ @X7:T,V2530 IF T<>0 THEN 25352532 GOSUB 3002534 GO TO 25202535 G5=T2540 IF T<G2 THEN 25102545 GO TO 26002600 REM***** Draw Exp Heat Point: Tm2601 IF T5=0 THEN 26082602 MOVE T5,02603 DRAW T5,0.12604 PRINT "Tm";2605 GO TO 27902608 REM***** Draw & Label Heating Points2610 FOR I=1 TO H92620 IF T1(I)=0 THEN 27902630 IF T1(I)<G1 THEN 26802640 IF T1(I)>G2 THEN 27902650 MOVE T1(I),02660 RDRAW 0,0.52670 PRINT "B";2680 IF T1(I)+O6*0.5+T8<G1 THEN 27302690 IF T1(I)+O6*0.5+T8>G2 THEN 27902700 MOVE T1(I)+0.5*O6+T8,02710 RDRAW 0,0.52720 PRINT "Tm";2730 IF T1(I)+O6<G1 THEN 27802740 IF T1(I)+O6>G2 THEN 27902750 MOVE T1(I)+O6,02760 RDRAW 0,0.52770 PRINT "E"2780 NEXT I2790 REM***** Position Menu2800 MOVE @32:G1,02810 PRINT ""2820 END 2840 REM2850 REM     Blow-up Graph2860 REM******************2862 T5=02865 MOVE @32:G1,02870 PRINT @32:"* Reassign Plot Limits:"2880 PRINT @32:"	       Min:";2890 INPUT G12900 IF G1=>G3 THEN 28802910 G1=G1 MAX 02915 PRINT "";2920 PRINT "		 Max:";2930 INPUT G22940 IF G2<=G1 THEN 29202950 G2=G2 MIN G32956 IF F8=F9 THEN 20002960 IF G1>G5 AND G1<T3(F8+1) AND T3(F8+1)<>0 THEN 21202970 GO TO 20003000 REM3010 REM         CHART CALIBRATION3020 REM**************************3030 T5=03090 MOVE G1,03100 PRINT @32:"* CHART CALIBRATION"3110 A$="R-Change: "3120 REM***** Get End Pts. of Line Segments3130 GOSUB 40003200 REM***** Find Nearest Chart Cal: O73210 FOR I=1 TO O53220 IF T7(I)>E2 THEN 32903230 NEXT I3250 MOVE @32:2,0.053260 PRINT @32:"NO R-CHANGE"3270 END 3290 O7=I3300 REM***** Advance Tape to Segment 13310 READ @X7:T,V3312 IF T<>0 THEN 33183314 GOSUB 3003316 GO TO 33103318 G5=T3320 IF T<E1 THEN 33103325 REM***** Fill Up Vectors for SEGMENT 13330 K=E23340 GOSUB 57003400 REM***** Find Tm; Advance Tape3430 READ @X7:T,V3432 IF T<>0 THEN 34383434 GOSUB 3003436 GO TO 34303438 G5=T3440 IF T=>E3 THEN 35203450 IF V>0.05 THEN 34303460 IF T5<>0 THEN 34303470 T5=T3480 T7(O7)=T53490 GO TO 34303520 REM***** Draw Mid Line Tm3530 MOVE @O1:T5,03540 DRAW @O1:T5,0.13600 REM***** Fit Segment-1 to Curve3620 GOSUB 60003625 REM***** Extrapolate Segment-13628 T=T53630 J=X(N)3640 K=Y(N)3650 GOSUB 72003660 S1=V3700 REM***** Fill Up Vectors for Segment-23710 K=E43720 GOSUB 57003725 REM***** Fit Segment-2 to Curve3740 GOSUB 60003745 REM***** Extrapolate Segment-23748 T=T53750 J=X(1)3760 K=Y(1)3770 GOSUB 72003780 S2=V3800 REM***** Calculate Difference3810 V=S2-S13820 MOVE @32:G1,03830 PRINT "Difference = ";V3840 W7(O7)=V3850 END 4000 REM4010 REM4020 REM     SUBROUTINE: MARK END POINTS4030 REM***********************************************4050 SET KEY 4100 PRINT @32:"  Identify Line Segments to Extrapolate ";A$4110 REM PRINT @32:"	Before ";A$;" Start Time=";4120 P9=04130 I=(G2-G1)*0.0044140 T=G14150 V=0.054160 GOSUB 2004170 PRINT @32,18:54180 T0=04190 E1=G14200 REM***** Wait Loop for pointer - cycle steal to advance tape4220 PRINT @32,24:"|";4230 MOVE T,V4240 IF P9<4 THEN 42604250 PRINT @32,18:04255 RETURN 4260 IF T0=>E1 THEN 42204270 READ @X7:T0,J4272 IF T0<>0 THEN 42784274 GOSUB 3004276 GO TO 42704278 G5=T04280 GO TO 42204300 REM***** Point Entered4320 GIN T,V4330 PRINT @32:"|";4340 MOVE @32:G1,04350 PRINT @32:""4355 SET KEY 4360 P9=P9+14370 GO TO P9 OF 4400,4500,4600,47004380 PRINT "ILLEGAL: Too many Points Entered: ";P94390 RETURN 4400 REM***** E14410 E1=T4420 REM PRINT @32:"			";E14430 REM PRINT @32:"		  End Time=";4440 V=0.054450 GO TO 42004500 REM***** E24510 E2=T4520 REM PRINT @32:"			";E24530 REM PRINT @32:"	After  ";A$;" Start Time=";4540 V=0.054550 GO TO 42004600 REM***** E34610 E3=T4620 REM PRINT @32:"			";E34630 REM PRINT @32:"		  End Time=";4640 V=0.054650 GO TO 42004700 REM***** E44710 E4=T4720 REM PRINT @32:"			";E44730 RETURN 5000 REM5010 REM      CALIBRATION HEATING5020 REM***********************************************5025 MOVE G1,05030 PRINT "* DRIFT LINE EXTRAPOLATION"5040 A$="Heating:  "5050 REM***** Get End Points of Line Segments5060 GOSUB 40005070 REM***** Find Nearest Heating5075 IF T5<>0 THEN 52005080 FOR I=1 TO H85090 IF T1(I)=0 THEN 51305100 J=T1(I)+O6*0.5-E25110 IF J=>0 THEN 51605120 NEXT I5130 MOVE @32:2,0.055140 PRINT "NO HEATING HERE";5150 END 5160 REM***** Determine 1/2 heat time: Tm5170 T5=T1(I)+O6*0.5+T85200 REM***** Advance Tape to Segment-15210 READ @X7:T,V5212 IF T<>0 THEN 52185214 GOSUB 3005216 GO TO 52105218 G5=T5220 IF T<E1 THEN 52105225 REM***** Fill Vectors for Segment-15230 K=E25240 GOSUB 57005250 REM***** Fit Segment-1 to Curve5260 GOSUB 60005265 REM***** Extrapolate Segment-15268 T=T55270 J=X(N)5280 K=Y(N)5290 GOSUB 72005300 S1=V5310 PRINT "";5400 REM***** Advance Tape to Segment-25410 READ @X7:T,V5412 IF T<>0 THEN 54185414 GOSUB 3005416 GO TO 54105418 G5=T5420 IF T<E3 THEN 54105425 REM***** Fill Vectors for Segment-25430 K=E45440 GOSUB 57005450 REM***** Fit Segment-2 to Curve5460 GOSUB 60005465 REM***** Extrapolate Segment-25468 T=T55470 J=X(1)5480 K=Y(1)5490 GOSUB 72005500 S2=V5510 PRINT "";5600 REM***** Calculate Correction Factor5610 V=S2-S15620 MOVE @32:G1,05630 PRINT "  Correction Factor = ";V5640 REM***** Bookkeeping5641 PRINT "Reaction or Heat? ";5642 INPUT D$5643 IF D$="R" THEN 56605644 FOR I=1 TO H85646 IF E2<T1(I)+O6*0.5 THEN 56545648 NEXT I5650 PRINT "NO HEAT!!Corr. Factor not entered in Summary"5652 END 5654 W0(I)=V5656 END 5660 REM***** Reaction5670 V9=V5680 V6=T55688 END 5700 REM  5710 REM  Subroutine: Fill up Vectors X,Y (stop at K)5720 REM*****************************************5730 DELETE X,Y,Z1,Z25740 DIM Z1(M2),Z2(M2)5750 I=05760 I=I+15770 READ @X7:Z1(I),Z2(I)5772 IF Z1(I)<>0 THEN 57785774 GOSUB 3005776 GO TO 57705778 G5=Z1(I)5780 IF Z1(I)<K AND I<M2 THEN 57605790 IF I=>M2 THEN 59405800 REM***** Redefine vector sizes5805 N=I-15810 DIM X(N)5820 FOR J=1 TO N5830 X(J)=Z1(J)5840 NEXT J5860 DIM Y(N)5870 FOR J=1 TO N5880 Y(J)=Z2(J)5890 NEXT J5900 DELETE Z25930 RETURN 5940 REM***** Truncate Last elmts of Vector5950 PRINT "Truncate at ";Z1(I)5955 N=I5960 GO TO 58106000 REM6010 REM      CURVE FITTING SUBROUTINE6020 REM******************************6040 REM***** Input: X(N),Y(N)    Output: C(Q5) [coeffs]6050 DELETE P6060 DIM P(22)6070 P(1)=N6080 Q9=326090 Q0=1006100 P(13)=16110 P(12)=06120 P(11)=26130 P(14)=06140 REM***** Optimum Polynomial Fit (least-squares)6170 P5=26180 Q5=P5+16190 Q6=Q5+16200 DELETE Q,C6210 DIM Q(Q5,Q6),C(Q5)6230 P7=X(1)-X(N)6240 P6=-4/P76250 P7=2*(X(1)+X(N))/P76260 P(16)=P66270 P(17)=P76280 Q=06300 FOR P2=1 TO N6310 P3=X(P2)*P6+P76320 P4=16330 Q7=Y(P2)6340 FOR P1=1 TO Q56350 Q(1,P1)=Q(1,P1)+P46360 Q(P1,Q6)=Q(P1,Q6)+P4*Q76370 P4=P4*P36380 NEXT P16390 IF Q5<2 THEN 64406400 FOR P1=2 TO Q56410 Q(P1,Q5)=Q(P1,Q5)+P46420 P4=P4*P36430 NEXT P16440 NEXT P26450 IF P5<2 THEN 65406470 FOR P1=2 TO P56480 Q7=P1-16490 FOR P2=P1 TO P56500 Q(P1,P2)=Q(Q7,P2+1)6510 NEXT P26520 NEXT P16540 Q(1,1)=SQR(Q(1,1))6550 P4=1/Q(1,1)6560 FOR P1=2 TO Q66570 Q(1,P1)=Q(1,P1)*P46580 NEXT P16590 IF Q5<2 THEN 67706600 FOR P1=2 TO Q56610 Q7=P1-16620 FOR P2=P1 TO Q66630 FOR P3=1 TO Q76640 Q(P1,P2)=Q(P1,P2)-Q(P3,P1)*Q(P3,P2)6650 NEXT P36660 NEXT P26670 IF Q(P1,P1)<1.0E-10 THEN 67706680 Q(P1,P1)=SQR(Q(P1,P1))6690 P3=1/Q(P1,P1)6700 FOR P2=P1+1 TO Q66710 Q(P1,P2)=Q(P1,P2)*P36720 NEXT P26730 NEXT P16740 GO TO 67706750 PRINT "ERROR:ATTEMPT TO REDUCE DEGREE"6770 C(Q5)=Q(Q5,Q6)/Q(Q5,Q5)6780 P(18)=Q56790 IF P5<1 THEN 68806800 FOR P2=P5 TO 1 STEP -16810 P4=06820 FOR P1=P2+1 TO Q56830 P4=P4+C(P1)*Q(P2,P1)6840 NEXT P16850 C(P2)=(Q(P2,Q6)-P4)/Q(P2,P2)6860 NEXT P26880 Q2=06890 Q1=P6*X(1)+P76900 P3=-Q(1,Q6)^26910 P4=P36920 FOR P1=Q5 TO 1 STEP -16930 P4=P4+Q(P1,Q6)^26940 P3=P3+Y(P1)^26950 Q2=Q2*Q1+C(P1)/P16960 NEXT P16970 P(20)=Q2*Q1/P66980 IF Q6>N THEN 70206990 FOR P1=Q6 TO N7000 P3=P3+Y(P1)^27010 NEXT P17020 P(19)=P4/P37030 REM*** R-SQUARE =   P(19)7040 DELETE Q7050 RETURN 7200 REM7210 REM     Plot Equation to Extrapolation Point7220 REM*************************************************7230 O2=217240 FOR T0=J TO T STEP (T-J)*0.17250 V=C(1)7260 FOR I=1 TO P(18)-17270 V=V+C(I+1)*(P(16)*T0+P(17))^I7280 NEXT I7290 DRAW @O1,O2:T0,V7295 O2=207300 NEXT T07310 RETURN 7500 REM7510 REM      EXPERIMENT EVALUATION7520 REM**********************************7530 MOVE G1,07535 PRINT "* Tm DETERMINATION"7540 REM **** Get End Pts of Line Segments7545 A$="Heat Effect:"7550 GOSUB 40007560 DELETE 2000,39997565 DELETE 5000,56997570 A=MEMORY7600 REM ***** Advance Tape to Segment 17605 READ @X7:T,V7610 IF T<>0 THEN 76257615 GOSUB 3007620 GO TO 76057625 G5=T7630 IF T<E1 THEN 76057635 REM***** Fill up Vectors for Segment 17640 K=E27650 GOSUB 57007660 REM*****FIT TO CURVE7670 GOSUB 60007700 REM***** Save Curve 1 Coeffs.7710 DELETE C17720 DIM C1(Q5+2)7730 C1(1)=P(16)7740 C1(2)=P(17)7750 FOR I=1 TO Q57760 C1(I+2)=C(I)7770 NEXT I7800 REM*****Fill Heat Effect Vector7805 DELETE X0,Y07806 DIM X0(N6),Y0(N6)7810 I=07820 I=I+17830 READ @X7:X0(I),Y0(I)7832 IF X0(I)<>0 THEN 78407834 GOSUB 3007836 GO TO 78307840 G5=X0(I)7850 IF X0(I)=>E3 THEN 78657855 IF I<N6 THEN 78207860 PRINT "Truncate at ";X0(I)7861 I=I+17865 N9=I-17870 REM***** Fill Vectors for Segment 27872 K=E47874 GOSUB 57007880 REM***** Fit to Curve7885 GOSUB 60007900 REM***** Save Curve2 Coeffs.7910 DELETE C27915 DIM C2(Q5+2)7920 C2(1)=P(16)7925 C2(2)=P(17)7930 FOR I=1 TO Q57932 C2(I+2)=C(I)7934 NEXT I7990 REM***** Overlay Interpolation Rtn7995 PRINT ""8000 PRINT "Enter S(Straight Line) or C(Curved Line) Extrapolation: ";8010 INPUT U$8020 IF U$<>"S" AND U$<>"C" THEN 80008030 FIND @X8:4*(U$="S")+6*(U$="C")8100 GO TO 909999 END 
1 REM default device is the screen.2 GO TO 1203 REM  user definable key 1 will use the plotter4 INIT 5 U=16 V=1307 GO TO 180100 REM  SNOWFLAKES110 REM  TEKniques, Vol 1 no 10120 INIT 130 PAGE 140 REM U IS THE UNIT NUMBER (1=PLOTTER, 32=SCREEN)150 U=32160 REM  V is the maximum viewport minus 20 (130=plotter,110=screen)170 V=110180 SET DEGREES 190 WINDOW -20,20,-20,20200 L=10210 REM R1 is the number of flakes, (20 to 35)220 R1=RND(-1)*20+15230 DIM X1(R1),Y1(R1)240 FOR Q=1 TO R1250 REM X1,Y1 is the random location.260 X1(Q)=RND(-1)*V270 Y1(Q)=RND(-1)*80280 REM  If too close to previous flakes, try again.290 Q0=Q-1300 IF Q0=0 THEN 340310 IF ABS(X1(Q0)-X1(Q))<10 AND ABS(Y1(Q0)-Y1(Q))<10 THEN 250320 Q0=Q0-1330 GO TO 300340 REM A is the rotation angle of the flake350 A=RND(-1)*60360 ROTATE A365 PRINT @U,25:A370 VIEWPORT X1(Q),X1(Q)+20,Y1(Q),Y1(Q)+20380 REM J is the number of "spikes"390 J=INT(RND(-1)*4+5)400 DIM X(5*J-4),Y(5*J-4)410 D1=L/(J-1)420 REM h is the maximum length of a "spike"430 REM H=TAN(30)*.5*1/SIN(60)*2 (if you care)440 H=0.6666667*L450 FOR I=1 TO 5*J STEP 5460 REM d2 is the cumulative distance from center.470 D2=D1*(I-1)/5480 REM M is the actual "spike" length.490 M=(H-H*ABS(D2-L/2)/(0.5*L))*RND(-1)500 REM move out a distance d510 X(I)=D1520 Y(I)=0530 IF I>4*J THEN 670540 REM calculate x,y at 60 degree angle550 X(I+1)=0.5*M560 Y(I+1)=0.866025*M570 REM  return to center line580 X(I+2)=-X(I+1)590 Y(I+2)=-Y(I+1)600 REM draw lower spike.610 X(I+3)=X(I+1)620 Y(I+3)=-Y(I+1)630 REM return to center line.640 X(I+4)=-X(I+1)650 Y(I+4)=Y(I+1)660 NEXT I670 FOR R=0 TO 300 STEP 60680 ROTATE R+A685 PRINT @U,25:R+A690 MOVE @U:0,0700 RDRAW @U:X,Y710 NEXT R720 REM reset rotation angle to original730 ROTATE A735 PRINT @U,25:A740 REM R2 is the number of concentric hexagons.750 R2=RND(-1)*6760 FOR J=1 TO R2770 REM S is the size of the hexagon780 S=RND(-1)*J*1.5790 MOVE @U:0,0800 RMOVE @U:S,0810 REM this loop draws a hexagon s units big.820 FOR I=0 TO 360 STEP 60830 ROTATE A+I835 PRINT @U,25:A+I840 RDRAW @U:S*-0.5,S*0.866025850 NEXT I860 NEXT J870 DELETE X,Y880 NEXT Q890 END 
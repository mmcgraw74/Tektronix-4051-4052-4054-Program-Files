10 REM ADVENTURE VERSION 1.011 REM WRITTEN BY CHUCK SMITH, GCS MARKETING12 REM MODIFICATION OF ORIGINAL PROGRAM IN CREATIVE COMPUTING13 REM NOVEMBER 1979 ISSUE VOL 5, NO. 1114 REM BY BENJAMIN MOSER, JAMES MADISON HIGH SCHOOL15 REM VIENNA, VIRGINIA16 REM LAYOUT BY DON WOODS, AND WILLIE CROTHER (M.I.T.)17 PAGE 18 PRINT "Adventure Version 1.0"40 DIM B$(100),C$(100),D$(100),R$(4000)50 DIM S(99),V(100),K(200),O(15)60 REM DIRECTIONS?70 PRINT "Welcome to Adventure!   (Version 1.1)"72 PRINT "
Would you like instructions? ";80 GOSUB 986090 IF Z0=0 THEN 9591 Z9=40292 GOSUB 762095 REM INITIALIZE POSSIBLE ROUTES100 DELETE A$102 DIM A$(40)103 R$=""104 FIND@5:4105 FOR Z1=1 TO 100106 INPUT @5:A$107 R$=R$&A$108 NEXT Z1109 FIND@5:4110 DELETE A$111 DIM A$(100)112 REM TOTAL ROOMS, ITEMS, KEYWORDS115 C$=""120 L1=INT(RND(0)*4)+1121 L2=L1122 G=0123 B0=1124 S9=1125 D1=1126 D2=0127 T=1128 B1=0129 B2=0130 P1=0131 L=0132 C=0133 D3=0134 B3=0135 D0=2136 T1=100137 T2=35138 T3=149139 R0=0140 C0=0141 S=0142 V=0143 FOR Z2=1 TO T2144 READ S(Z2)145 NEXT Z2146 DATA 18,25,23,24,21,52,0,71,74,58,59,69,66,82,100,7,49,7,7147 DATA 7,7,12,13,40,38,69,0,46,0,0,15,60,82,22,0148 FOR I=1 TO 15149 READ O(I)150 NEXT I151 DATA 1,2,2,2,2,3,4,3,3,2,5,3,2,3,3152 REM COMMAND INPUT ROUTINE153 REM PRINT ROOM,ITEMS320 IF L1<13 OR L1=58 OR (L=1 AND (S(18)=L1 OR S(18)=-1)) THEN 350330 PRI "It is now pitch dark. If you proceed you may fall into a pit."340 GO TO 400350 GOSUB D0+1 OF 6780,8000,8170360 IF V(L1)<>0 THEN 370361 V(L1)=1370 GOSUB 6650380 GOSUB 7800390 REM INPUT LOOP--MULTIPLE COMMANDS, REMOVE JUNK CHARACTERS400 IF LEN(C$)>0 THEN 500410 PRINT ">";420 INPUT C$421 SET NORMAL 430 IF C$="" THEN 410440 REM UPPER CASE450 FOR X=1 TO LEN(C$)460 S$=SEG(C$,X,1)461 Z5=ASC(S$)462 IF Z5<97 OR Z5>122 THEN 470463 Z5=Z5-32464 Z$=CHR(Z5)465 C$=REP(Z$,X,1)466 GO TO 480470 IF Z5>64 AND Z5<91 OR (Z5>47 AND Z5<58) OR Z5=46 THEN 480472 C$=REP(" ",X,1)480 NEXT X490 S$=SEG(C$,LEN(C$),1)491 IF S$="." THEN 500492 C$=C$&"."500 Z4=POS(C$,".",1)501 IF Z4>0 THEN 508502 A$=C$503 C$=""505 GO TO 515508 A$=SEG(C$,1,Z4-1)510 C$=SEG(C$,Z4+1,LEN(C$)-Z4)515 A$=" "&A$520 A$=A$&" "560 REM SEARCH A$ FOR KEYWORDS, PUT KWD CODE INTO K(X)580 DATA 1,"GOLD",1,"NUGGET",2,"BARS",2,"SILVER",3,"JEWELRY",4,"COINS"590 DATA 5,"DIAMONDS",6,"MING",6,"VASE",7,"PEARL",8,"EGGS",8,"NEST"600 DATA 9,"TRIDENT",10,"EMERALD",11,"PLATINUM",11,"PYRAMID",12,"CHAIN"610 DATA 13,"SPICES",14,"PERSIAN",14,"RUG",15,"TREASURE",15,"CHEST"620 DATA 16,"WATER",17,"OIL",18,"LAMP",18,"LANTERN",19,"KEYS",20,"FOOD"630 DATA 21,"BOTTLE",22,"CAGE",23,"ROD",23,"WAND",24,"CLAM"635 DATA 25,"MAGAZINE",26,"BEAR",27,"AXE",28,"VELVET",28,"PILLOW"636 DATA 29,"SHARDS",30,"OYSTER",31,"BIRD",32,"TROLL",33,"DRAGON"637 DATA 34,"SNAKE",35,"DWARF",36,"ROCK",36,"BOULDER",37,"STAIRS"638 DATA 38,"STEPS",39,"HOUSE",39,"BUILDING",40,"GRATE",41,"STREAM"640 DATA 47,"ALL",47,"EVERYTHING"641 REM DIRECTIONS650 DATA 100,"N",100,"NORTH",101,"NE",102,"E",102,"EAST",103,"SE"651 DATA 104,"S",104,"SOUTH",105,"SW",106,"W",106,"WEST",107,"NW"652 DATA 108,"U",108,"UP",109,"D",109,"DOWN"653 REM VERBS655 DATA 110,"PLUGH",111,"XYZZY",112,"PLOVER",113,"CROSS",114,"CLIMB"656 DATA 115,"JUMP",116,"FILL",117,"EMPTY",117,"POUR",118,"LOOK"657 DATA 118,"L",119,"LIGHT",119,"ON",120,"EXTINGUISH",120,"OFF"658 DATA 121,"IN",121,"ENTER",122,"LEAVE",122,"OUT",123,"INVENTORY"659 DATA 123,"I",124,"GET",124,"CATCH",124,"TAKE",125,"DROP"660 DATA 125,"DUMP",126,"THROW",127,"ATTACK",127,"KILL",128,"FEED"661 DATA 129,"WATER",130,"LOCK",131,"UNLOCK",132,"FREE",132,"RELEASE"662 DATA 133,"WAVE",134,"OPEN",135,"CLOSE",136,"OIL",137,"EAT"663 DATA 138,"DRINK",139,"FEE FIE FOE FOO",140,"SHORT",141,"LONG"664 DATA 142,"BRIEF",143,"QUIT",143,"STOP",143,"END",144,"SCORE"665 DATA 145,"SAVE",146,"LOAD",147,"READ",147,"EXAMINE",148,"YES"666 DATA 149,"BUG",150,"*"780 RESTORE 580790 K=0800 Z1=0801 Z3=0810 REM T3=TOTAL # OF KEYWORDS820 IF Z1>T3 THEN 900821 SET NORMAL 830 READ Z1,B$840 B$=" "&B$841 B$=B$&" "850 REM IF KEYWORD WAS FOUND, NOTE THIS IN K(Z1)860 IF POS(A$,B$,1)=0 THEN 820861 K(Z1)=1880 GO TO 820890 REM EXOTIC WORDS...900 REM970 FOR Z1=110 TO T3980 IF K(Z1)>0 THEN 2090990 NEXT Z11000 REM THEN IT'S A DIRECTION1010 FOR D=1 TO 101020 IF K(D+99)=>1 THEN 10701030 NEXT D1040 REM COMMAND NOT A DIRECTION1050 GO TO 19801060 REM CAN HE MOVE THAT WAY?1070 REM DETERMINE POSSIBLE ROUTES FROM CURRENT LOCATION1080 A$=SEG(R$,(L1-1)*40+1,40)1110 REM A$=ROOM DIRECTIONS1120 S$=SEG(A$,(D-1)*4+1,4)1121 Z2=VAL(S$)1130 IF Z2=255 THEN 12401140 IF Z2<1 OR Z2>254 THEN 12201150 REM NORMAL MOVING1160 REM CHECK FOR SPECIAL MOVE CONDITIONS1170 GO TO 12401180 L2=Z21185 L1=L21190 IF S(35)<>L2 THEN 12001195 S(35)=L11200 GO TO 97801210 GO TO 3201220 Z9=11221 GOSUB 76201230 GO TO 4001240 REM SPECIAL ROOM DIRECTIONS1260 IF L1=10 AND (D=10 OR D=5) THEN 12701262 IF L1=11 AND (D=9 OR D=3) THEN 12701264 GO TO 13101265 STOP 1270 REM IF GRATE IS OPEN (G=1) MOVE HIM1280 IF G>0 THEN 11801290 Z9=101291 GOSUB 76201300 GO TO 4001310 REM CAN'T TAKE NUGGETS UPSTAIRS1320 IF NOT(L1=17 AND D=9 AND S(1)=-1) THEN 13501330 Z9=381331 GOSUB 76201340 GO TO 4001350 REM CRYSTAL BRIDGE AND FISSURE1360 IF NOT(L1=19 AND D=7 OR L1=20 AND D=3) THEN 14001370 IF B2>0 THEN 11801380 Z9=31381 GOSUB 76201390 GO TO 4001400 REM MT. KING AND SNAKE1410 IF NOT(L1=22 AND D<>3 AND D<>9) THEN 14601420 IF S9=0 THEN 11801430 Z9=501431 GOSUB 76201440 GO TO 4001460 REM BEDQUILT & RANDOM DIRECTIONS1470 IF NOT(L1=44 AND D<>3 AND D<>7) THEN 15801480 IF RND(0)>0.5 THEN 15101490 Z9=521491 GOSUB 76201500 GO TO 4001510 RESTORE 15301520 REM ROOMS TO JUMP TO1530 DATA 33,37,45,92,761540 FOR Z3=1 TO INT(RND(0)*5)+11550 READ Z21560 NEXT Z31570 GO TO 11801580 REM WITTS END1590 IF L1<>39 THEN 16801600 REM SHOULD WE LET HIM GET OUT1610 IF RND(0)<0.1 THEN 16501620 REM NO1630 Z9=521631 GOSUB 76201640 GO TO 4001650 REM YES1660 Z2=381670 GO TO 11801680 REM NARROW TUNNEL1690 IF NOT(L1=57 OR L1=58) THEN 17701700 FOR Z3=1 TO T21710 IF Z3=10 THEN 17501720 IF S(Z3)<>-1 THEN 17501730 Z9=531731 GOSUB 76201740 GO TO 4001750 NEXT Z31760 GO TO 11801770 REM TROLL1780 IF NOT(L1=60 AND D=2 OR L1=61 AND D=6) THEN 18601790 GO TO T+1 OF 1180,1800,1820,18401800 Z9=551801 GOSUB 76201810 GO TO 4001820 Z9=561821 GOSUB 76201825 Z9=551826 GOSUB 76201830 GO TO 4001840 T=21850 GO TO 11801860 IF NOT(L1=73 AND D=1 AND D2=0) THEN 18901870 Z9=571871 GOSUB 76201880 GO TO 4001890 IF NOT(L1=82 AND S(33)=L1 AND D=1) THEN 19301900 REM DRAGON1910 Z9=511911 GOSUB 76201920 GO TO 4001930 GO TO 11801980 REM ITEM BUT NO VERB?1990 RESTORE 99602000 FOR X=1 TO 352010 READ D$2020 IF K(X)<=0 THEN 20302022 PRINT "What do you want to do with the ";D$;"?";2024 GO TO 4102030 NEXT X2040 RESTORE 20702050 FOR X=1 TO INT(RND(0)*4+1)2051 READ B$2052 NEXT X2060 PRINT B$2070 DATA "What?","I don't understand,","I can't understand that "2071 DATA "I don't know that word."2080 GO TO 4002090 Z1=Z1-1092091 IF Z1<=0 OR Z1>40 THEN 20402094 IF Z1>10 THEN 21022100 GO TO Z1 OF 2120,2220,2300,2390,2570,2640,2680,2860,2930,30002102 IF Z1>20 THEN 21052103 Z2=Z1-102104 GO TO Z2 OF 3080,3130,3290,3450,3580,3920,4160,4430,4630,48002105 IF Z1>30 THEN 21112107 Z2=Z1-202110 GO TO Z2 OF 4950,5060,5190,5410,5560,5760,5810,5920,6000,60902111 Z2=Z1-302114 GO TO Z2 OF 6230,6270,6310,6350,6410,8970,9080,9220,4490,93302118 GO TO 20402120 REM PLUGH2130 IF L1<>7 THEN 21702140 IF S(35)<>L1 THEN 21502141 S(35)=02150 Z2=262160 GO TO 11802170 IF L1<>26 THEN 22002180 Z2=72190 GO TO 11802200 Z9=22201 GOSUB 76202210 GO TO 4002220 REM XYZZY2230 IF L1<>7 THEN 22702240 IF S(35)<>L1 THEN 22502241 S(35)=02250 Z2=132260 GO TO 11802270 IF L1<>13 THEN 22002280 Z2=72290 GO TO 11802300 REM PLOVER (CAN'T BRING EMERALD WITH HIM)2310 IF L1<>26 THEN 23602320 IF S(35)<>L1 THEN 23302321 S(35)=02330 IF S(10)<>-1 THEN 23402331 S(10)=L12340 Z2=582350 GO TO 11802360 IF L1<>58 THEN 22002370 Z2=262380 GO TO 11802390 REM CROSS2400 IF L1<>19 THEN 24702410 IF B2<>0 THEN 24402420 Z9=32421 GOSUB 76202430 GO TO 4002440 D=72450 REM JUST GIVE NEW DIRECTION, USE MOVE ROUTINE2460 GO TO 10702470 IF L1<>20 THEN 25102480 IF B2=0 THEN 24202490 D=32500 GO TO 10702510 IF L1<>60 THEN 25402520 D=22530 GO TO 10702540 IF L1<>61 THEN 22002550 D=62560 GO TO 10702570 REM CLIMB2580 IF L1<>50 THEN 22002590 REM CAN HE CLIMB BEANSTALK?2600 IF P1<2 THEN 22002610 REM YES2620 Z2=702630 GO TO 11802640 REM JUMP STRICTLY SUICIDAL2650 IF L1<>16 AND L1<>19 AND L1<>20 AND L1<>27 THEN 22002660 Z9=42661 GOSUB 76202670 GO TO 95502680 REM FILL2690 IF S(21)=-1 THEN 27302700 B$="BOTTLE"2710 PRINT "YOU DON'T HAVE THE ";B$2720 GO TO 4102730 IF B0=0 THEN 27602740 Z9=52741 GOSUB 76202750 GO TO 4102760 IF L1<7 AND L1>9 AND L1<>35 AND L1<>74 AND L1<>81 THEN 27902770 B0=12775 S(16)=-12780 GO TO 28402790 IF L1=49 THEN 28302800 B$="oil"2810 PRINT "I SEE NO ";B$;" HERE."2820 GO TO 4002830 B0=22835 S(17)=-12840 PRINT "The bottle is now filled"2850 GO TO 4002860 REM EMPTY2870 IF S(21)=-1 THEN 28902880 GO TO 27002890 REM EMPTY BOTTLE (ASSUMED FULL)2900 S(B0+15)=02905 B0=02910 PRINT "EMPTIED"2920 GO TO 4002930 REM LOOK2940 IF L1<13 OR L1=58 OR (L=1 AND (S(18)=L1 OR S(18)=-1)) THEN 29702950 Z9=452951 GOSUB 76202960 GO TO 4002970 GOSUB 80502980 GOSUB 66802990 GO TO 4003000 REM LIGHT3010 IF S(18)=-1 THEN 30403020 B$="LAMP"3030 GO TO 27103040 L=13050 B$="on"3060 PRINT "The lamp is now ";B$3070 GO TO 29403080 REM OFF EXTINGUISH3090 IF S(18)=-1 THEN 31103100 GO TO 30203110 L=03115 B$="off"3120 GO TO 30603130 REM ENTER3140 IF L1<>6 THEN 31803150 REM TO HOUSE3160 D=33170 GO TO 10703180 IF L1<>68 THEN 32203190 REM TO BARREN ROOM3200 D=33210 GO TO 10703218 REM READ DIRECTION FILE FOR LEGAL PATHS (FILE # 4)3220 FIND@5:43230 FOR X=1 TO L13232 INPUT @5:A$3234 NEXT X3240 FOR Z0=1 TO 103250 S$=SEG(A$,(Z0-1)*4+1,4)3252 Z2=VAL(S$)3260 IF Z2>0 AND Z2<101 THEN 11503270 NEXT Z03280 GO TO 22003290 REM LEAVE3300 IF L1<>7 THEN 33403310 REM LEAVE HOUSE3320 D=73330 GO TO 10703340 IF L1<>69 THEN 33803350 REM LEAVE BARREN ROOM3360 D=73370 GO TO 10703375 REM READ DIRECTION FILE FOR LEGAL PATHS (FILE # 4)3380 FIND@5:43390 FOR X=1 TO L13392 INPUT @5:A$3400 FOR Z0=1 TO 103402 S$=SEG(A$,(Z0-1)*4+1,4)3404 Z2=VAL(S$)3420 IF Z2>0 AND Z2<101 THEN 11503430 NEXT Z03440 GO TO 22003450 REM INVENTORY3460 RESTORE 99603470 Z0=03480 PRINT "You are carrying:"3490 FOR X=1 TO T23500 READ B$3510 IF S(X)<>-1 THEN 35403520 PRINT B$3530 Z0=Z0+13540 NEXT X3550 IF Z0<>0 THEN 35603552 PRINT "Nothing"3560 PRINT 3570 GO TO 4003580 REM GET3620 RESTORE 5803630 IF K(47)>0 THEN 36803640 GOSUB 82803650 IF Z8>0 THEN 36803660 PRINT "Get what?"3670 GO TO 20403680 RESTORE 99603690 FOR Z3=1 TO T23700 READ A$3710 IF K(47)>0 THEN 37303720 IF K(Z3)=0 THEN 39003730 IF S(Z3)<>L1 THEN 37503740 GO TO 37903750 IF K(47)>0 THEN 39003760 PRINT A$;" not here."3770 GO TO 39003780 REM MUST CHECK LEGALITY OF TAKING ITEM3790 Z8=03800 FOR X=1 TO T23810 IF S(X)<>-1 THEN 38203812 X8=Z8+13820 NEXT X3830 IF Z8<7 THEN 38803840 REM CARRYING TOO MUCH3850 Z9=543851 GOSUB 76203860 GO TO 4103870 GO TO 68803880 S(Z3)=-13890 PRINT A$;" taken."3900 NEXT Z33910 GO TO 4003920 REM DROP3930 RESTORE 5803940 IF K(47) THEN 40003950 GOSUB 82803960 IF Z8>0 THEN 39903970 PRINT "Drop what?"3980 GO TO 20403990 REM4000 RESTORE 99604010 FOR Z3=1 TO T24020 READ B$4030 IF K(47)>0 THEN 40604040 IF K(Z3)<>1 THEN 41404050 IF S(Z3)=0 THEN 41404060 IF S(Z3)=-1 THEN 41004070 IF K(47)>0 THEN 41404080 PRINT "You don't have the ";B$4090 GO TO 41404100 REM ELABORATE ON DROP (BIRD IN CAGE, BOTTLE)4110 GO TO 73804120 PRINT B$;" dropped"4130 S(Z3)=L14140 NEXT Z34150 GO TO 4004160 REM throw4170 GOSUB 82804180 IF Z8>0 THEN 42104190 PRINT "Throw what?"4200 GO TO 20404210 IF S(Z3)<>-1 THEN 27104220 IF NOT(Z3<16 AND S(32)=L1) THEN 42604230 REM THROW TREASURE TO TROLL4240 Z9=274241 GOSUB 76204242 S(Z3)=04244 T=34250 GO TO 4004260 IF NOT(Z3=27 AND S(32)=L1) THEN 43004270 REM TRYING TO BUTCHER TROLL?4280 Z9=264281 GOSUB 76204285 S(27)=L14290 GO TO 4004300 IF NOT(Z3=27 AND S(35)=L1) THEN 43804310 REM TRYING TO KILL DWARF4320 IF RND(0)>0.5 THEN 43604330 Z9=294331 GOSUB 76204340 GOSUB 86504350 GO TO 44104360 Z9=304361 GOSUB 76204365 S(35)=04370 GO TO 44104380 REM NOTHING SPECIAL, JUST DROP ITEM4390 IF S(35)<>L1 THEN 44004395 GOSUB 85504400 PRINT "Thrown."4410 S(Z3)=L14420 GO TO 4004430 REM ATTACK4440 GOSUB 82804450 IF NOT(Z3=33 AND S(Z3)=L1 AND L1=82) THEN 45204460 REM HE CAN KILL DRAGON4470 Z9=684471 GOSUB 76204480 GO TO 4104490 IF L1<>82 THEN 20404500 Z9=694501 GOSUB 76204502 S(33)=04504 D1=04510 GO TO 4004520 IF S(32)<>L1 THEN 45604530 REM TRYING TO MUNGE TROLL4540 Z9=254541 GOSUB 76204550 GO TO 4004560 IF NOT(Z3=26 OR Z3>30) THEN 46004570 REM DANGEROUS TO ATTACK THESE4580 Z9=704581 GOSUB 76204590 GO TO 4004600 REM NOTHING TO ATTACK4610 Z9=714611 GOSUB 76204620 GO TO 4004630 REM FEED4640 GOSUB 82804650 IF Z3<>35 THEN 46904660 REM CAN'T FEED DWARF4670 Z9=244671 GOSUB 76204680 GO TO 4004690 IF S(20)=-1 THEN 47204700 B$="FOOD"4710 GO TO 27104720 IF L1=69 THEN 47604730 PRINT "I can't feed it."4740 Z9=234741 GOSUB 76204750 GO TO 4004760 IF S(28)=L1 THEN 76004770 B1=14775 S(20)=04780 Z9=64781 GOSUB 76204790 GO TO 4004800 REM WATER4810 IF S(16)=-1 THEN 48404820 B$="water"4830 GO TO 27104840 IF L1<>50 THEN 22004850 GO TO P1+1 OF 4860,4890,49204860 Z9=74861 GOSUB 76204870 P1=14872 S(16)=04874 B0=04880 GO TO 4004890 Z9=84891 GOSUB 76204900 P1=24910 GO TO 4004920 Z9=94921 GOSUB 76204930 P1=04940 GO TO 4004942 S(16)=04944 B0=04950 REM LOCK4960 IF L1=10 OR L1=11 THEN 49904970 REM NOTHING LOCKABLE4980 GO TO 22004990 IF S(19)=-1 THEN 50205000 B$="Keys"5010 GO TO 27105020 G=05030 Z9=105031 GOSUB 76205040 GO TO 4005050 S(Z3)=L15060 REM UNLOCK5070 IF S(19)<>-1 THEN 50005080 IF L1<>10 AND L1<>11 THEN 51205090 G=15100 Z9=115101 GOSUB 76205110 GO TO 4005120 IF L1<>69 THEN 22005130 IF B1>0 THEN 51605140 Z9=125141 GOSUB 76205150 GO TO 4005160 IF C<>0 THEN 51705162 C=15164 B1=25170 Z9=135171 GOSUB 76205180 GO TO 4005190 REM FREE5200 IF K(31)>0 THEN 52405210 REM CAN'T FREE ANYTHING BUT BIRD5220 Z9=25221 GOSUB 76205230 GO TO 4105240 IF S(31)<>-1 THEN 52205250 S(31)=L15255 B3=05260 PRINT "Freed."5270 IF L1<>22 THEN 53505280 IF S9<>1 THEN 4005290 B$="snake"5300 PRINT "The little bird attacks the green ";B$;" and ";5310 IF L1=82 THEN 53805320 PRINT "drives it off."5330 S9=05335 S(34)=05340 GO TO 4005350 IF L1<>82 THEN 4005360 B$="dragon"5370 GO TO 53005380 PRINT "gets burned to a crisp."5390 S(31)=05400 GO TO 4005410 REM WAVE5420 IF NOT(K(23)) THEN 22005430 IF S(23)=-1 THEN 54605440 B$="rod"5450 GO TO 27105460 REM IS NEAR FISSURE5470 IF L1<>19 AND L1<>20 THEN 22005480 REM YES5490 GO TO B2+1 OF 5500,55305500 Z9=145501 GOSUB 76205510 B2=15520 GO TO 4005530 Z9=155531 GOSUB 76205540 B2=05550 GO TO 4005560 REM OPEN5570 GOSUB 82805580 IF Z3 THEN 56105590 PRINT "Open ";5600 GO TO 20405610 IF Z3=40 THEN 50705620 IF S(Z3)=L1 THEN 56505630 PRINT "I see no ";B$;" here."5640 GO TO 4005650 IF Z3=24 THEN 56805660 PRINT "I don't know how to open a ";B$5670 GO TO 4005680 IF S(9)=-1 THEN 57105690 Z9=165691 GOSUB 76205700 GO TO 4005710 IF S(Z3)=0 THEN 22005720 REM HE'S OPENED CLAM SO PRINT DESCRIPTION OF THIS5730 REM PUT PEARL IN CUL-DE-SAC5740 S(7)=435741 S(24)=05742 S(30)=L15743 Z9=175744 GOSUB 76205750 GO TO 4005760 REM CLOSE5770 GOSUB 82805780 IF Z3=40 THEN 49605790 Z9=185791 GOSUB 76205800 GO TO 4005810 REM OIL5820 IF K(17)=0 THEN 22005830 IF S(17)=-1 THEN 58605840 B$="oil"5850 GO TO 56305860 IF L1<>73 THEN 22005870 REM IS DOOR STILL RUSTED?5880 IF D2=1 THEN 22005890 D2=15891 S(17)=05892 B0=05893 Z9=195894 GOSUB 76205900 GO TO 4005910 REM EAT5920 IF K(20) THEN 59505930 Z9=205931 GOSUB 76205940 GO TO 4105950 Z3=205960 GOSUB 84905970 IF Z5=0 THEN 4105979 Z9=735980 GOSUB 76205981 S(20)=05982 B0=05990 GO TO 4006000 REM DRINK6010 IF K(16) THEN 60406020 Z9=216021 GOSUB 76206030 GO TO 4106040 Z3=166050 GOSUB 84906060 IF Z5=0 THEN 4106069 Z9=226070 GOSUB 76206071 S(17)=06072 B0=06080 GO TO 4006090 REM FEE FIE FOE FOO6100 IF L1=71 THEN 61306110 Z9=26111 GOSUB 76206120 GO TO 4106130 IF S(8)<>L1 THEN 61806140 REM MAKE NEST VANISH6150 Z9=796151 GOSUB 76206160 S(8)=06170 GO TO 4006180 IF S(8)=0 THEN 61106190 S(8)=L16200 REM MAKE NEST RE-APPEAR6210 Z9=816211 GOSUB 76206220 GO TO 4006230 REM SHORT6240 PRINT "Short descriptions"6250 D0=06260 GO TO 4006270 REM LONG6280 PRINT "Long descriptions"6290 D0=16300 GO TO 4006310 REM BRIEF6320 PRINT "OK, I'll only describe the room in detail the first time."6330 D0=26340 GO TO 4006350 REM QUIT6360 PRINT "Save game";6370 GOSUB 98606380 IF Z0 THEN 89706390 GO TO 97506400 REM SCORE6410 GOSUB 64306420 GO TO 4006430 REM PRINT OUT SCORE DATA6440 GOSUB 65106450 PRINT "Your score is ";S06451 PRINT "You have explored ";Z9/T1*T1;"% of the cave."6460 RESTORE 64706470 DATA "BEGINNER","NOVICE","EXPERIENCED","ADVANCED","EXPERT"6480 FOR Z0=0 TO INT((S0-1)/100)6481 READ D$6482 NEXT Z06490 PRINT "That makes you a ";D$;" adventurer."6500 RETURN 6510 REM COMPUTE CURRENT SCORE6520 RESTORE 1466530 Z9=06535 S0=06540 FOR Z0=1 TO 156550 READ Z16560 IF Z1=0 THEN 65906570 IF NOT(V(Z1)) THEN 65806572 S0=S0+4*O(Z0)6580 IF S(Z0)<>7 THEN 65906581 S0=S0+4*O(Z0)6590 NEXT Z06600 S0=S0+10*(G=1)+20*(S9=0)+30*(D1=0)+30*(T=0)+20*(B1=2)6610 S0=S0+20*(B2=1)+20*(P1=2)+20*(D2=1)+20*(S9=1)6620 FOR Z0=1 TO T16622 IF NOT(V(Z0)) THEN 66306624 S0=S0+16626 Z9=Z9+16630 NEXT Z06640 RETURN 6650 REM LIST ITEMS AT LOCATION L16680 FIND@5:66690 FOR Z1=1 TO T26700 INPUT @5:A$6710 IF S(Z1)<>L1 THEN 67206712 PRINT A$6720 NEXT Z16730 REM CHECK FOR DWARF, PIRATE6740 GOSUB 85606750 GOSUB 88006760 PRINT 6770 RETURN 6780 REM PRINT SHORT LOCATION DESCRIPTION6781 REM STORED IN FILE # 86810 FIND@5:86820 FOR Z1=1 TO L16830 INPUT @5:A$6840 NEXT Z16850 V(L1)=16860 PRINT A$6870 RETURN 6880 REM SPECIAL "GET"S6890 IF NOT(Z3=24 OR Z3=30 OR Z3>31) THEN 69306900 REM CAN'T GET THESE FOR SOME REASON6910 Z9=616911 GOSUB 76206920 GO TO 4006930 IF NOT(Z3=12 AND C=0) THEN 69706940 REM CHAIN6950 Z9=506951 GOSUB 76206960 GO TO 39006970 REM BEAR IS HE FED? UNLOCKED?6980 IF NOT(Z3=26 AND B1<>2) THEN 70106990 Z9=616991 GOSUB 76207000 GO TO 39007010 IF NOT(Z3=14 AND D1=1) THEN 70507020 REM DRAGON AND RUG7030 Z9=597031 GOSUB 76207040 GO TO 39007050 IF NOT(Z3=16 OR Z3=17) THEN 70907060 REM OIL & WATER-DO SAME AS FILL7070 PRINT "Why not say 'fill'?"7080 GO TO 39007090 IF NOT(Z3=22 AND B3) THEN 71407100 REM TAKE BIRD, SINCE IT'S IN CAGE7110 S(31)=-17120 PRINT "Bird and ";7130 GO TO 38807140 IF Z3<>31 THEN 73107150 REM GETTING BIRD7160 IF B3<>1 THEN 72107170 REM TAKE CAGE, SINCE BIRD IS IN IT7180 PRINT "Cage and ";7190 S(22)=-17200 GO TO 38807210 IF S(22)=-1 THEN 72407220 B$="cage"7230 GO TO 28107240 IF S(23)=-1 THEN 72807250 REM OK TO TAKE BIRD7260 S(31)=-17261 B3=17270 GO TO 38907280 REM ROD SCARES BIRD7290 Z9=377291 GOSUB 76207300 GO TO 39007310 REM BOTTLE FULL? IF SO, GET CONTENTS7320 IF NOT(Z3=21 AND B0) THEN 73607330 PRINT "Contents and the ";7340 S(B0+15)=-17350 GO TO 38807360 GO TO 38807370 REM SPECIAL "DROP"7380 IF Z3<>31 THEN 74407390 REM BIRD IN CAGE7400 S(31)=L17402 S(22)=L17406 B3=17410 IF Z3<>31 THEN 74207412 PRINT "Cage and ";7420 IF Z3<>22 THEN 74307422 PRINT "Bird and ";7430 GO TO 41207440 IF Z3=22 AND B3 THEN 74007450 IF Z3<>21 THEN 75207460 REM BOTTLE7470 IF B0=0 THEN 41207480 REM BOTTLE IS FULL, SO DROP CONTENTS TOO7490 PRINT "Contents and ";7500 S(15+B0)=L17510 GO TO 41207520 IF NOT(Z3=16 OR Z3=17) THEN 75507530 PRINT "Try saying 'empty'"7540 GO TO 41407550 IF Z3<>6 THEN 41207560 IF S(28)=L1 THEN 76007570 REM GOODBYE, FRAGILE VASE!7580 Z9=437581 GOSUB 76207582 S(6)=07583 S(28)=07584 S(29)=L17590 GO TO 4007600 Z9=607601 GOSUB 76207610 GO TO 41207620 REM PRINT MESSAGE SUBROUTINE7630 REM MESSAGES KEPT IN FILE # 57640 IF Z9<>2 THEN 76507642 Z9=2+INT(RND(0)*5)/107650 IF Z9<>61 THEN 76607652 Z9=Z9+INT(RND(0)*5)/107660 FIND@5:57670 ON EOF (0) THEN 77607680 INPUT @5:B$7690 Z5=POS(B$,"#",1)7692 IF Z5=0 THEN 76807700 Z4=VAL(B$)7710 IF Z4<>Z9 THEN 76807720 INPUT @5:B$7730 Z5=POS(B$,"#",1)7732 IF Z5>0 THEN 77657740 PRINT B$7750 GO TO 77207760 PRINT "NO DESCRIPTION #";Z9;" IN FILE 5"7765 RETURN 7800 REM SITUATION DESCRIPTIONS7830 REM GRATE7840 IF L1=10 OR L1=11 THEN 78447842 GO TO 78507844 Z9=G+107845 GOSUB 76207850 REM CRYSTAL BRIDGE7860 IF L1=19 OR L1=20 AND B2 THEN 78647862 GO TO 78707864 Z9=147865 GOSUB 76207870 REM PLUGH NOISE7880 IF NOT(L1=26 AND RND(0)>0.3) THEN 78907882 PRINT "A hollow voice says ""plugh""."7890 REM IRON DOOR7900 IF NOT(L1=73 AND D2=0) THEN 79107902 Z9=577903 GOSUB 76207910 REM TROLL7920 IF NOT(L1=60 OR L1=61 AND T=1) THEN 79307922 Z9=637923 GOSUB 76207930 REM BEAR7940 IF NOT(L1=69 AND B1=0) THEN 79507942 Z9=647943 GOSUB 76207950 IF NOT(L1=69 AND B1=1) THEN 79607952 Z9=667953 GOSUB 76207960 REM PLANT IN PIT7970 IF NOT(L1=48 OR L1=50) THEN 79807972 Z9=47+P17973 GOSUB 76207980 RETURN 8000 REM PRINT LONG ROOM DESCRIPTION FROM "AMESSAGE" FILE8010 REM DESCRIPTION IS NORMALLY L1+200 EXCEPT FOR8020 REM MAZE OR FOREST8030 REM SET V(L1)=1 SO AS NOT TO REPEAT LONG DESC(BRIEF MODE)8040 V(L1)=18050 IF L1>4 THEN 80808060 PRINT "You are in a forest, with trees all around you."8070 GO TO 81308080 IF NOT(L1>88 AND L1<98 OR L1=99) THEN 81108090 PRINT "You are in a maze of twisty little tunnels, all alike."8100 GO TO 81308110 REM NORMAL DESCRIPTION8120 Z9=200+L18121 GOSUB 76208130 RETURN 8140 REM BRIEF DESCRIPTION (ONLY PRINT LONG DESCRIPTION IF HE8150 REM HASN'T BEEN AT L1 BEFORE8160 REM8170 REM ALWAYS GIVE LONG DESCRIPTION FOR FOREST AND MAZE8190 IF L1<5 OR (L1>88 AND L1<98) OR L1=99 THEN 82208200 IF V(L1) THEN 67808210 REM HE HASN'T SEEN THIS ROOM, SO GIVE A LONG DESC.8220 V(L1)=18230 GO TO 80008250 REM FETCH FIRST ITEM CODE IN K(1 TO T2)8260 REM Z8=TOTAL # OF ITEMS FOUND IN LIST8270 REM Z3=ITEM CODE FIRST FOUND8280 Z8=08282 Z3=08290 RESTORE 99608300 FOR Z5=1 TO 458310 READ B$8320 IF K(Z5)=0 THEN 83608330 Z8=Z8+18340 D$=B$8350 IF NOT(K(Z5) AND Z8=1) THEN 83608352 Z3=Z58360 NEXT Z58370 B$=D$8380 RETURN 8390 REM FIND FIRST ITEM AT ROOM8400 RESTORE 99608410 FOR Z1=1 TO 478420 IF NOT(K(Z1)) THEN 84308422 RETURN 8430 READ D$8440 NEXT Z18450 RETURN 8470 REM MAKE SURE HE'S CARRYING ITEM # Z38490 IF S(Z3)=-1 THEN 85308500 PRINT "You don't have the ";A$8510 Z5=08520 RETURN 8530 Z5=18540 RETURN 8550 REM DWARF8560 IF D3<>0 THEN 86408570 REM SHOULD DWARF GIVE AWAY AXE8580 IF L1=>13 THEN 85908582 RETURN 8590 IF RND(0)<=0.05 THEN 86008592 RETURN 8600 REM GIVE AWAY AXE8610 Z9=808611 GOSUB 76208620 S(27)=L18622 D3=18630 RETURN 8640 REM SHOULD DWARF ATTACK?8650 IF L1=>13 THEN 86608655 RETURN 8660 IF S(35)<>L1 THEN 87708670 IF RND(0)<=0.5 THEN 86808675 RETURN 8680 REM YES!8690 Z9=328691 GOSUB 76208700 REM DOES THE KNIFE KILL PLAYER8710 IF RND(0)>0.25 THEN 87508720 REM YES8730 PRINT "It gets you!"8740 GO TO 95408750 PRINT "It misses!"8760 RETURN 8770 REM SHOULD WE PUT A DWARF HERE?8780 IF RND(0)=>0.2 THEN 87908785 S(35)=L18790 RETURN 8800 REM PIRATE8810 REM FIRST, DOES HE HAVE ANYTHING WORTH STEALING?8820 Z3=08825 IF L1=>13 THEN 88408830 RETURN 8840 FOR X=1 TO 158850 IF S(X)<>-1 THEN 88608855 Z3=Z3+18860 NEXT X8870 IF Z3=>INT(RND(0)*4)+1 THEN 88808875 RETURN 8880 REM SHOULD WE RIP OFF HIS VALUABLES?8890 IF RND(0)<0.05 THEN 89208900 Z9=348901 GOSUB 76208910 RETURN 8920 Z9=338921 GOSUB 76208930 FOR X=1 TO 158940 IF S(X)<>-1 THEN 89508945 S(X)=1008950 NEXT X8960 RETURN 8965 REM SAVE GAME8970 PRINT "WHICH FILE NUMBER DO YOU WISH TO SAVE GAME? (7): ";8975 INPUT N8980 FIND@5:N8985 PRINT @5:T1,T2,T3,L1,L2,G,B0,S9,D1,D2,D0,T,B1,B2,P1,D,L,C,D3,B3,R09040 PRINT @5:S,V9050 PRINT "GAME SAVED!"9060 IF NOT(K(143)) THEN 4109070 GOSUB 64309072 END 9080 REM LOAD OLD GAME9090 IF C0=0 THEN 91209100 PRINT "You already have a loaded game!"9110 GO TO 4109120 PRINT "ENTER FILE NUMBER OF SAVED GAME. (7): ";9125 INPUT N9130 FIND@5:N9170 INPUT @5:T1,T2,T3,L1,L2,G,B0,S9,D1,D2,D0,T,B1,B2,P1,D,L,C,D3,B3,R09180 INPUT @5:S,V9190 PRINT "Starting new game..."9200 C0=19210 GO TO 3209220 REM READ THE MAGAZINE9230 GOSUB 82809240 IF Z3=25 THEN 92709250 Z9=749251 GOSUB 76209260 GO TO 4109270 IF S(25)=-1 THEN 93009280 B$="magazine"9290 GO TO 27109300 REM OK, LET HIM READ IT9305 Z9=4039306 GOSUB 76209320 GO TO 4009330 REM BUG9340 PRINT "ENTER FILE # TO ENTER BUG OR COMPLAINT INFO. (9): ";9345 INPUT N9350 FIND@5:N9351 Z0=TYP(N)9352 IF Z0=0 THEN 94009355 ON EOF (0) THEN 94009360 INPUT @5:A$9365 GO TO 93609400 PRINT "ENTER YOUR NAME, DATE AND TIME: ";9405 INPUT A$9410 PRINT @5:A$9415 PRINT "
ENTER YOUR GRIPE IN UP TO 5 LINES (TYPE CR TO QUIT):"9420 FOR Z0=1 TO 59425 PRINT Z0;":";9430 INPUT A$9435 IF A$="" THEN 94509440 PRINT @5:A$9445 NEXT Z09450 PRINT "MESSAGE RECORDED. THANK YOU!"9455 FIND@5:N9460 GO TO 4109540 REM REINCARNATE HIM9550 R0=R0+19560 GO TO R0 OF 9580,9610,97409570 REM ASK HIM IF HE WANTS TO BE REINCARNATED9580 Z9=759581 GOSUB 76209585 GOSUB 98609600 GO TO 96309610 Z9=779611 GOSUB 76209620 GO TO 95809625 IF Z0=0 THEN 97509630 Z9=769631 GOSUB 76209640 REM PUT HIM BACK IN HOUSE, REARRANGE HIS STUFF9645 S(18)=79650 L=09670 FOR X=1 TO T29680 IF S(X)<>-1 THEN 96909685 S(X)=L19690 NEXT X9700 REM WE'VE PUT THE LAMP IN HOUSE AND OTHER ITEMS WHERE HE DIED9710 L1=INT(RND(0)*4)+19715 L2=L19720 GO TO 3209730 REM THIRD DEATH--END OF GAME9740 Z9=789741 GOSUB 76209750 PRINT "Oh well..."9760 GOSUB 64309770 STOP 9780 REM PITS9790 IF L1<13 OR (L=1 AND (S(18)=-1 OR S(18)=L1)) THEN 12109800 REM IS HE GOING TO FALL INTO PIT?9810 IF L1=16 OR L1=17 OR L1=19 OR L1=20 OR L1=25 OR L1=47 THEN 98409815 IF L1=48 OR L1=59 OR L1=60 OR L1=61 OR L1=75 OR L1=76 THEN 98409820 IF L1=98 THEN 98409825 GO TO 12109830 REM HE FELL IN!9840 Z9=449841 GOSUB 76209850 GO TO 95409860 REM SEEK A YES OR NO9870 Z0=09875 INPUT A$9877 A$=SEG(A$,1,1)9890 IF A$<>"Y" AND A$<>"N" THEN 99309900 IF A$<>"Y" THEN 99209905 Z0=19920 RETURN 9930 PRINT "YES OR NO-";9940 GO TO 98709950 REM  SHORT NAMES FOR STUFF9960 DATA "large gold nugget","bars of silver","precious jewelry"9965 DATA "many coins","several diamonds","fragile ming vase"9970 DATA "glistening pearl","nest of golden eggs"9975 DATA "jewel encrusted trident","egg-sized emerald"9980 DATA "platinum pyramid","golden chain","rare spices"9985 DATA "persian rug","treasure chest","water","oil","brass lamp"9990 DATA "keys","food","bottle","wicker cage","3-foot black rod"9995 DATA "clam","magazine","bear","axe","velvet pillow"10000 DATA "shards of pottery","oyster","bird","troll","dragon"10005 DATA "snake","dwarf","rock","stairs","house","grate","stream"10010 DATA "room","bridge","pit","volcano","road"
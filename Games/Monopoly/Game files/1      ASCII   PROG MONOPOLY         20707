1 REM***MONOPOLY GAME BY MCM & MCT 5/79*** updated Aug2024 by MCM2 INIT 3 GO TO 1004 IF L0=0 THEN 32105 SET NOKEY 6 L0=17 RETURN 8 IF F1<>0 THEN 79 SET NOKEY 10 GO TO 256012 IF F1<>0 THEN 713 SET NOKEY 14 GO TO 930016 IF F1<>0 THEN 717 SET NOKEY 18 GO TO 871032 PRINT @5,9:"ROOT"33 FIND @5:134 OLD @5:100 DIM P0(4,2),P2(5),S9(41),S$(468),Q$(40*9*2),B$(91),X$(24),Y$(27)110 DIM E$(1023),R(40,2),D$(231),G0(8),J$(15),M$(6),D5(4),D(2),Z$(45)120 DIM H$(40),I$(2),T$(1188),F$(16),G$(16)130 WINDOW -4.5,15,0,15140 VIEWPORT 0,130,0,100150 J$="T4E4C#EC#EC#EC#"160 F$=""170 G$=""180 K$=""190 L$=""250 I$=CHR(127)260 I$=I$&I$270 DATA 1500,1,1500,1,1500,1,1500,1,0,0,0,0,0,0,0272 DATA 1,0,0,0,0,0,0,0,1,1,0,0,0,0280 READ P0,D5,F1,D3,B9,M1,F1,L0,D6,C9,R1,H1,E1,F5,G5,C4,C5,C6,R8290 FIND @5:45300 FOR I=1 TO 9310 READ @5:H$320 NEXT I330 G0=0340 D8=217*(RND(0)=0.196324846518)+1805*(RND(0)<>0.196324846518)350 IF D8<>217 THEN 380360 M$="MUZAKT"370 GO TO 400380 M$="MUSIC"390 D8=D8/4400 I=RND(-1)410 I=RND(1)420 I=RND(-1)430 PRINT "MONOPOLY GAME BY MCM AND MCT 5/79 - updated August 2024 MCM"440 PRINT "Input number of players (no more than 4): ";450 INPUT P1460 IF P1<2 OR P1>4 THEN 440470 C$=""480 P2=1490 FOR I=1 TO P1500 PRINT "NAME (up to 6 characters) OF PLAYER ";I;" : ";510 INPUT A$520 IF LEN(A$)<=6 THEN 550530 PRINT "MAX of 6 characters, try again"540 GO TO 500550 IF I=1 THEN 690560 B$=SEG(A$,1,1)570 B0=ASC(B$)580 IF B$<>" " AND B$<>"" THEN 610590 PRINT "First Initial cannot be a blank space"600 GO TO 510610 FOR J=1 TO I-1620 D$=SEG(C$,P2(J),1)630 D0=ASC(D$)640 IF B0<>D0 THEN 670650 PRINT "First Initial matches previous player"660 GO TO 500670 NEXT J680 GO TO 720690 B$=SEG(A$,1,1)700 IF B$<>" " AND B$<>"" THEN 720710 GO TO 600720 P2(I+1)=LEN(A$)+P2(I)724 C$=C$&A$726 NEXT I729 REM shuffle Chance&CC cards730 FOR I=51 TO 66734 K$=CHR(I)735 F$=F$&K$736 K$=CHR(I+20)737 G$=G$&K$738 NEXT I740 FOR I=1 TO 15742 K=I+INT(RND(1)*(16-I))743 K$=SEG(F$,K,1)744 L$=SEG(F$,I,1)745 F$=REP(K$,I,1)746 F$=REP(L$,K,1)747 K=I+INT(RND(1)*(16-I))748 K$=SEG(G$,K,1)749 L$=SEG(G$,I,1)750 G$=REP(K$,I,1)751 G$=REP(L$,K,1)752 NEXT I758 A=0760 E$=""770 FIND @5:41780 READ @5:S$,S9,Q$,R790 CLOSE 800 J=-1820 GO TO 1770829 REM display board830 SET NOKEY 840 PAGE 850 MOVE -4.2,15860 I=10870 PRINT "MONOPOLY        ";880 FOR I=1 TO P1890 D$=SEG(C$,P2(I),P2(I+1)-P2(I))900 L=LEN(D$)910 IF L=6 THEN 950920 FOR J=1 TO 6-L930 D$=REP(" ",1,0)940 NEXT J950 PRINT USING "6A,1A,$5D,1X,S":D$,"=",P0(I,1)960 NEXT I970 PRINT "F1-ROLL/ContinueF2-BUY Prop/House"980 PRINT "F3-VIEW AssetsF4-USE Jail card"1000 PRINT "F8-QUIT"1010 MOVE -4.3,14.921020 DRAW -2.15,14.921030 FIND @5:421040 RESTORE 10501050 DATA 1,1,1,2,2,2,2,3,3,1,1,1,1,1,1,1,1,1,1,1,41060 READ A11070 X=01080 Y=01090 GO TO A1 OF 1150,1100,1130,11801100 X=1151110 Y=5.51120 GO TO 11501130 X=116.51140 Y=87.51150 READ @5:E$1160 CALL "RDRAW",E$,1,X,Y1170 GO TO 10601180 FIND @5:441190 READ @5:X$,Y$,Z$1200 FIND @5:461210 READ @5:T$1220 CLOSE 1230 GO TO 13601240 CALL "AGIN",X,Y1250 D(1)=-X1260 D(2)=-Y1270 CALL "CHANGE",D,Z$1280 E$=E$&Z$1290 RETURN 1300 CALL "AGIN",X,Y1310 D(1)=X1320 D(2)=Y1330 CALL "CHANGE",D,Z$1340 E$=E$&Z$1350 RETURN 1360 H0=-0.41370 G1=01380 G0=01390 C0=01400 P4=11410 FOR S=1 TO 401420 IF R(S,1)=0 THEN 16001430 IF R(S,2)=0 THEN 16001440 GOSUB 71101450 P4=R(S,2)1460 C0=11470 GOSUB 19901480 GOSUB 24901490 PRINT @32,21:X,Y1500 PRINT B$1510 G1=R(S,1)1520 IF G1<>1 AND G1<>8 THEN 15701530 IF S=40 THEN 16001540 C0=C0+(R(S+2,2)=P4)*(R(S+2,1)=G1)1550 IF C0=2 THEN 16401560 GO TO 16001570 C0=C0+(R(S+1,2)=P4)*(R(S+1,1)=G1)1580 C0=C0+(R(S+2,2)=P4)*(R(S+2,1)=G1)+(R(S+3,2)=P4)*(R(S+3,1)=G1)1590 IF C0=3 THEN 16401600 NEXT S1610 H0=01620 GOSUB 24901630 RETURN 1640 G0(G1)=P41650 GOSUB 19901660 GOSUB 24901670 PRINT @32,21:X,Y1680 PRINT B$1690 G0(G1)=P41700 FIND @5:451710 FOR J=1 TO G11720 READ @5:E$1730 NEXT J1740 CALL "RDRAW",E$,1,0,01750 GO TO 16001769 REM * MAIN LOOP1770 S=11780 T=11790 H0=01800 GOSUB 8301810 F=01830 FOR P=1 TO P11840 IF P=T THEN 19111850 S=P0(P,2)1860 A$=SEG(C$,P2(P),P2(P+1)-P2(P))1870 B$=SEG(A$,1,1)1880 P4=P1890 GOSUB 24901900 PRINT @32,21:X+0.4*(S>40),Y1910 PRINT B$1911 NEXT P1920 IF C4=0 AND C5=0 THEN 19311921 FOR P4=1 TO P11922 IF C4<>P4 AND C5<>P4 THEN 19301923 S=40+P41924 GOSUB 24901925 Y=Y+91926 PRINT @32,21:X+0.4*(S>40),Y1927 K$=STR((C4=P4)+(C5=P4))1928 K$=SEG(K$,2,1)1929 PRINT K$1930 NEXT P41931 S=11932 P=T1940 P4=T1950 S=P0(T,2)1960 S0=S1970 GOSUB 19901980 GO TO 20301990 A$=SEG(C$,P2(P4),P2(P4+1)-P2(P4))2000 B$=SEG(A$,1,1)2010 GOSUB 24902020 RETURN 2030 MOVE -4.5,10.52040 IF S<41 THEN 20702050 D$="JAIL"2060 GO TO 20802070 D$=SEG(S$,S9(S),S9(S+1)-S9(S))2080 A$=SEG(C$,P2(P4),P2(P4+1)-P2(P4))2090 IF S<100 AND S<>11 THEN 21102100 D$="JUST VISITING"2110 IF D3=0 THEN 21402120 PRINT ">";A$;" is on ";D$;"";"         ";D3;" Double";2130 GO TO 21502140 PRINT ">";A$;" is on ";D$;"";2150 GIN X8,Y82160 P4=T2170 P0(P4,2)=S2229 REM * GAME LOOP2230 SET KEY 2240 GOSUB 61102250 GO TO L0+1 OF 2360,2260,23902260 L0=02270 IF F1<>2 THEN 22902280 F1=12290 IF H1<>2 THEN 23102300 H1=12310 IF R1=0 THEN 23502320 R1=02325 D3=02330 T=(P4+1)*(P4<P1)+(P4=P1)2340 S=P0(T,2)2350 GO TO 18002360 GO TO F1+1 OF 2390,2370,23902370 GOSUB 51502380 F1=02390 GO TO H1+1 OF 2420,2400,24202400 GOSUB 73602410 H1=02420 GOSUB 24902430 PRINT @32,21:X+0.4*(S>40),Y2440 PRINT @32,24:B$2450 GO TO 22302489 REM calc X&Y from S&P4&H02490 P3=P4*(P4<5)*(H0=0)+H0*(H0>0)+9*(H0<0)2500 U$=SEG(T$,(S-1)*27+(P3-1)*3+1,3)2510 CALL "CHANGE",U$,D2520 X=-D(1)2530 Y=-D(2)2540 RETURN 2559 REM Buy property/house2560 H0=-0.42570 S0=S2580 MOVE X8,Y82600 K0=02610 FOR J=1 TO 82620 IF G0(J)=0 OR G0(J)<>T THEN 26402630 K0=12640 NEXT J2660 IF S<41 THEN 26902670 A0=02680 GO TO 27602690 A0=(R(S,1)>0 AND R(S,1)<11)*(R(S,2)=0)2700 IF A0=0 THEN 27602720 R5=82730 GOSUB 78802740 C9=P0(T,1)>R52760 GO TO 2*K0+A0+1 OF 3060,2890,2770,27762770 PRINT "Buy:0=CANCEL2=House or Hotel?";2774 GO TO 27802776 PRINT "Buy:0=CANCEL1=This property2=House or Hotel?";2780 INPUT G12790 GIN X8,Y82800 IF G1<0 OR G1>2 THEN 27602810 GO TO G1+1 OF 3060,2890,28302830 IF F<>0 THEN 28502840 GO TO 73602850 R1=02860 L0=22875 RETURN 2890 IF A0=0 AND K0=0 THEN 28602900 R5=82910 GOSUB 78802920 IF R(S,2)=T THEN 60702925 IF P0(T,1)>R5 THEN 29702930 PRINT "Not enough CASH"2940 GIN X8,Y82950 GO TO 30602970 R(S,2)=T2980 P0(T,1)=P0(T,1)-R52990 MOVE X8,Y83000 PRINT "Bought it!"3010 GIN X8,Y83020 GOSUB 19903030 GOSUB 24903040 PRINT @32,21:X,Y3050 PRINT B$3060 S=S03070 GO TO 28603209 REM ROLL/CONTINUE3210 SET NOKEY 3220 GO TO F1+1 OF 3230,51503230 GO TO H1+1 OF 3240,73603240 GO TO R1+1 OF 3270,32503250 L0=13260 RETURN 3270 D1=INT(1+6*RND(1))3280 D2=INT(1+6*RND(1))3290 R1=13300 D0=D1+D23302 IF E1<>3 THEN 33103304 R1=03306 GO TO 33703310 IF D1<>D2 THEN 33603314 D3=D3+13316 GO TO 33703360 D3=03370 FIND @5:433380 FOR I=1 TO D13390 READ @5:E$3400 NEXT I3410 CALL "RDRAW",E$,1,-2.3,123420 FIND @5:433430 FOR I=1 TO D23440 READ @5:E$3450 NEXT I3460 CALL "RDRAW",E$,1,8-2.3,123470 MOVE -2,9.13480 PRINT "=";D0;3482 IF E1=3 THEN 55503500 IF P0(T,2)<41 THEN 37103510 D5(T)=D5(T)+13520 MOVE X8,Y83530 IF D5(T)=3 AND D3=0 THEN 35803540 IF D3<>0 THEN 36003550 PRINT A$;" still inJAIL"3552 GOSUB 62703555 GIN X8,Y83560 L0=23570 RETURN 3580 R5=503582 GOSUB 88003590 PRINT A$;" paid $50"3600 S0=113610 P0(T,2)=113630 D3=03640 R1=13650 D5(T)=03660 GIN X8,Y83709 REM move player & click3710 S1=S0+D0 MIN 403720 IF S0+D0<=40 THEN 39003730 FOR S=S0+1 TO S13740 GOSUB 50203750 IF S=S0+1 THEN 37703760 CALL "SOUNDS",I$3770 GOSUB 24903780 PRINT @32,21:X,Y3790 PRINT @32,24:B$3795 NEXT S3796 GOSUB 50203797 CALL "SOUNDS",I$3800 IF E1<>4 THEN 38103801 F1=03802 E1=03803 IF D3<>0 THEN 38053804 R1=13805 P0(T,2)=S0-33806 S=S0-33807 GO TO 40703810 S=13820 B9=13850 GOSUB 24903860 PRINT @32,21:X,Y3870 PRINT @32,24:B$3880 S1=S0+D0-403890 S0=13900 FOR S=S0 TO S13910 IF S<>1 THEN 39803920 IF B9=0 THEN 39803930 B9=03940 P0(T,1)=P0(T,1)+2003950 MOVE X8,Y83960 PRINT "Collected $200"3970 GIN X8,Y83980 GOSUB 50203990 IF S=S0 THEN 40104000 CALL "SOUNDS",I$4010 GOSUB 24904020 PRINT @32,21:X,Y4030 PRINT @32,24:B$4040 NEXT S4050 P0(T,2)=S14060 S=S14070 D$=SEG(S$,S9(S),S9(S+1)-S9(S))4080 IF S<>11 THEN 41004090 D$="JUST VISITING"4100 MOVE X8,Y84110 PRINT A$;" is now on";D$;""4120 GIN X8,Y84130 P0(T,2)=S4140 S0=S4150 IF D3=0 THEN 43904160 GO TO D3 OF 4170,4220,42604170 IF S=31 THEN 42704180 PRINT " DOUBLES!"4190 IF S>40 THEN 43504200 PRINT " Roll again."4210 GO TO 43804220 PRINT " Second DOUBLES!"4230 IF S>40 THEN 43504240 PRINT " Roll again."4250 GO TO 43804260 PRINT " Your 3rd DOUBLESGo to JAIL!"4270 PRINT A$;" is nowIN JAIL!"4280 D3=04290 R1=14310 L0=24320 GO TO 47704350 R1=14360 L0=24370 RETURN 4380 R1=04390 GIN X8,Y84400 L0=24410 IF F1=0 THEN 44304420 RETURN 4430 GOSUB 62704459 REM chk if prop owned & pay4460 IF S=39 THEN 45304461 IF S=5 THEN 95004468 IF S=1 OR S=11 OR S=21 THEN 60804469 IF F>50 AND F<90 THEN 50804470 IF S=31 THEN 47704480 E$=SEG(H$,S,1)4490 J=VAL(E$)4500 IF R(S,2)=T THEN 60704510 IF R(S,2)=0 THEN 60804520 P5=R(S,2)4530 R5=14540 IF R(S,1)<>0 THEN 45704550 GOSUB 78804560 GO TO 60204570 R5=1+J4580 GOSUB 78804600 Z$=SEG(C$,P2(P5),P2(P5+1)-P2(P5))4610 PRINT "Owned by ";Z$;""4615 GIN X8,Y84620 IF S<>6 AND S<>16 AND S<>26 AND S<>36 THEN 46704630 GOSUB 79404640 R5=R5*M14650 M1=14660 GO TO 60104670 IF S<>13 AND S<>29 THEN 47004680 GOSUB 80104690 GO TO 60104700 IF R(S,1)>8 THEN 60104710 R6=R54720 R5=1+J4730 GOSUB 78804740 R5=R6+R5*(J=0 AND G0(R(S,1))<>0)4750 GO TO 60104769 REM go to jail4770 CALL M$,J$4780 S=314790 IF C1=8 THEN 48104800 GOSUB 62704810 GOSUB 24904820 PRINT @32,21:X,Y4830 CALL "AGIN",X1,Y14840 PRINT @32,24:B$4850 P0(T,2)=40+T4860 S=40+T4870 D5(T)=04880 GOSUB 24904882 PRINT @32,21:X,Y4885 CALL "AGIN",X2,Y24890 X6=(X2-X1)/104900 Y6=(Y2-Y1)/104920 FOR I=1 TO 104930 GOSUB 50204940 CALL "SOUNDS",I$4950 PRINT @32,21:X1+X6*I,Y1+Y6*I4960 PRINT @32,24:B$4970 NEXT I4980 D3=04990 R1=15000 GO TO 60905019 REM click delay5020 FOR J=1 TO D85030 NEXT J5040 RETURN 5079 REM Chance&CC actions5080 GO TO C1 OF 5090,5090,5090,5090,5650,5790,5090,5950,5980,59905090 S0=S5100 D$=SEG(S$,S9(C2),S9(C2+1)-S9(C2))5110 D$=SEG(D$,1,16)5120 GO TO C1 OF 5210,5420,5600,5620,5650,5790,5920,5950,5980,59905130 D$=SEG(D$,1,13)5150 IF E1<>4 THEN 51585151 FOR S=S0-1 TO S0-3 STEP -15152 GOSUB 50205153 IF S=S0-1 THEN 37705154 GO TO 37605158 GOSUB 37105159 GOSUB 62705160 F1=05170 IF D3<>0 THEN 51905180 R1=15190 GO TO E1 OF 5300,5480,5480,3730,5650,5790,5920,5950,5980,59905210 D0=(C2<S)*(40-S+C2)+(S<C2)*(C2-S)5220 PRINT "";"Press F1 toAdvance to";D$5230 E1=C15240 E2=C25250 E3=C35260 F1=25270 R1=05280 L0=25290 RETURN 5300 F1=05310 E1=05320 E2=05330 E3=05340 IF D3<>0 THEN 53605350 R1=15360 P5=R(S,2)5370 IF P5=0 THEN 60805380 IF P5=T THEN 60705390 GO TO 44605395 IF R5<>0 THEN 60105400 GO TO 60905420 C2=(S<6)*6+(S>6 AND S<16)*16+(S>16 AND S<26)*265430 C2=C2+(S>26 AND S<36)*36+(S>36)*65440 D$=SEG(S$,S9(C2),S9(C2+1)-S9(C2))5450 M1=25470 GO TO 52105480 F1=05500 E2=05510 E3=05520 IF D3<>0 THEN 55325530 R1=15532 P5=R(S,2)5533 IF P5<>0 THEN 55365534 PRINT "No Owner"5535 GO TO 60805536 K$=SEG(C$,P2(P5),P2(P5+1)-P2(P5))5540 IF E1<>3 THEN 55565545 IF P5=T THEN 60705546 PRINT K$;" is ownerENTER to ROLL"5547 INPUT K$5548 GIN X8,Y85549 GO TO 32705550 E1=05551 MOVE X8,Y85552 R5=10*D05554 E1=05555 GO TO 60105556 E1=05557 M1=15559 IF P5=0 THEN 60905560 IF P5=T THEN 60705570 GOSUB 79405580 R5=R5*25585 PRINT "Owned by ";K$5590 GO TO 60105600 C2=(S<13)*13+(S>13 AND S<29)*29+(S>29)*135601 D$=SEG(S$,S9(C2),S9(C2+1)-S9(C2))5604 GO TO 52105620 C2=S-C25622 D$=SEG(S$,S9(C2),S9(C2+1)-S9(C2))5624 PRINT "";"Press F1 toBack up to";D$5630 GO TO 52305650 R5=C25660 IF C3=2 THEN 57005670 GOSUB 88005680 PRINT "Paid $";R55690 GO TO 60805700 FOR P5=1 TO P15710 IF P5=T THEN 57605720 A$=SEG(C$,P2(P5),P2(P5+1)-P2(P5))5730 P0(P5,1)=P0(P5,1)+R55750 PRINT A$;" got $";R55760 NEXT P55770 GO TO 60805790 R5=C25800 IF C3=2 THEN 58405810 P0(T,1)=P0(T,1)+R55820 PRINT "Collected $";R55830 GO TO 60805840 FOR P5=1 TO P15850 IF P5=T THEN 59005860 A$=SEG(C$,P2(P5),P2(P5+1)-P2(P5))5870 T=P55872 GOSUB 88005874 T=P45880 P0(T,1)=P0(T,1)+R55890 PRINT A$;" paid $";R55900 NEXT P55910 GO TO 60805950 PRINT A$;" is in JAIL"5960 GO TO 47705980 IF F=75 THEN 59835981 C4=T5982 GO TO 59845983 C5=T5984 PRINT A$;" got a card"5985 GO TO 60805990 IF S=8 OR S=23 OR S=37 THEN 59955991 R2=405993 R3=1155994 GO TO 80905995 R2=255996 R3=1005997 GO TO 80906010 IF R(S,2)=0 OR P5=0 THEN 60806015 P0(P5,1)=P0(P5,1)+R56020 GOSUB 88006030 PRINT A$;" paid $";R56050 GO TO 60806070 PRINT A$;" owns it."6080 GIN X8,Y86082 E1=06084 M1=16090 RETURN 6109 REM Vectrex gamepad6110 RETURN 6120 INPUT @5,31:X9,Y9,Q1,Q2,Q3,Q46130 J=(Q1=0)*1+(Q2=0)*2+(Q3=0)*3+(Q4=0)*46150 GO TO J+1 OF 6160,4,8,12,166160 RETURN 6269 REM - VIEW A CARD - use random for Chance & Community Chest6270 IF S<41 THEN 62786272 F=926274 GO TO 64906278 IF S<>8 AND S<>23 AND S<>37 THEN 63006280 GOSUB 85006290 GO TO 64906300 IF S<>3 AND S<>18 AND S<>34 THEN 63306310 GOSUB 86006320 GO TO 64906330 IF S<>1 AND S<>11 THEN 63606340 F=(S-1)/10+916350 GO TO 64906360 IF S<>21 AND S<>31 THEN 64806370 F=(S-1)/10+916380 FIND @5:F6390 FOR I=1 TO 46400 READ @5:E$6410 CALL "RDRAW",E$,1,0,06420 NEXT I6430 READ @5:X9,Y96440 READ @5:K$6450 IF K$="|EOC|" THEN 65806460 CALL "APRINT",K$,1,X9,Y96470 GO TO 64306480 F=S6490 FIND @5:F6500 READ @5:E$6510 CALL "RDRAW",E$,1,0,06520 READ @5:X9,Y96530 READ @5:K$6540 IF K$="|EOC|" THEN 65806550 CALL "APRINT",K$,1,X9,Y96552 IF S>40 THEN 66006560 GO TO 65206570 REM read Chance, Community Card and GoToJAIL square action data6580 IF F>50 AND F<90 THEN 66806590 IF S=31 THEN 66406600 C1=06610 C2=06620 C3=06630 GO TO 66906640 C1=86650 C2=116660 C3=06670 GO TO 66906680 READ @5:C1,C2,C36690 L0=26700 CLOSE 6710 RETURN 6739 REM buy house/hotel6740 IF S>40 THEN 31206750 IF R(S,1)=0 OR R(S,1)>10 THEN 31206760 GO TO 63006770 IF R(S,2)=0 THEN 28906780 IF K<>0 THEN 68306790 IF R(S,1)>8 THEN 68106800 IF G0(R(S,1))=T THEN 68306810 PRINT "Not a group owner"6820 GO TO 70806830 R5=76840 GOSUB 78806860 IF P0(T,1)>R5 THEN 68906870 PRINT "Not enough CASH"6880 GO TO 70806890 E$=SEG(H$,S,1)6900 J=VAL(E$)6910 IF J<5 THEN 69506920 PRINT "You have a HOTEL!"6930 GO TO 70806949 REM ok to buy a house or hotel6950 P0(T,1)=P0(T,1)-R56960 PRINT "You paid $";R56970 GIN X8,Y86980 J=J+16990 E$=STR(J)7000 E$=SEG(E$,2,1)7010 H$=REP(E$,S,1)7020 GOSUB 71107030 MOVE X8,Y87040 IF J<5 THEN 70707050 PRINT "to buy a HOTEL!"7060 GO TO 70807070 PRINT "to buy a HOUSE!"7080 GIN X8,Y87090 GO TO 28607109 REM Draw all purchased houses/hotels on property "S"7110 E$=SEG(H$,S,1)7120 J=VAL(E$)7130 IF J=0 THEN 73107140 IF J<5 THEN 72407150 H0=8*(S<11 OR S>31)+5*(S>11 AND S<31)7160 GOSUB 24907170 PRINT @32,21:X,Y7180 CALL "AGIN",X0,Y07190 IF S<11 OR (S>21 AND S<31) THEN 72207200 CALL "ADRAW",Z$,1,X0,Y07210 GO TO 73107220 CALL "ADRAW",Y$,1,X0,Y07230 GO TO 73107240 FOR K=1 TO J7250 H0=4+K7260 GOSUB 24907270 PRINT @32,21:X,Y7280 CALL "AGIN",X0,Y07290 CALL "ADRAW",X$,1,X0,Y07300 NEXT K7310 H0=-0.47320 GOSUB 24907330 PRINT @32,21:X,Y7340 RETURN 7359 REM make list of this player group properties to select from7360 FIND @5:27370 READ @5:E$7380 CALL "RDRAW",E$,1,0,07390 MOVE 4,10.97400 GIN X7,Y77410 PRINT A$;" owns these groups:"7420 FIND @5:457430 FOR J=1 TO 97440 READ @5:E$7450 NEXT J7460 FOR J=1 TO 87470 READ @5:E$7480 IF G0(J)<>T THEN 75107490 MOVE 3.8,9.8-J*0.77500 PRINT E$7510 NEXT J7520 MOVE X8,Y87530 PRINT "Enter group#0=CANCEL     ";7540 INPUT G17550 PRINT 7560 IF G1=0 THEN 76007570 IF G1>8 THEN 75307580 IF G0(G1)=T THEN 76207590 PRINT "Not your group!"7600 GIN X8,Y87610 GO TO 28607620 FOR J=1 TO 407630 IF R(J,1)<>G1 THEN 76707640 D$=SEG(S$,S9(J),S9(J+1)-S9(J))7650 D$=SEG(D$,1,13)7660 PRINT J;" ";D$7670 NEXT J7680 PRINT "Enter property#0=CANCEL       ";7690 INPUT L7700 PRINT 7710 IF L=0 THEN 76007720 IF L<0 OR L>40 THEN 76807730 IF R(L,1)=G1 THEN 77607740 PRINT "Not in this group"7750 GO TO 76807760 PRINT 7770 S=S07780 L0=27790 R1=D3>07800 E$=SEG(H$,L,1)7810 J=VAL(E$)7820 IF J=5 THEN 69207830 IF R(L,1)<>G1 THEN 76807840 GIN X8,Y87850 S=L7860 GO TO 67707879 REM Read Property Rent (S,R5) Subroutine, return value in R5:7880 D$=SEG(Q$,(S-1)*18+(R5-1)*2+1,1)7890 K=ASC(D$)7900 D$=SEG(Q$,(S-1)*18+(R5-1)*2+2,1)7910 R5=K*128+ASC(D$)7920 RETURN 7939 REM Read Railroad Rent (S,based on P5), return value in R5:7940 R5=(R(6,2)=P5)+(R(16,2)=P5)+(R(26,2)=P5)+(R(36,2)=P5)7950 D$=SEG(Q$,(S-1)*18+(R5-1)*2+1,1)7960 K=ASC(D$)7970 D$=SEG(Q$,(S-1)*18+(R5-1)*2+2,1)7980 R5=K*128+ASC(D$)7990 RETURN 8009 REM Read Utility Rent (S,based on P5), return value in R5:8010 R5=(R(13,2)=P5)+(R(29,2)=P5)8020 D$=SEG(Q$,(S-1)*18+(R5-1)*2+1,1)8030 K=ASC(D$)8040 D$=SEG(Q$,(S-1)*18+(R5-1)*2+2,1)8050 R5=(K*128+ASC(D$))*D08060 RETURN 8088 REM calculate street repairs for Chance or CC8089 REM R2=cost per house, R3=cost per hotel, R4=#houses, R7=#hotels8090 R4=08100 R7=08110 FOR I=1 TO 408115 IF R(I,2)<>T THEN 81908120 E$=SEG(H$,I,1)8130 J=VAL(E$)8140 IF J=0 THEN 81908150 IF J=5 THEN 81808160 R4=R4+J8170 GO TO 81908180 R7=R7+18190 NEXT I8200 PRINT A$8210 IF R7=0 THEN 82608220 R5=R7*R38225 PRINT "For hotels:"8230 GOSUB 88008240 PRINT "$";R7*R3;"for ";R7;" hotels"8250 GO TO 82708260 PRINT "Has no hotels"8270 IF R4=0 THEN 83208280 R5=R4*R28285 PRINT "For houses:"8290 GOSUB 88008300 PRINT "$";R4*R2;"for ";R4;" houses"8310 GO TO 83308320 PRINT "Has no houses"8330 GO TO 60808499 REM calculate next Chance card F$ file# from index F58500 K$=SEG(F$,F5,1)8510 F5=(F5+1)*(F5<16)+(F5=16)8520 F=ASC(K$)8522 IF F=59 AND C4<>0 THEN 85008530 RETURN 8599 REM calculate next Comm Chest card G$ file# from index G58600 K$=SEG(G$,G5,1)8610 G5=(G5+1)*(G5<16)+(G5=16)8620 F=ASC(K$)8622 IF F=75 AND C5<>0 THEN 86008630 RETURN 8709 REM F6 key pressed, check if in Jail and has card8710 IF P0(T,2)<41 OR R1=1 THEN 87648720 MOVE X8,Y88730 GO TO (C4=T OR C5=T)+1 OF 8760,87408740 PRINT A$;"Played JAIL card";A$;" is nowJUST VISITING"8743 IF C4=T THEN 87468744 C5=08745 GO TO 87528746 C4=08752 S=118753 S0=118754 P0(T,2)=118755 GO TO 60808760 PRINT A$;"Has no JAIL card"8762 GIN X8,Y88764 RETURN 8799 REM check if payment would bankrupt player8800 IF R5<P0(T,1) THEN 88908810 PRI A$;"Does not have$";R5;"";A$;"is bankrupt!!GAME OVER!!"8830 END 8890 P0(T,1)=P0(T,1)-R58900 RETURN 8999 REM mortgage list, R$ has mortgaged flags, R7=taxable, R8 bypass9000 FIND @5:29010 READ @5:E$9020 CALL "RDRAW",E$,1,0,09030 MOVE 4,10.99040 GIN X7,Y79050 PRINT "  ";A$;" owns these assets"9060 MOVE 4,10.49070 PRINT "       $Price Values:"9080 MOVE 4,9.69090 PRINT "Property       House  Hotel"9100 L=19105 S8=S9107 R7=09110 FOR S=2 TO 409120 IF R(S,2)<>T THEN 92809130 K$=SEG(S$,S9(S),S9(S+1)-S9(S))9140 K$=SEG(K$,1,7)9150 E$=SEG(H$,S,1)9160 J=VAL(E$)9190 R5=89200 GOSUB 78809210 A8=R59220 R5=79230 GOSUB 78809235 IF R8=1 THEN 92759240 MOVE 3.7,9.4-L*0.39250 L=L+19260 IMAGE 2D,1X,7A,1X,$3D,1X,1D,1X,$3D,1X,1D,$4D9265 J1=J=59270 PRINT USING 9260:S,K$,A8,J*(J<5),R5*J*(J<5),J1,J1*INT(J*R5)9275 R7=R7+A8+R5*J9280 NEXT S9281 IF R8=1 THEN 92869282 MOVE 3.7,9.4-(L+1)*0.39284 PRINT "Asset total = $";R79286 S=S89287 R8=09288 RETURN 9299 REM VIEW assets9300 GIN X8,Y89310 GOSUB 90009320 GO TO 43609499 REM Income Tax9500 MOVE X8,Y89510 PRINT "Choose:1=10%2=$200:?";9520 INPUT L9530 IF L<1 OR L>2 THEN 95109535 GIN X8,Y89540 GO TO L OF 9550,95909550 R8=19560 GOSUB 91009562 R8=09564 R5=INT(0.1*(R7+P0(T,1))+0.5)9570 PRINT "";A$;" has $";R7;"in propertiesand $";P0(T,1);" cash"9580 GO TO 60209590 R5=2009600 GO TO 60209699 REM check all rent values9700 FOR S=1 TO 409710 PRINT "";S;9720 FOR I=1 TO 99730 R5=I9740 GOSUB 78809750 PRINT R5;" ";9760 NEXT I9770 NEXT S9780 END 
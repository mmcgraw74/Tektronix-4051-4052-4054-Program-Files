1 REM Star Trek Graphics - mods for UDK&CMD keys by Monty McGraw 9/20192 SET KEY3 GO TO 1004 REM-----------------------STATUS REPORT5 PRINT "Short Range Scan"6 GO TO 28908 REM-----------------------LONG SCAN & STATUS REPORT9 PRINT "Long Range Scan"10 GIN A3,A411 GO TO 334012 REM----------------------FIRE PHASORS14 PRINT "Fire Phasors"15 GO TO 341016 REM----------------------SINGLE PHOTON TORPEDO17 PRINT "Fire Torpedo"18 GO TO 369020 REM----------------------DAMAGE REPORT21 PRINT "Damage Report"22 GO TO 533024 REM----------------------FIRE MULTIPLE TORPEDOES25 PRINT "Fire Multiple Torpedoes"26 GO TO 569028 REM----------------------QUADRANT SCAN29 PRINT "Single Quadrant Scan"30 GO TO 581032 REM----------------------COMMAND INFO33 PAGE34 GOSUB 131035 GO TO 103036 REM----------------------SHOW KNOWN GALAXY37 PRINT "Show Known Galaxy"38 GO TO 776040 REM----------------------MOVE to new COURSE41 PRINT "Move to new ";42 GO TO 169044 REM--------------Cheet switch45 Q=046 Q(1,1)=99947 Q(1,8)=9048 Q(8,1)=9049 Q(8,8)=9050 GO TO 430100 REM------------------BEGIN-----------------------------------------110 PAGE120 INIT130 SET DEGREES140 PRINT "---------------STAR TREK Graphics-----------      "150 GOSUB 1310160 REM165 B=RND(-1)166 B=RND(1)170 B=1180 DIM M1(4),M2(4),H(8,8),P5(58)185 B$=CHR(35)190 H=0200 P6=0210 M1(1)=0220 M2(1)=0.125230 M1(2)=-0.125240 M2(2)=0250 M1(3)=0260 M2(3)=-0.125270 M1(4)=0.125280 M2(4)=0290 GO TO 300300 REM E=ENTERPRISE STATUS MATRIX310 REM Q=QUADRANT MATRIX320 REM S=SECTOR MATRIX330 REM T=SECONDARY STATUS MATRIX340 DIM E(10),E1(6),E$(6),F$(6),G$(6),T(7),S(8,8),Q(8,8),Q$(255),L(3)350 DIM W$(6),P$(1),U$(1),V$(1),X$(1)360 FOR I=1 TO 8370 FOR I1=1 TO 8380 Q(I,I1)=INT(RND(B)+0.45)*INT(RND(B)*6)*100390 Q(I,I1)=Q(I,I1)+INT(RND(B)+0.15)*10400 Q(I,I1)=Q(I,I1)+INT(RND(B)*10)410 NEXT I1420 NEXT I430 FOR I=1 TO 3440 I9=INT(RND(B)*8)+1450 I8=INT(RND(B)*8)+1460 Q(I9,I8)=Q(I9,I8)+10470 NEXT I480 N5=0490 T9=0500 E(1)=INT(RND(B)*8)+1510 E(2)=INT(RND(B)*8)+1520 E(3)=INT(RND(B)*8)+1530 E(4)=INT(RND(B)*8)+1540 GOSUB 4260550 GOSUB 8070560 E(5)=3000570 E(6)=10580 E(7)=0590 E(8)=0600 E(9)=0610 E(10)=3620 T(1)=3000+(INT(RND(B)*8)+1)*100630 T(2)=T(1)+80+INT(RND(B)*20)640 T(4)=0650 T(5)=0660 T(6)=0670 FOR I=1 TO 8680 FOR I1=1 TO 8690 I9=INT(Q(I,I1)/100)700 I8=INT((Q(I,I1)-I9*100)/10)710 T(5)=T(5)+I9720 T(6)=T(6)+I8730 NEXT I1740 NEXT I750 T(4)=INT(Q(E(1),E(2))/100)760 REM -------------------------GAME-INITIAL-STATUS-------------------770 REM780 PRINT "ORDERS:  STARDATE = ";T(1)790 PRINT " AS COMMANDER OF THE UNITED STARSHIP ENTERPRISE,";800 PRINT "YOUR MISSION IS TO RID"805 PRINT "THE GALAXY OF THE DEADLY KLINGON MENACE. TO DO THIS, YOU ";810 PRINT "MUST DESTROY"815 PRINT "THE KLINGON INVASION FORCE OF ";T(5);" BATTLE CRUISERS.";830 PRINT "  YOU HAVE "834 PRINT T(2)-T(1);" SOLAR YEARS TO COMPLETE YOUR MISSION.";850 PRINT " (I.E. UNTIL STARDATE ";T(2);")"860 FUZZ 4.2870 PRINT880 PRINT " YOU HAVE ";T(6);" SUPPORTING STAR BASES.  WHEN THE";890 PRINT " STARSHIP ENTERPRISE DOCKS"895 PRINT "AT A STARBASE (IS POSITIONED NEXT TO ONE) IT IS RESUPPLIED "900 PRINT "WITH ENERGY AND PHOTON TORPEDOES."920 PRINT "THE ENTERPRISE IS CURRENTLY IN QUADRANT: ";E(1);" - ";E(2);930 PRINT ", SECTOR ";E(3);" - ";E(4)932 PRINT "
Type U for User Definable Keys or Return for CMDs: ";940 INPUT Q$945 A5=0946 IF Q$<>"U" THEN 950947 A5=1950 T(3)=0960 IF T(4)<>0 THEN 980970 GO TO 990980 E(10)=2990 E$="DOCKED"1000 F$="RED"1010 G$="GREEN"1020 REM ---------------------------PROGRAM-RE-ENTRY-POINT-------------1030 IF E(10)=1 THEN 16501040 IF T(4)=0 THEN 12401050 IF E(10)=1 THEN 16101060 C=01070 FOR I=1 TO 81080 FOR I1=1 TO 81090 IF S(I,I1)<>2 THEN 11801100 C=C+11110 C1=SQR((I-E(3))^2+(I1-E(4))^2)1120 C2=300+INT(RND(0)*90)1130 C2=C2/C11140 PRINT USING 1150:C2," UNIT HIT FROM KLINGON FROM SECTOR",I," -",I11150 IMAGE 4D.2D,35A,1D,3A,1D1160 T(7)=C21170 GOSUB 48401180 NEXT I11190 NEXT I1200 PRINT USING 1210:E(5)," UNITS OF ENERGY LEFT."1210 IMAGE 4D.2D,35A1220 FOR I=1 TO 5001230 NEXT I1240 IF T(3)=0 THEN 12601250 GO TO 12701260 T(3)=101270 IF T(3)=10 THEN 29001280 PRINT "COMMAND? ";1282 REM A5=1 if UDK is selected1284 IF A5=0 THEN 12901286 END1290 GO TO 90001300 REM---------------------COMMAND LIST------------------------------1310 PRINT "UDK- CMD (Press UDK or type CMD) /expend\";1315 PRINT "               Directions"1320 PRINT " 1 - S (Short Range Scan)   none"1325 PRINT "        _"1330 PRINT " 2 - L (Long Range Scan)    none"1335 PRINT "        _"1340 PRINT " 3 - P (Fire Phaser)        selectable"1345 PRINT "             _"1350 PRINT " 4 - T (Photon Torpedoes)   50 energy units"1355 PRINT "               _"1360 PRINT " 5 - D (Damage Status)      none"1365 PRINT "        _"1370 PRINT " 6 - O (Multiple Torpedoes) 50 energy units"1375 PRINT "                  _"1380 PRINT " 7 - Q (One Quadrant Scan)  100 energy units"1385 PRINT "            _"1390 PRINT " 8 - I (Command Info)       none"1395 PRINT "                _"1400 PRINT " 9 - G (Chart of Galaxy)    500 energy units"1405 PRINT "                 _"1410 PRINT "10 - M (Move)               Warp sets energy"1415 PRINT "        _"1420 WINDOW 0,130,0,1001430 VIEWPORT 0,130,0,1001440 MOVE 107,79.51450 PRINT "O"1460 RMOVE -0.9,-2.51470 PRINT "^^"1480 RMOVE 0,-2.31490 PRINT "!!"1500 FOR I=360-45 TO 0 STEP -451510 MOVE 107+0.7,79.5-21520 RMOVE 4*SIN(I),4*COS(I)1530 RDRAW 8*SIN(I),8*COS(I)1540 RMOVE 4*SIN(I)-4,4*COS(I)1550 PRINT I;1560 NEXT I1570 PRINT "00"1580 MOVE 0,601590 RETURN1600 REM---------------------------------------------------------------1610 PRINT " STARBASE SHEILDS PROTECT THE ENTERPRISE"1620 PRINT "FROM ATTACK BY KLINGONS"1630 GO TO 12401640 REM----------------------------1650 PRINT "ENTERPRISE RESUPPLIED"1660 E(6)=101670 E(5)=30001680 GO TO 10401690 REM---------------------------SET-COURSE--------------------------1700 C=121710 IF E(7)=0 THEN 17601720 PRINT "DAMAGED WARP DRIVES"1730 PRINT "IMPULSE ENGINES CAN DRIVE"1740 PRINT "THE ENTERPRISE BETWEEN 0 AND .2 WARP"1750 C=0.21760 PRINT "COURSE (degrees):";1770 INPUT C11780 PRINT "WARP FACTOR:";1790 INPUT C21800 IF C2<0 THEN 18301810 IF C2>C THEN 18301820 GO TO 18501830 PRINT " WARP FACTOR ERROR...REENTER"1840 GO TO 17801850 X1=COS(C1+180)1860 Y1=SIN(C1+180)1870 T5=8.7*C21880 S(E(3),E(4))=01890 FOR L1=1 TO T51900 I9=INT(E(3)+X1+SGN(E(3)+X1)*0.5)1910 I8=INT(E(4)-Y1+SGN(E(4)-Y1)*0.5)1920 T9=01930 W5=I91940 GOSUB 47001950 GO TO W5 OF 1960,19901960 W5=I81970 GOSUB 47001980 GO TO W5 OF 2020,20101990 GOSUB 67002000 GO TO 19602010 GOSUB 68302020 F1=T92030 IF T9<>1 THEN 20602040 GOSUB 42602050 GO TO 21402060 IF S(I9,I8)=0 THEN 21202070 IF S(I9,I8)=4 THEN 21202080 T9=F12090 IF T9=1 THEN 20402100 PRINT "ENTERPRISE BLOCKED BY OBJECT AT ";I9;" - ";I82110 GO TO 21502120 E(3)=E(3)+X12130 E(4)=E(4)-Y12140 NEXT L12150 E(3)=INT(E(3)+SGN(E(3))*0.5)2160 E(4)=INT(E(4)+SGN(E(4))*0.5)2170 GOSUB 80702180 FOR I=1 TO 22190 W5=E(2+I)2200 GOSUB 47002210 GO TO W5 OF 2360,22202220 W6=E(2+I)2230 GOSUB 47802240 W5=E(I)+W62250 GOSUB 47002260 IF W5=2 THEN 52502270 W6=E(2+I)2280 GOSUB 47802290 E(I)=E(I)+W62300 W6=E(2+I)2310 GOSUB 47802320 E(2+I)=E(2+I)-W6*82330 GOSUB 42602340 T(3)=02350 GO TO 21902360 E(10)=42370 IF E(3)-1>1 THEN 24002380 W=12390 GO TO 24102400 W=E(3)-12410 IF E(3)+1<8 THEN 24402420 W1=82430 GO TO 24502440 W1=E(3)+12450 IF E(4)-1>1 THEN 24802460 W2=12470 GO TO 25002480 W2=E(4)-12490 REM2500 IF E(4)+1<8 THEN 25302510 W3=82520 GO TO 25402530 W3=E(4)+12540 FOR I1=W TO W12550 FOR I2=W2 TO W32560 IF S(I1,I2)=3 THEN 25802570 GO TO 25902580 E(10)=12590 NEXT I22600 NEXT I12610 IF E(10)>1 THEN 26302620 GO TO 26402630 E(10)=32640 IF T(4)<>0 THEN 26602650 GO TO 26902660 IF E(10)>1 THEN 26802670 GO TO 26902680 E(10)=22690 NEXT I2700 S(E(3),E(4))=42710 GOSUB 49502720 T(7)=(3*C2)^1.092730 GOSUB 48402740 IF INT(RND(B)*30)<>2 THEN 10302750 PRINT "COSMIC STORM"2760 GO TO INT(RND(B)*3)+1 OF 2770,2800,28302770 PRINT "WARP DRIVES DAMAGED"2780 D=72790 GO TO 28502800 PRINT "LONG RANGE SENSORS DAMAGED"2810 D=82820 GO TO 28502830 PRINT "SHORT RANGE SENSORS DISABLED"2840 D=92850 Y=INT(RND(B)*9)2860 PRINT "FOR ";Y;" YEARS"2870 E(D)=Y2880 GO TO 10302890 REM-------------------------------STATUS-REPORT-------------------2895 IMAGE 22T,38A2900 PAGE2901 PRINT USING 2905:"Use UDKs or type CMD letter"2902 PRINT USING 2903:2903 IMAGE 25T,"SRS LRS PHAS TORP DAMAGE"2904 PRINT "";2905 IMAGE 23T,38A2906 PRINT USING 2905:"  _   _   _    _    _ "2907 PRINT USING 2905:"   1    2    3    4    5"2908 PRINT USING 2905:"   6    7    8    9    10"2909 IMAGE 23T,"MULTI QUAD CMD GALAXY MOVE"2910 PRINT USING 2909:2911 PRINT "";2913 PRINT USING 2905:"      _        _      _"2914 PRINT USING 2905:" TORP SCAN INFO"2915 PRINT "";2916 PRINT USING 2905:"  _        _"2917 PRINT USING 2895:"  x   []     <        M"2918 PRINT "";2919 PRINT USING 2895:"  o          >        W"2920 PRINT USING 2895:"Star Base Klingon Enterprise"2921 WINDOW 0,130,0,1002922 VIEWPORT 0,130,0,1002923 MOVE 38.5,982924 DRAW 86,982925 DRAW 86,83.52926 DRAW 38.5,83.52927 DRAW 38.5,982928 PRINT "STATUS: SECTOR ";E(3);" - ";E(4)2929 PRINT2930 T(3)=12940 IF E(9)=0 THEN 64202950 PRINT " IS UNAVAILABLE, SINCE SHORT RANGE SENSORS"2960 PRINT "ARE DAMAGED FOR";E(9);" MORE YEARS"2970 GO TO 10302980 REM---------------------------------------------------------------2990 PRINT3000 Q$=".*KBE123456782"3010 FOR I=1 TO 83020 I1=13030 REM3040 GO TO I OF 3050,3070,3160,3220,3240,3270,3290,33103050 PRINT "STARDATE     ";T(1)3060 GO TO 33203070 IF E(10)=1 THEN 31303080 IF E(10)=2 THEN 31103090 W$=G$3100 GO TO 31403110 W$=F$3120 GO TO 31403130 W$=E$3140 PRINT "CONDITION    ";W$3150 GO TO 33203160 P$=SEG(Q$,E(1)+5,1)3170 U$=SEG(Q$,E(2)+5,1)3180 V$=SEG(Q$,E(3)+5,1)3190 X$=SEG(Q$,E(4)+5,1)3200 PRINT "QUADRANT     ";P$;" - ";U$3210 GO TO 33203220 PRINT "SECTOR       ";V$;" - ";X$3230 GO TO 33203240 PRINT USING 3250:"ENERGY",E(5)3250 IMAGE    6A,7X,4D.2D3260 GO TO 33203270 PRINT "PH. TORPS    ";E(6)3280 GO TO 33203290 PRINT "KLINGONS     ";T(5)3300 GO TO 33203310 PRINT3320 NEXT I3330 GO TO 12803340 REM------------------------LOCAL-SCAN-&-STATUS--------------------3350 L=9993360 IF E(8)=0 THEN 33903370 PRINT "SENSORS ARE, AND WILL BE DAMAGED FOR ";E(8);" YEARS"3380 GO TO 10303390 GOSUB 71603394 REM Move cursor back to command text location3395 HOME3396 MOVE A3,A43400 GO TO 10303410 REM------------------------FIRE-PHASORS---------------------------3420 IF T(4)<>0 THEN 34503430 PRINT "NO ENEMY KLINGONS IN THE SECTOR"3440 GO TO 10303450 PRINT "PHASORS LOCKED ON TARGET, "3460 REM------------------FIRE-PHASORS---------------------------------3470 PRINT USING 3480:"ENERGY AVAILABLE EQUALS",E(5)3480 IMAGE 23A,2X,4D.2D3490 PRINT "NUMBER OF UNITS TO FIRE?"3500 INPUT P3505 GIN A3,A43510 IF P<0 THEN 34203520 IF E(5)-P<0 THEN 60403530 P2=P/T(4)3540 FOR I=1 TO 83550 FOR I1=1 TO 83560 IF S(I,I1)<>2 THEN 36403562 D=SQR((I-E(3))^2+(I1-E(4))^2)3564 P3=10*P2/D3565 REM MOVE E(4),9-E(3)3566 X4=E(4)3567 Y4=9-E(3)3568 GOSUB 93003569 REM RDRAW I1-E(4),0.2+(E(3)-I)3570 REM MOVE I1,9-I3572 X4=I13574 Y4=9-I3575 GOSUB 93003580 MOVE A3,A43590 PRINT USING 1150:P3," UNIT HIT ON KLINGON AT SECTOR ",I," - ",I13595 GIN A3,A43600 IF P3<300 THEN 36403610 GOSUB 50903620 PRINT "KLINGON AT SECTOR ";I;" - ";I1;" DESTROYED!!"3621 GIN A3,A43622 MOVE I1,9-I3623 PRINT @32,18:53625 PRINT B$;""3626 PRINT @32,18:03627 MOVE A3,A43630 S(I,I1)=03640 NEXT I13650 NEXT I3660 T(7)=P3670 GOSUB 48403680 GO TO 10303690 REM------------------------FIRE-PHOTON-TORPEDO--------------------3700 T(7)=503710 GOSUB 48303720 IF E(6)<>0 THEN 37503730 PRINT "TORPEDOES EXHAUSTED!!"3740 GO TO 10303750 PRINT "TORPEDO COURSE (in Degrees)? ";3760 INPUT T53765 GIN A3,A43770 X1=COS(T5+180)3780 Y1=SIN(T5+180)3790 T1=E(3)3800 T2=E(4)3802 REM  J9 is count of torpedo track from Enterprise location3804 J9=13810 PRINT "TORPEDO TRACK"3820 Z0=03830 T1=T1+X13840 T2=T2-Y13854 T3=INT(T1+SGN(T1)*0.5)3860 T4=INT(T2+SGN(T2)*0.5)3866 GIN A3,A43868 GOSUB 94003870 W5=T33880 GOSUB 47003890 W7=W53900 W5=T43910 GOSUB 47003920 W8=W53930 IF W7=2 THEN 42303940 IF W8=2 THEN 42303950 Z0=Z0+13960 PRINT T3;"-";T4;3970 PRINT ",";3980 GO TO 40003990 PRINT "  ";4000 IF Z0=4 THEN 40204010 GO TO 40304020 PRINT "  ";4030 REM4040 IF Z0=4 THEN 40604050 GO TO 40704060 Z0=04070 GO TO S(T3,T4)+1 OF 3830,4080,4130,4170,38304080 PRINT "** STAR DESTROYED **"4082 GIN A3,A44083 MOVE T4,9-T34084 PRINT @32,18:54086 PRINT B$;""4087 PRINT @32,18:04088 MOVE A3,A44090 Q(E(1),E(2))=Q(E(1),E(2))-14100 E(6)=E(6)-14110 S(T3,T4)=04120 GO TO N5+1 OF 1030,57804130 PRINT "** KLINGON BATTLE CRUISER DESTROYED **  "4134 GIN A3,A44136 MOVE T4,9-T34138 PRINT @32,18:54140 PRINT B$;""4142 PRINT @32,18:04144 MOVE A3,A44148 S(T3,T4)=04150 GOSUB 50904160 GO TO 41004170 PRINT "** STARBASE DESTROYED - CONGRATULATIONS- **    "4174 GIN A3,A44176 MOVE T4,9-T34177 PRINT @32,18:54178 PRINT B$;B$4179 MOVE T4+.2,9-T34180 PRINT B$;""4182 PRINT @32,18:04184 MOVE A3,A44188 E(10)=24190 GO TO 42104200 E(10)=34210 Q(E(1),E(2))=Q(E(1),E(2))-104220 GO TO 41004230 E(6)=E(6)-14240 PRINT "TORPEDO RAN OUT OF QUADRANT"4250 GO TO N5+1 OF 1030,57804260 S=04270 W5=E(3)4280 GOSUB 47004290 W7=W54300 W5=E(4)4310 GOSUB 47004320 W8=W54330 IF W7=2 THEN 43604340 IF W8=2 THEN 43604350 GO TO 43704360 RETURN4370 IF T9=1 THEN 43904380 S(E(3),E(4))=44390 Z9=Q(E(1),E(2))4400 T9=04410 Z8=INT(Z9/100)4420 Z7=INT((Z9-Z8*100)/10)4430 Z6=Z9-Z8*100-Z7*104440 IF Z8=0 THEN 45204450 FOR Z3=1 TO Z84460 Z5=INT(RND(B)*8+1)4470 Z4=INT(RND(B)*8+1)4480 IF S(Z5,Z4)=0 THEN 45004490 GO TO 44604500 S(Z5,Z4)=24510 NEXT Z34520 T(4)=Z84530 IF Z7=0 THEN 46104540 FOR Z3=1 TO Z74550 Z5=INT(RND(B)*8)+14560 Z4=INT(RND(B)*8)+14570 IF S(Z5,Z4)=0 THEN 45904580 GO TO 45504590 S(Z5,Z4)=34600 NEXT Z34610 IF Z6=0 THEN 46904620 FOR Z3=1 TO Z64630 Z5=INT(RND(B)*8+1)4640 Z4=INT(RND(B)*8+1)4650 IF S(Z5,Z4)=0 THEN 46704660 GO TO 46304670 S(Z5,Z4)=14680 NEXT Z34690 RETURN4700 IF W5<=8 THEN 47304710 W5=24720 RETURN4730 IF W5=>1 THEN 47604740 W5=24750 RETURN4760 W5=14770 RETURN4780 IF W6<1 THEN 48104790 W6=14800 RETURN4810 W6=-14820 RETURN4830 REM------------ENERGY-HANDLER----------------4840 E(5)=E(5)-T(7)4850 IF E(5)>0 THEN 48704860 GO TO 48804870 RETURN4880 PRINT "  ALL THE ENERGY IS EXHAUSTED."4890 PRINT "YOU HAVE NOT DESTROYED ALL THE KLINGON "4900 PRINT "BATTLE CRUISERS.  YOU THEREFORE HAVE FAILED."4910 PRINT "REMEMBER, A CAPTAIN GOES DOWN WITH HIS SHIP."4920 PRINT "                         ** STARFLEET **"4930 END4940 REM-----------TIME-HANDLER------------------4950 T(1)=T(1)+14960 IF T(1)<=T(2) THEN 49904970 PRINT "   STARDATE,  TIME IS EXHAUSTED."4980 GO TO 48904990 IF E(7)<>0 THEN 50105000 GO TO 50205010 E(7)=E(7)-15020 IF E(8)<>0 THEN 50405030 GO TO 50505040 E(8)=E(8)-15050 IF E(9)<>0 THEN 50705060 GO TO 50805070 E(9)=E(9)-15080 RETURN5090 IF T(4)<>0 THEN 51105100 GO TO 51205110 T(4)=T(4)-15120 IF T(5)-1=0 THEN 52305130 T(5)=T(5)-15140 Q(E(1),E(2))=Q(E(1),E(2))-1005150 IF T(4)<>0 THEN 51905160 IF E(10)>1 THEN 52105170 GO TO 51805180 GO TO 52205190 IF E(10)>1 THEN 52105200 RETURN5210 E(10)=35220 RETURN5230 GOSUB 76005240 END5250 PRINT "COMPUTER STOPS ENTERPRISE FROM EXITING GALAXY"5260 IF E(I+2)<1 THEN 52805270 GO TO 52905280 E(I+2)=15290 IF E(I+2)>8 THEN 53105300 GO TO 53205310 E(I+2)=85320 GO TO 50805330 IF E(7)=0 THEN 53705340 PRINT "WARP DRIVES WILL BE REPAIRED IN ";E(7);" YEARS"5350 GO TO 53605360 GO TO 53805370 PRINT "WARPDRIVES OPERATIVE"5380 IF E(8)=0 THEN 54205390 PRINT "LONG RANGE SENSORS WILL BE REPAIRED IN ";E(8);" YEARS"5400 GO TO 54305410 RETURN5420 PRINT "LONGRANGE SENSORS OPERATIVE"5430 IF E(9)=0 THEN 54605440 PRINT "SHORT RANGE SENSORS WILL BE REPAIRED IN ";E(9);" YEARS"5450 GO TO 54705460 PRINT "SHORT RANGE SENSORS OPERATIVE"5470 IF T(4)<>0 THEN 10305480 PRINT "DO YOU WANT TO HOLD THE ENTERPRISE UNTIL"5490 PRINT "REPAIRS ARE COMPLETE?";5500 INPUT Q$5510 IF Q$="YES" THEN 55305520 GO TO 10305530 IF E(8)>E(9) THEN 55705540 IF E(9)>E(7) THEN 55905550 D1=E(7)5560 GO TO 56205570 IF E(8)>E(7) THEN 56105580 GO TO 55505590 D1=E(9)5600 GO TO 56205610 D1=E(8)5620 T(1)=T(1)+D1-15630 E(7)=05640 E(8)=05650 E(9)=05660 GOSUB 49605670 PRINT "REPAIRS COMPLETE"5680 GO TO 10305690 REM-----------------------FIRE-MULTIPLE-TORPLIST5725,5855---------5700 T(7)=505710 GOSUB 48305720 PRINT "MULTI-TORPEDO FIRING SEQUENCE"5730 PRINT "NUMBER TO FIRE?";5740 INPUT N5750 FOR N2=1 TO N5760 LET N5=15770 GO TO 37205780 NEXT N25790 N5=05800 GO TO 10305810 REM----------------------SPECIAL-SCAN-----------------------------5820 PRINT "SPECIFIC SCAN?";5830 IF E(8)=0 THEN 58605840 PRINT "IS UNAVAILABLE"5850 GO TO 10305860 INPUT S1,S25870 H(S1,S2)=15880 T(7)=1005890 GOSUB 48305900 W5=S15910 GOSUB 47005920 W7=W55930 W5=S25940 GOSUB 47005950 W8=W55960 IF W7=2 THEN 59905970 GO TO 60105980 REM5990 IF W8=1 THEN 58606000 GO TO 60106010 PRINT "SCAN AT THAT QUADRANT REVEALS ";Q(S1,S2)6020 GO TO 10306030 REM-------------------------EXIT-ON-OVERLOADED-PHASORS------------6040 PAGE6050 PRINT "                 PHASOR BANKS BEING LOADED"6060 PRINT "                 OVERLOADING IN PROCESS"6070 PRINT6080 PRINT "            ESTIMATE 5 SECONDS TO DESTRUCT"6090 PRINT6100 PRINT6110 PRINT6120 PRINT "5......"6130 GOSUB 63106140 PRINT6150 PRINT6160 PRINT "  4......"6170 GOSUB 63106180 PRINT6190 PRINT6200 PRINT "    3......"6210 GOSUB 63106220 PRINT6230 PRINT6240 PRINT "      2......"6250 GOSUB 63106260 PRINT6270 PRINT6280 PRINT "        1......"6290 GOSUB 63106300 GO TO 63406310 FOR I=1 TO 2006320 NEXT I6330 RETURN6340 PAGE6350 INIT6360 FOR I=1 TO 4506370 MOVE 65,506380 ROTATE 133*I6390 RDRAW -100,1006400 NEXT I6410 END6420 REM------------------------Short SCAN----------------------------6430 WINDOW 0,8,0,86440 VIEWPORT 90,130,50,906450 MOVE 1,96460 PRINT "SECTOR SCAN FOR"6470 MOVE 1,8.56480 PRINT "QUADRANT: ";E(1);" - ";E(2)6490 FOR I=0 TO 86500 AXIS 0,0,I,I6510 NEXT I6520 VIEWPORT 86.25,126.25,46.25,86.256530 FOR I=1 TO 86540 FOR I1=1 TO 86550 W1=S(I,I1)6560 MOVE I1,9-I6570 IF W1=0 THEN 66606580 IF W1<>1 THEN 66006590 PRINT "xo"6600 IF W1<>2 THEN 66206610 PRINT "<>"6620 IF W1<>3 THEN 66406630 PRINT "[]"6640 IF W1<>4 THEN 66606650 PRINT "MW"6660 NEXT I16670 NEXT I6680 HOME6690 GO TO 29906700 IF I9>8 THEN 67706710 IF E(1)-1=0 THEN 69606720 E(1)=E(1)-16730 E(3)=86740 I9=86750 T9=16760 RETURN6770 IF E(1)+1=9 THEN 69606780 E(1)=E(1)+16790 E(3)=16800 I9=16810 T9=16820 RETURN6830 IF I8>8 THEN 69006840 IF E(2)-1=0 THEN 69606850 E(2)=E(2)-16860 E(4)=86870 I8=86880 T9=16890 RETURN6900 IF E(2)+1=9 THEN 69606910 E(2)=E(2)+16920 E(4)=16930 I8=16940 T9=16950 RETURN6960 X1=06970 Y1=06980 I8=E(4)6990 I9=E(3)7000 PRINT "COMPUTER STOPS ENTERPRISE FROM LEAVING GALAXY"7010 RETURN7020 V1=E(1)-17030 V2=V1+27040 V3=E(2)-17050 V4=V3+27060 IF V1>0 THEN 70807070 V1=17080 IF V2<9 THEN 71007090 V2=87100 IF V3>0 THEN 71207110 V3=17120 IF V4<9 THEN 71407130 V4=87140 RETURN7150 REM----------DRAW-----LONG-RANGE-SCAN-----------------------------7160 WINDOW 0,3,0,37170 VIEWPORT 90,130,0,407180 MOVE 0,3.57190 PRINT "    LONG RANGE SCAN"7200 MOVE 0,3.257210 PRINT "  FROM QUADRANT: ";E(1);" - ";E(2)7220 MOVE 1+E(4)/8,2-E(3)/87230 RDRAW M1,M27240 FOR I=0 TO 37250 AXIS 0,0,I,I7260 NEXT I7270 GOSUB 70207280 IF V2<>2 THEN 73107290 M=37300 GO TO 73207310 M=47320 FOR I=V1 TO V27330 IF V4<>2 THEN 73607340 L1=27350 GO TO 73707360 L1=17370 FOR I1=V3 TO V47380 L(L1)=Q(I,I1)7390 H(I,I1)=17400 L1=L1+17410 NEXT I17420 M=M-17430 IF L(1)<>999 THEN 74807440 MOVE 1.3,M-0.67450 PRINT USING 7460:L(2)," ",L(3);7460 IMAGE 3D,4A,3D7470 GO TO 75507480 MOVE 0.3,M-0.67490 IF L(3)<>999 THEN 75307500 PRINT USING 7510:L(1)," ",L(2)7510 IMAGE 3D,4A,3D7520 GO TO 75507530 PRINT USING 7540:L(1)," ",L(2)," ",L(3);7540 IMAGE 3D,4A,3D,4A,3D7550 NEXT I7552 WINDOW 0,8,0,87554 VIEWPORT 86.25,126.25,46.25,86.257560 MOVE A3,A47590 RETURN7600 PAGE7610 PRINT ""7620 PAGE7630 INIT7640 B=-17650 PAGE7660 MOVE RND(B)*130,RND(B)*1007670 FOR I=1 TO 507680 DRAW RND(B)*130,RND(B)*1007690 NEXT I7700 PAGE7710 FOR I=1 TO 347720 PRINT "   WOW!!!  YOU WON!!!  HOORAY!!!!  LONG LIVE STARFLEET!!!!"7730 NEXT I7740 HOME7750 RETURN7760 REM----------------------CHART-KNOWN-GALAXY-----------------------7770 PAGE7780 PRINT "                       CHART OF THE KNOWN GALAXY"7790 T(7)=5007800 GOSUB 48307810 WINDOW 0,8,0,87820 VIEWPORT 25,105,10,907830 FOR I=0 TO 87840 AXIS 0,0,I,I7850 NEXT I7860 FOR I=1 TO 87870 FOR I1=1 TO 87880 IF H(I,I1)=0 THEN 79207890 MOVE I1-0.8,8-I+0.47900 PRINT USING 7910:Q(I,I1)7910 IMAGE 3D7920 NEXT I17930 NEXT I7940 MOVE E(2)+E(4)/8-1,8-E(1)+(8-E(3))/87950 RDRAW M1,M27960 FOR I=P6 TO 1 STEP -17970 I6=P5(I)7980 I1=INT(I6/1000)7990 I2=INT((I6-I1*1000)/100)8000 I3=INT((I6-I1*1000-I2*100)/10)8010 I4=INT(I6-I1*1000-I2*100-I3*10)8020 DRAW I2+I4/8-1-0.06,8-I1+(8-I3)/8+0.068030 NEXT I8040 HOME8050 GO TO 12808060 REM-------------------------------------------------8070 P6=P6+18080 P5(P6)=E(1)*1000+E(2)*100+E(3)*10+E(4)8090 RETURN8999 REM  **** add single character command processing9000 INPUT C$9010 IF LEN(C$)=0 THEN 90009020 D$=SEG(C$,1,1)9025 GO TO 91009030 REM    Here are the CMD characters - mapped to UDKs9040 REM "SRS LRS PHAS TORP DAMAGE"9045 REM "_   _   _    _    _     "9050 REM "   1    2    3    4    5"9060 REM "   6    7    8    9    10"9070 REM "MULTI QUAD CMD GALAXY MOVE"9075 REM "      _        _      _"9080 REM " TORP SCAN INFO"9090 REM "  _        _   "9100 IF D$="S" THEN 49110 IF D$="L" THEN 89120 IF D$="P" THEN 129130 IF D$="T" THEN 169140 IF D$="D" THEN 209150 IF D$="O" THEN 249160 IF D$="Q" THEN 289170 IF D$="I" THEN 329180 IF D$="G" THEN 369190 IF D$="M" THEN 409200 PRINT "Invalid command letter"9210 GO TO 90009290 REM ---- Refresh the Phasor temporary Blast -----9300 PRINT @32,18:59302 FOR X=1 to 59305 MOVE X4,Y49310 PRINT @32,24:B$9320 NEXT X9330 PRINT @32,18:09340 RETURN9390 REM ---- Refresh the Torpedo path ----9400 PRINT @32,18:59410 REM --- print at X4,Y4 along torpedo path from Enterprise ---9440 FOR X=5 to 1 STEP -19442 X4=T2+Y1*(0.2*X)9444 Y4=9-(T1-X1*(0.2*X))9446 MOVE X4,Y49460 PRINT @32,24:B$9470 NEXT X9480 PRINT @32,18:09485 MOVE A3,A49486 J9=J9+19490 RETURN
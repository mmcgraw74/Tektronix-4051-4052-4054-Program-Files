1 INIT 2 SET KEY 3 GO TO 1004 U=16 RETURN 8 U=110 RETURN 12 U=114 RETURN 16 U=118 RETURN 20 U=122 RETURN 24 U=226 RETURN 28 U=230 RETURN 32 U=234 RETURN 36 U=238 RETURN 40 U=342 RETURN 100 DIM T(13,4),A$(2),R(6,7),E(6),F(5),B$(10),Z$(3),K(6),N(6),L(6,2)105 DIM A(5),I8(5)108 I8=0110 PAGE 115 PRINT "DO YOU WANT INSTRUCTIONS?";120 INPUT Z$125 IF Z$="YES" or Z$="Y" THEN 2215130 REM134 B=RND(-1)135 B=1140 E=100145 A=0150 C=0155 S=0160 U=0165 K=30170 F=0175 R=0180 T=0185 H=11190 W=8195 G1=0200 J1=0205 J2=0210 GOSUB 310215 GO TO 1665220 GOSUB 815225 GOSUB 1705230 GOSUB 375232 GOSUB 2565235 GOSUB 1315240 GOSUB 910245 GOSUB 1630250 GOSUB 1045255 GOSUB 2510260 GOSUB 1770265 REM270 MOVE 10,15275 GO TO 1855280 REM DEAL A CARD285 C=INT(RND(B)*13)+1290 S=INT(RND(B)*4)+1295 IF T(C,S)<>0 THEN 280300 T(C,S)=1305 RETURN 310 REM WHO IS PLAYING?315 PAGE 320 PRINT "HOW MANY PLAYING?";325 INPUT X330 IF X>5 THEN 345335 IF X<1 THEN 355340 GO TO 365345 PRINT "MAXIMUM 5!"350 GO TO 320355 PRINT "MINIMUM 1!"360 GO TO 320365 D=131/X370 RETURN 375 REM SET UP HANDS OF 2380 FOR I1=1 TO 2385 FOR I=1 TO X+1390 GOSUB 280395 GO TO 430400 GOSUB 510405 GOSUB 1600410 R(I,I1)=V415 NEXT I420 NEXT I1425 RETURN 430 REM DEALERS FIRST CARD435 IF I<>X+1 THEN 400440 IF I1<>1 THEN 400445 GOSUB 470450 GOSUB 650455 LET J1=C460 LET J2=S465 GO TO 405470 REM FIND LOCATION475 IF I=X+1 THEN 495480 Z=(I-1)*D+D/3*2485 Y=78-(I1-1)*H490 RETURN 495 Z=15+(I1-1)*W500 Y=92505 RETURN 510 REM PRINT CARD515 GOSUB 470520 GOSUB 650525 GOSUB 670530 PRINT "
 ";A$535 IF S=1 THEN 580540 IF S=2 THEN 615545 IF S=3 THEN 630550 PRINT @32,21:Z+3.5,Y-3555 PRINT @32,20:Z+2,Y-5.3,Z+2.4,Y-6.2,Z+3,Y-6,Z+2.6,Y-7,Z+4.4,Y-7560 PRINT @32,20:Z+4,Y-6,Z+4.6,Y-6.2,Z+5,Y-5.3,Z+3.5,Y-3565 MOVE Z+W,Y-H+1570 PRINT "";A$;""575 RETURN 580 PRINT @32,21:Z+3,Y-3585 PRINT @32,20:Z+2.6,Y-3.6,Z+3,Y-4.6,Z+2,Y-4,Z+1.6,Y-4.3,Z+1.6,Y-5.9590 PRINT @32,20:Z+2,Y-6.2,Z+3,Y-5.6,Z+2.6,Y-7,Z+4.4,Y-7,Z+4,Y-5.6595 PRINT @32,20:Z+5,Y-6.2600 PRINT @32,20:Z+5.4,Y-5.9,Z+5.4,Y-4.3,Z+5,Y-4,Z+4,Y-4.6,Z+4.4,Y-3.6605 PRINT @32,20:Z+4,Y-3,Z+3,Y-3610 GO TO 565615 PRINT @32,21:Z+3.5,Y-7620 PRINT @32,20:Z+2,Y-5,Z+3.5,Y-3,Z+5,Y-5,Z+3.5,Y-7625 GO TO 565630 PRINT @32,21:Z+2.5,Y-3635 PRINT @32,20:Z+1.6,Y-4,Z+3.5,Y-7,Z+5.4,Y-4,Z+4.5,Y-3,Z+3.5,Y-3.4640 PRINT @32,20:Z+2.5,Y-3645 GO TO 565650 REM PRINT BOX655 PRINT @32,21:Z,Y660 PRINT @32,20:Z,Y-10.5,Z+7,Y-10.5,Z+7,Y,Z,Y665 RETURN 670 REM ALPHA CHARACTER675 GO TO C OF 685,695,705,715,725,735,745,755,765,775,785,795,805680 RETURN 685 A$="A"690 RETURN 695 A$="2"700 RETURN 705 A$="3"710 RETURN 715 A$="4"720 RETURN 725 A$="5"730 RETURN 735 A$="6"740 RETURN 745 A$="7"750 RETURN 755 A$="8"760 RETURN 765 A$="9"770 RETURN 775 A$="10"780 RETURN 785 A$="J"790 RETURN 795 A$="Q"800 RETURN 805 A$="K"810 RETURN 815 REM SET UP TABLE820 PAGE 822 MOVE 51,100823 PRINT "*** BLACKJACK ***"825 MOVE 0,0830 AXIS 835 MOVE 130,99.5840 AXIS 0,0,130,99.5845 MOVE 0,80850 RDRAW 130,0855 FOR I=1 TO X-1860 MOVE D*I,80865 RDRAW 0,-80870 NEXT I875 MOVE 0,100880 PRINT " DEALER"885 FOR I=1 TO X890 MOVE D*(I-1),80895 PRINT "
 PLAYER ";I900 NEXT I905 RETURN 910 REM HIT911 I8=0912 U=0915 FOR I=1 TO X920 IF R(I,1)=22 THEN 1035925 I1=2930 FOR I2=1 TO 5935 MOVE D*(I-1),75940 PRINT "



 H I T ?"945 IF U=1 THEN 965950 IF U=2 THEN 1030955 IF U=3 THEN 2395960 GO TO 935965 GOSUB 280970 U=0975 I1=I1+1980 GOSUB 1600985 R(I,I1)=V990 N(I)=N(I)+V995 GOSUB 15101000 GOSUB 5101005 IF N(I)<=21 THEN 10251010 MOVE D*(I-1),201015 PRINT " YOU BUSTED"1020 GO TO 10351025 NEXT I21030 U=01035 NEXT I1040 RETURN 1045 REM DEALER'S HIT1050 I1=21054 GOSUB 15101055 N(I)=01060 FOR K2=1 TO 71065 N(I)=R(I,K2)+N(I)1070 NEXT K21075 IF N(I)>21 THEN 11101080 IF N(I)>16 THEN 11251085 GOSUB 11401090 GOSUB 16001095 R(I,I1)=V1100 GOSUB 15101105 GO TO 10551110 MOVE 60,961115 PRINT " DEALER BUSTS"1120 RETURN 1125 MOVE 60,961130 PRINT " DEALER'S TOTAL: ";N(I)1135 RETURN 1140 REM DEALERS NEW CARD1145 GOSUB 2801150 I=X+11155 I1=I1+11160 GOSUB 5101165 RETURN 1170 REM CALCULATE PLAYERS TOTAL1175 FOR I=1 TO X1180 GOSUB 15101185 N(I)=01190 FOR I1=1 TO 71195 N(I)=R(I,I1)+N(I)1200 IF R(I,1)=22 THEN 12751205 IF N(I)>21 THEN 12951210 NEXT I11215 MOVE D*(I-1),201220 PRINT N(I);1225 IF N(X+1)>21 THEN 12401230 IF N(I)<N(X+1) THEN 12601235 IF N(I)=N(X+1) THEN 12501240 PRINT "  WINS!!"1245 GO TO 12651250 PRINT "  PUSH"1255 GO TO 12651260 PRINT "  LOSES"1265 NEXT I1270 RETURN 1275 MOVE D*(I-1),201280 PRINT " BLACKJACK!!!"1285 NEXT I1290 RETURN 1295 MOVE D*(I-1),201300 PRINT " YOU BUSTED"1305 NEXT I1310 RETURN 1315 REM TEST BLACKJACK1320 FOR I=1 TO X+11325 N(I)=01330 FOR I1=1 TO 21335 N(I)=R(I,I1)+N(I)1340 NEXT I11345 IF N(I)=11 THEN 13601350 NEXT I1355 GO TO 14751360 FOR K4=1 TO 21365 IF R(I,K4)=1 THEN 13801370 NEXT K41375 GO TO 13501380 IF I=X+1 THEN 14051385 MOVE D*(I-1),201390 PRINT " BLACKJACK"1395 R(I,1)=221400 GO TO 13501405 GOSUB 16301410 MOVE 60,961415 PRINT " DEALER HAS A BLACKJACK"1420 FOR I=1 TO X1425 IF R(I,1)=22 THEN 14551430 IF I8(I)=1 THEN 26451435 MOVE D*(I-1),201440 PRINT " LOSES"1445 NEXT I1450 GO TO 2701455 MOVE D*(I-1),201460 PRINT " BLACKJACK PUSHES"1465 E(I)=E(I)+F(I)1470 GO TO 14451475 REM PLAYERS BLACKJACK1480 FOR I=1 TO X1485 IF R(I,1)=22 THEN 15001490 NEXT I1495 RETURN 1500 E(I)=E(I)+2.5*F(I)1505 GO TO 14901510 REM VALUE OF ACE1515 FOR K2=1 TO 71520 IF R(I,K2)=1 THEN 15501525 IF R(I,K2)<>11 THEN 15401530 R(I,K2)=11535 GO TO 15151540 NEXT K21545 RETURN 1550 N(I)=01555 FOR I3=1 TO 71560 N(I)=R(I,I3)+N(I)1565 NEXT I31570 IF N(I)<=11 THEN 15851575 R(I,K2)=11580 RETURN 1585 R(I,K2)=111590 N(I)=N(I)+101595 RETURN 1600 REM VALUE OF CARD1605 IF C>10 THEN 16201610 V=C1615 RETURN 1620 V=101625 RETURN 1630 REM FLIP DEALERS FIRST CARD1635 C=J11640 S=J21645 I=X+11650 I1=11655 GOSUB 5101660 RETURN 1665 REM SET UP BETS1670 G1=01675 FOR I=1 TO X1680 G1=G1+11685 PRINT 1690 PRINT "PLAYER ";G1;" YOU HAVE A BALANCE OF ";E(G1)1695 K(G1)=E(G1)1700 GO TO 19901705 REM PRINT BET/BALANCE1710 FOR I=1 TO X1715 MOVE D*(I-1),601720 PRINT "
 BET:"1725 MOVE D*(I-1),601730 PRINT "

 ";F(I);"$"1735 MOVE D*(I-1),601740 E(I)=E(I)-F(I)1745 PRINT "


 BALANCE:"1750 MOVE D*(I-1),601755 PRINT "



 ";E(I);"$"1760 NEXT I1765 RETURN 1770 REM UPDATE BALANCE1775 GOSUB 11701780 FOR I=1 TO X1785 IF N(I)>21 THEN 18301790 IF N(X+1)>21 THEN 18451795 IF N(I)=>N(X+1) THEN 18401800 NEXT I1805 RETURN 1810 F(I)=2.5*F(I)1815 E(I)=E(I)+F(I)1820 RETURN 1825 E(I)=E(I)+F(I)1830 NEXT I1835 RETURN 1840 IF N(I)=N(X+1) THEN 18251845 E(I)=E(I)+2*F(I)1850 GO TO 18301855 REM ANOTHER GAME1860 GOSUB 22701865 PRINT "DOES EVERY BODY WANT TO PLAY AGAIN?";1870 INPUT Z$1871 WINDOW 0,130,0,1001872 VIEWPORT 0,130,0,1001875 IF Z$="NO" or Z$="N" THEN 18901880 PAGE 1885 GO TO 16651890 PRINT "HOW MANY DONT WANT TO PLAY?"1895 INPUT G1900 IF G=X THEN 20701905 G1=01910 X=X-G1915 D=131/X1920 FOR I=1 TO X+G1925 PRINT "DOES PLAYER ";I;" WANT TO PLAY AGAIN?"1930 INPUT Z$1935 IF Z$="NO" or Z$="N" THEN 19451940 GO TO 19601945 NEXT I1950 GOSUB 16651955 GO TO 20701960 G1=G1+11965 PRINT "PLAYER ";I;" YOU ARE NOW PLAYER ";G11970 K(G1)=E(I)1975 PRINT " AND YOU HAVE A BALANCE OF ";K(G1)1980 NEXT I1985 GOSUB 16651990 PRINT "HOW MUCH DO YOU WANT TO BET?"1995 INPUT F(G1)2000 IF F(G1)=0 THEN 20202005 IF F(G1)>K(G1) THEN 20302010 NEXT I2015 GO TO 20402020 PRINT "TO BET NOTHING IS NOT TO PLAY!"2025 GO TO 19902030 PRINT "SORRY NO CREDIT.  PLEASE BET AGAIN."2035 GO TO 19902040 FOR I=1 TO X2045 E(I)=K(I)2050 NEXT I2055 R=02060 T=02065 GO TO 2202070 REM RESULTING BALANCE2075 M1=100002080 M2=02085 PAGE 2090 PRINT "                        RESULTING BALANCE"2095 FOR J3=1 TO X2100 M1=M1 MIN E(J3)2105 M1=M1 MAX 102110 M2=M2 MAX E(J3)2115 NEXT J32120 WINDOW 0,X,M1-10,M2+52125 VIEWPORT 10,130,10,1002130 AXIS 1,1,0,M1-102135 FOR I=1 TO X2140 FOR I1=M1-10 TO E(I) STEP 0.52145 MOVE I-0.75,I12150 RDRAW 0.5,02155 NEXT I12160 NEXT I2165 FOR I=INT(M1/5)*5-5 TO M2+5 STEP 52170 MOVE 0,I2175 PRINT "";I2180 NEXT I2185 FOR I=1 TO X2190 PRINT @32,21:120/X*(I-0.5)+5,52195 PRINT I2200 NEXT I2205 WINDOW 0,130,0,1002206 HOME 2210 END 2215 REM INSTRUCTIONS2220 PRINT "TOP ROW USER DEFINABLE KEYS GIVES A NEW CARD"2225 PRINT "BOTTOM ROW EXCEPT THE LAST KEY PASSES YOU AND GOES TO";2230 PRINT " THE NEXT PLAYER"2235 PRINT "THE LAST KEY ON THE BOTTOM ROW DOUBLES DOWN.  IF THIS";2240 PRINT " OPERATION GIVES"2245 PRINT "YOU A BET OVER YOUR BALANCE IT WILL NOT ACCEPT IT AND YOU";2250 PRINT " MUST DO ONE   OF YOUR OTHER OPTIONS."2255 INPUT Q$2260 GO TO 1302265 END 2266 REMARK R U BROKE?2267 PAGE 2270 FOR I=1 TO X2275 IF E(I)<=0 THEN 22902280 NEXT I2285 RETURN 2290 FOR I1=I+1 TO X2295 IF X=1 THEN 23552300 E(I1-1)=E(I1)2305 NEXT I12310 PRINT " PLAYER ";I;" IS BROKE.  SORRY, YOU'RE OUT."2315 FOR I=I TO X-12320 IF I=X THEN 23352325 PRINT " PLAYER ";I+1;" YOU ARE NOW PLAYER ";I2330 NEXT I2335 X=X-12340 D=131/X2345 GO TO 22702350 RETURN 2355 PAGE 2360 PRINT "NEW GAME ANYONE?  I'M A SUCKER FOR A BET!!!"2365 INPUT Z$2370 IF Z$="NO" or Z$="N" THEN 23802375 GO TO 1302380 PRINT "  WELL YOU GUYS IT SURE HAS BEEN NICE!!!!!"2385 PRINT "MAYBE LATER?"2390 END 2395 REM DOUBLE DOWN2396 IF F(I)>E(I) THEN 24052400 IF R(I,3)=0 THEN 24252405 MOVE D*(I-1),102410 PRINT " YOU CAN'T DO THAT"2415 U=02420 GO TO 9352425 E(I)=E(I)-F(I)2430 F(I)=2*F(I)2435 IF F(I)>E(I)+F(I) THEN 9352440 MOVE D*(I-1),602445 PRINT "
 
XXTTOOMM   ";F(I);"$"2450 MOVE D*(I-1),602455 PRINT "
 


XXTTOOMM   ";E(I);"$"2460 I1=32465 GOSUB 4702470 GOSUB 6502475 GOSUB 2802480 L(I,1)=C2485 L(I,2)=S2490 A(I)=12495 U=02500 NEXT I2505 RETURN 2510 FOR I=1 TO X2515 IF A(I)<>1 THEN 25552520 A(I)=02525 C=L(I,1)2530 S=L(I,2)2535 I1=32540 GOSUB 5102545 GOSUB 16002550 R(I,I1)=V2555 NEXT I2560 RETURN 2565 REM INSURANCE?2570 I=X+12575 IF R(I,2)=1 THEN 25902580 IF R(I,2)=11 THEN 25902585 RETURN 2590 FOR I=1 TO X2595 MOVE D*(I-1),302600 PRINT " INSURANCE?"2605 IF U=1 THEN 26202610 IF U=2 THEN 26752615 GO TO 25952620 U=02625 I8(I)=12630 E(I)=E(I)-F(I)/22635 NEXT I2640 RETURN 2645 I8(I)=02650 MOVE D*(I-1),202655 PRINT " INSURED"2660 E(I)=E(I)+1.5*F(I)2661 IF R(I,1)=22 THEN 26632662 GO TO 26652663 E(I)=E(I)+F(I)2665 NEXT I2670 GO TO 2702675 U=02680 NEXT I2685 RETURN 
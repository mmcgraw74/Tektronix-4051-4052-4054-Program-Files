1 REM FILE 25  THREE-D PERSPECTIVE TRANSFORMATION2 GO TO 1004 REM REDISPLAY THE LAST PLOT6 T=327 GO TO 16708 REM REDESPLAY THE LAST PLOT WITHOUT PAGE9 T=3210 GO TO 169012 V7=9013 GO TO 120016 V7=18017 GO TO 120020 V7=36021 GO TO 120024 GO TO 120028 REM DISPLAY CURRENT EYE VIEW AND ALLOW NEW VALUES29 PRINT "X=";E(1);" Y=";E(2);" Z=";E(3)30 INPUT E(1),E(2),E(3)31 GO TO 120032 PAGE 33 GO TO 171036 C1=NOT(C1)37 END 40 GO TO 100100 INIT 110 T=32120 PRINT @T:""130 DIM E(3),L(3),P(3),Q(2,3)140 RESTORE 150 SET DEGREES 160 REM *****************170 REM  FILL 3D DATA ARRAY180 C1=1190 L0=1200 L1=10210 L2=1220 C=10230 L3=-C240 L4=C250 L5=1260 V7=360270 DIM W8(50,2)280 VIEWPORT 10,130,10,100290 WINDOW 0,10,-5,5300 DASH 170310 FOR I=-5 TO 5 STEP 0.5320 MOVE I+5,-5330 DRAW I+5,5-(I>1)*2340 MOVE 0,I350 DRAW 10-(I>3)*4,I360 NEXT I370 DASH 0380 AXIS 1,1,0,-5390 CHARSIZE 1400 FOR I=-5 TO 5410 MOVE 0,I420 INPUT @32,24:X,Y430 PRINT @32,21:X-4,Y-0.5440 PRINT USING "3DS":I450 MOVE I+5,-5460 INPUT @32,24:X,Y470 I$=STR(I+5)480 I$=REP("",1,1)490 PRINT @32,21:X-LEN(I$)*0.5,Y-3500 PRINT USING "3AS":I$510 NEXT I520 X=85530 Y=95540 PRINT @32,21:X,Y550 PRINT "PLEASE ENTER PROFILE POINTS ON";560 Y=Y-2570 PRINT @32,21:X,Y580 PRINT "GRID BY FINDING POINT AND PRESSING";590 Y=Y-2600 PRINT @32,21:X,Y610 PRINT "ANY KEY..FOR LAST POINT, PRESS";620 Y=Y-2630 PRINT @32,21:X,Y640 PRINT "THE ""L"" KEY.";650 Y=Y-5660 CHARSIZE 2670 PRINT @32,21:X,Y680 PRINT "NOTE: LEFT EDGE IS CENTER LINE";690 CHARSIZE 3700 A$="CENTER LINE"710 FOR I=1 TO LEN(A$)720 B$=SEG(A$,I,1)730 PRINT @32,21:5,Y740 PRINT B$;750 Y=Y-5760 NEXT I770 CHARSIZE 4780 PRINT @32,21:45,4790 PRINT "R  A  D  I  U  S";800 CHARSIZE 1810 I=1820 POINTER W8(I,1),W8(I,2),V$830 GIN W8(I,2),W8(I,1)840 IF I=1 THEN 870850 MOVE X,Y860 DRAW W8(I,2),W8(I,1)870 GIN X,Y880 IF V$="L" THEN 910890 I=I+1900 GO TO 820910 L1=I920 N8=INT((L1-L0)/L2)+1930 N9=INT((L4-L3)/L5)+1940 DIM O(N8,N9),O1(N8,N9),W8(L1,2)950 O=0960 O1=0970 DEF FNX(X)=COS((J+45)*V7/(N9-1))*W8(I,2)980 DEF FNZ(X)=W8(I,1)990 DEF FNY(X)=SIN((J+45)*V7/(N9-1))*W8(I,2)1000 REM  FIND MIN AND MAX OF 3D DATA1010 RESTORE 10301020 Q=-1.0E+3001030 DATA 1.0E+300,1.0E+300,1.0E+3001040 READ Q(1,1),Q(1,2),Q(1,3)1050 FOR I=L0 TO L1 STEP L21060 FOR J=L3 TO L4 STEP L51070 Q(1,3)=Q(1,3) MIN FNZ(J)1080 Q(2,3)=Q(2,3) MAX FNZ(J)1090 Q(1,1)=Q(1,1) MIN FNX(I)1100 Q(2,1)=Q(2,1) MAX FNX(I)1110 Q(1,2)=Q(1,2) MIN FNX(J)1120 Q(2,2)=Q(2,2) MAX FNX(J)1130 NEXT J1140 NEXT I1150 REM *****************1160 REM  SPECIFY 3D PARAMETERS - EYE POSITION & POINT TO BE LOOKED AT1170 RESTORE 11801180 DATA 500,500,5001190 READ E(1),E(2),E(3)1200 L(1)=(Q(2,1)-Q(1,1))/2+Q(1,1)1210 L(2)=(Q(2,2)-Q(1,2))/2+Q(1,2)1220 L(3)=(Q(2,3)-Q(1,3))/2+Q(1,3)1230 REM  INITIALIZE 3D  ROUTINE1240 GOSUB 21901250 REM *****************1260 REM  FIND MIN AND MAX IN VIEWPLANE'S COORDINATE SYSTEM1270 RESTORE 12801280 DATA 1.0E+300,-1.0E+300,1.0E+300,-1.0E+3001290 READ X1,X2,Y1,Y21300 FOR I=1 TO 21310 FOR J=1 TO 21320 FOR K=1 TO 21330 P(1)=Q(I,1)1340 P(2)=Q(J,2)1350 P(3)=Q(K,3)1360 GOSUB 27601370 X1=X1 MIN X1380 X2=X2 MAX X1390 Y1=Y1 MIN Y1400 Y2=Y2 MAX Y1410 NEXT K1420 NEXT J1430 NEXT I1440 REM SET UP VIEWPORT AND 2D WINDOW1450 VIEWPORT 10.4,119.6,14,981460 IF (X2-X1)/(Y2-Y1)>1.3 THEN 14901470 WINDOW (X2+X1)*0.5-0.65*(Y2-Y1),(X2+X1)*0.5+0.65*(Y2-Y1),Y1,Y21480 GO TO 15101490 WINDOW X1,X2,(Y2+Y1)*0.5-(X2-X1)/2.6,(Y2+Y1)*0.5+(X2-X1)/2.61500 REM ********************1510 REM  MOVE TO FIRST POINT1520 PAGE 1530 V5=11540 V4=11550 FOR J=L3 TO L4 STEP L51560 FOR I=L0 TO L1 STEP L21570 P(1)=FNX(I)1580 P(2)=FNY(J)1590 P(3)=FNZ(J)1600 GOSUB 27601610 IF I<>L0 THEN 16301620 MOVE X,Y1630 DRAW X,Y1640 GOSUB 39501650 NEXT I1660 NEXT J1670 REM  MOVE TO FIRST POINT1680 PAGE 1690 REM1700 GOSUB 30701710 DASH 01720 FOR I=1 TO N81730 MOVE @T:O(I,1),O1(I,1)1740 FOR J=1 TO N91750 DRAW @T:O(I,J),O1(I,J)1760 NEXT J1770 NEXT I1780 FOR J=1 TO N91790 MOVE @T:O(1,J),O1(1,J)1800 FOR I=1 TO N81810 DRAW @T:O(I,J),O1(I,J)1820 NEXT I1830 NEXT J1840 CHARSIZE 21850 PRINT @T,21:97,81860 PRINT @T:"VIEWED FROM X=";E(1);",Y=";E(2);",Z=";E(3);1870 PRINT @T,21:97,41880 PRINT @T:"WITH A ";1890 CHARSIZE 31900 INPUT @T,24:X,Y1910 FOR I=0 TO 0.2 STEP 0.11920 PRINT @T,21:X+I,Y+I1930 PRINT @T:"TEKTRONIX 4O54";1940 NEXT I1950 CHARSIZE 11960 PRINT @T,21:5,121970 PRINT @T:"USER DEFINABLE KEYS"1980 PRINT @T,21:0,121990 PRINT @T,20:0,13.5,130,13.5,130,0,90,02000 PRINT @T,21:0,122010 PRINT @T,20:90,12,90,0,0,0,0,12,0,6,90,62020 FOR I=18 TO 90 STEP 182030 PRINT @T,21:I,02040 PRINT @T,20:I,122050 NEXT I2060 PRINT @T,21:0,92070 PRINT @T,18:52080 PRINT @T:" 1} REDRAW WITH    2}REDRAW WITHOUT  3}  COMPUTE 90 ";2090 PRINT @T:"   4}  COMPUTE 180    5}  COMPUTE 360"2100 PRINT @T:"    NEW PAGE          NEW PAGE           DEGREE VIEW  ";2110 PRINT @T:"     DEGREE VIEW        DEGREE VIEW

"2120 PRINT @T:" 6} RE-COMPUTE     7}  RE-COMPUTE    8} REDRAW WITH- ";2130 PRINT @T:"  9} TIC SWITCH     10}       "2140 PRINT @T:"   PREVIOUS VIEW        NEW VIEW         OUT GRIDS   ";2150 PRINT @T:"      (TOGGLE)            RESTART";2160 PRINT @T,18:02170 HOME 2180 END 2190 REM  3D TO 2D PERSPECTIVE INITIALIZATION2200 REM  MUST BE RUN BEFORE USING TRANSFORM ROUTINE AT 50002210 REM    PURPOSE:  1. FIND LOCATION AND ORIENTATION OF VIEWPLANE2220 REM              2. DEFINE 2D COORDINATE SYSTEM ON VIEWPLANE2230 REM  E  IS VIEWER'S EYE LOCATION IN 3 SPACE2240 REM  L  IS 3 SPACE POINT BEING LOOKED AT BY VIEWER'S EYE2250 DELETE T1,T2,T3,T4,T52260 DIM T1(3),T2(3),T3(3),T4(3),T5(3)2270 IF E(1)<>L(1) OR E(2)<>L(2) THEN 23102280 PRINT "E AND L LIE IN SAME VERTICAL LINE "2290 PRINT "PLEASE CHANGE ONE OF THE FOLLOWING:  E(1),E(2),L(1) OR L(2)"2300 END 2310 REM2320 T3=E-L2330 REM  T3 IS NOW VECTOR FROM L TO E2340 T7=02350 FOR T9=1 TO 32360 T7=T7+T3(T9)^22370 NEXT T92380 T7=SQR(T7)2390 REM  T7 IS NOW DISTANCE FROM L TO E2400 T2=T3/T72410 REM  T2 CONTAINS DIRECTION COSINES OF NORMAL VECTOR TO VIEWPLANE2420 REM2430 REM  PLACE VIEWPLANE HALF WAY BETWEEN E AND L2440 T6=T7/22450 REM  T6 IS DISTANCE FROM E TO VIEWPLANE2460 T3=T3*(T6/T7)2470 T1=E-T32480 REM  T1 IS THE INTERSECTION OF VIEWPLANE AND LINE FROM E TO L2490 REM  DEFINE T1 TO BE ORIGIN OF VIEWPLANE'S 2D COORDINATE SYSTEM2500 REM2510 REM  NOW DEFINE "UP" IN VIEWPLANE'S 2D COORDINATE SYSTEM2520 T3=L2530 T3(3)=T3(3)+12540 REM  T3 IS NOW ENDPOINT OF THE VECTOR (0,0,1) RELATIVE TO L2550 REM  PROJECT ONTO VIEW PLANE2560 GOSUB 29302570 REM T3 IS NOW 3 SPACE POINT DEFINED TO BE "ABOVE" PLANE'S ORIGIN2580 REM2590 T7=02600 FOR T9=1 TO 32610 T7=T7+(T3(T9)-T1(T9))^22620 NEXT T92630 T7=SQR(T7)2640 REM  T7 IS NOW DISTANCE FROM T1 TO T32650 REM2660 T3=T3-T12670 T5=T3/T72680 REM  T5 NOW CONTAINS DIRECTION COSINES OF VIEWPLANE'S "VERTICAL"2690 REM  CROSS PRODUCT WITH VIEWPLANE'S NORMAL VECTOR IS "HORIZONTAL"2700 T4(1)=T5(2)*T2(3)-T5(3)*T2(2)2710 T4(2)=T5(3)*T2(1)-T5(1)*T2(3)2720 T4(3)=T5(1)*T2(2)-T5(2)*T2(1)2730 REM  T4 CONTAINS DIRECTION COSINES OF VIEWPLANE'S "HORIZONTAL"2740 RETURN 2750 REM2760 REM  ENTRY POINT FOR 3D TO 2D TRANSFORM2770 REM  P CONTAINS 3 SPACE COORDINATES OF POINT2780 REM  TO BE TRANSFORMED TO 2D COORDINATES OF VIEWPLANE2790 T3=P2800 REM  PROJECT INPUT POINT ONTO VIEWPLANE2810 GOSUB 29302820 REM2830 REM  COMPUTE 2D COORDINATES OF PROJECTED POINT2840 X=02850 Y=02860 FOR T9=1 TO 32870 X=X+(T3(T9)-T1(T9))*T4(T9)2880 Y=Y+(T3(T9)-T1(T9))*T5(T9)2890 NEXT T92900 RETURN 2910 REM  INTERNAL ROUTINE:  FIND 3 SPACE POINT WHERE LINE FROM2920 REM     T3 TO E INTERSECTS VIEWPLANE2930 T7=02940 T8=02950 FOR T9=1 TO 32960 T7=T7+(T1(T9)-T3(T9))*T2(T9)2970 T8=T8+(E(T9)-T3(T9))*T2(T9)2980 NEXT T92990 IF T8>0 THEN 30203000 PRINT "E IS TOO CLOSE TO POINT BEING VIEWED"3010 END 3020 T7=T7/T83030 FOR T9=1 TO 33040 T3(T9)=(E(T9)-T3(T9))*T7+T3(T9)3050 NEXT T93060 RETURN 3070 REM AXIS DRA ROUTINE3080 DASH 173090 P(1)=Q(1,1)3100 P(2)=Q(1,2)3110 P(3)=Q(1,3)3120 GOSUB 27603130 MOVE @T:X,Y3140 P(1)=Q(2,1)3150 GOSUB 27603160 DRAW @T:X,Y3170 PRINT @T:"X";3180 P(1)=Q(1,1)3190 GOSUB 27603200 MOVE @T:X,Y3210 P(2)=Q(2,2)3220 GOSUB 27603230 DRAW @T:X,Y3240 PRINT @T:"Y";3250 P(2)=Q(1,2)3260 GOSUB 27603270 MOVE @T:X,Y3280 P(3)=Q(2,3)3290 GOSUB 27603300 DRAW @T:X,Y3310 PRINT @T:"Z";3320 MOVE @T:X,Y3330 P(2)=Q(2,2)3340 GOSUB 27603350 DRAW @T:X,Y3360 P(3)=Q(1,3)3370 GOSUB 27603380 DRAW @T:X,Y3390 P(1)=Q(2,1)3400 GOSUB 27603410 DRAW @T:X,Y3420 P(2)=Q(1,2)3430 GOSUB 27603440 DRAW @T:X,Y3450 P(3)=Q(2,3)3460 GOSUB 27603470 DRAW @T:X,Y3480 P(1)=Q(1,1)3490 GOSUB 27603500 DRAW @T:X,Y3510 IF C1 THEN 39403520 FOR I=INT(ABS(Q(1,1)))*SGN(Q(1,1)) TO Q(2,1)3530 DASH 853540 P(1)=I3550 P(2)=Q(1,2)3560 P(3)=Q(2,3)3570 GOSUB 27603580 MOVE @T:X,Y3590 P(3)=Q(1,3)3600 GOSUB 27603610 DRAW @T:X,Y3620 P(2)=Q(2,2)3630 GOSUB 27603640 DRAW @T:X,Y3650 NEXT I3660 FOR I=INT(ABS(Q(1,2)))*SGN(Q(1,2)) TO Q(2,2)3670 DASH 853680 P(1)=Q(1,1)3690 P(2)=I3700 P(3)=Q(2,3)3710 GOSUB 27603720 MOVE @T:X,Y3730 P(3)=Q(1,3)3740 GOSUB 27603750 DRAW @T:X,Y3760 P(1)=Q(2,1)3770 GOSUB 27603780 DRAW @T:X,Y3790 NEXT I3800 FOR I=INT(ABS(Q(1,3)))*SGN(Q(1,3)) TO Q(2,3)3810 DASH 853820 P(1)=Q(2,1)3830 P(2)=Q(1,2)3840 P(3)=I3850 GOSUB 27603860 MOVE @T:X,Y3870 P(1)=Q(1,1)3880 GOSUB 27603890 DRAW @T:X,Y3900 P(2)=Q(2,2)3910 GOSUB 27603920 DRAW @T:X,Y3930 NEXT I3940 RETURN 3950 O(V4,V5)=X3960 O1(V4,V5)=Y3970 V4=V4*(V4<N8)+13980 V5=V5+(V4=1)3990 RETURN 64554 CALL "BSAVE"64560 OLD "DISCTOTAPE.CONT"
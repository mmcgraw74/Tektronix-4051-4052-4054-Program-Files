100 REM Battlestar Galactica Cylon Attack Game - Sept 2023 mcm110 CHARSIZE 0120 REM    B$ = Cylon blast explosion R12130 REM    C()= Multiple(in future) Cylon location array140 REM    D()= Cylon option 30 data D(3,140)150 REM    E()= Cylon option 30 data E(3,140) for SETPOINT animation160 REM    G$ = LASER RAY SOUND R12170 REM    H$ = Cylon HIT SOUND R12175 REM    T$ = Targeting circles R12180 REM    I0 = Cylon X POSITION190 REM    I1 = Cylon Y POSITION200 REM    I2 = Cylon X VELOCITY210 REM    I3 = Cylon Y VELOCITY220 REM    M9 = number of Cylons missed230 REM    H9 = number of Cylons hit240 REM    N()= numeral series zero digit starting object#250 REM X9/Y9 = INSIDE Cylon polygon arrays260 REM Requires 4054 or 4054A with Option 30 Dynamic Refresh Graphics270 REM and the 4052R11 Character & Symbol ROM - or Jos' MFM ROM Pack280 REM290 REM Add Invader I R12 sounds: G$(laser),B$(blast)300 REM Change from thumbwheels to joystick with CALL "JGIN"310 INIT 320 I=RND(-1)330 PAGE 340 SET DEGREES 350 REM RDRAW Z(array) laser blasts to create Option 30360 DIM Z(3,12),B(3,102),D(3,140),E(3,140),G$(128),H$(512),C(1,2),N(8)370 DIM X7(27),Y7(27),X9(27),Y9(27),T$(666)380 REM Z(array) laser blast data390 DATA 21,20,21,20,21,20,21,20,21,20,21,20400 DATA -22,20,22,-20,-22,20,22,-20,-22,20,22,-20410 DATA -40,40,-40,40,-40.134,40,-40,40,-40.268,40,-40,40420 REM first Cylon ship is #1430 R=1440 H=0450 REM Read B(explosion),G$ & H$ sounds, D(cylon) and T$ from file 20460 READ Z470 FIND @5:7480 READ @5:B,G$,H$,D,T$,X9,Y9490 REM now draw targeting crosshairs as R12 object500 CALL "RDRAW",T$,1,0,0840 REM Create Cylon objects 100 and 101 for smooth animation850 MOVE 65,50860 ROPEN 100870 VISIBILITY 100,0880 FOR I=1 TO 140890 GO TO D(1,I)-19 OF 900,920900 RDRAW D(2,I),D(3,I)910 GO TO 930920 RMOVE D(2,I),D(3,I)930 NEXT I940 RCLOSE 950 MOVE 65,50960 ROPEN 101970 VISIBILITY 101,0980 FOR I=1 TO 140990 GO TO D(1,I)-19 OF 1000,10201000 RDRAW D(2,I),D(3,I)1010 GO TO 10301020 RMOVE D(2,I),D(3,I)1030 NEXT I1040 RCLOSE 1050 REM create laser object #10 and explosion() #41060 MOVE 66,501070 ROPEN 101080 VISIBILITY 10,01090 FOR I=1 TO 121100 GO TO Z(1,I)-19 OF 1110,11301110 RDRAW Z(2,I),Z(3,I)1120 GO TO 11401130 RMOVE Z(2,I),Z(3,I)1140 NEXT I1150 RCLOSE 1160 MOVE 65,501170 ROPEN 41180 VISIBILITY 4,01190 FOR I=1 TO 1021200 GO TO B(1,I)-19 OF 1210,12301210 RDRAW B(2,I),B(3,I)1220 GO TO 12401230 RMOVE B(2,I),B(3,I)1240 NEXT I1250 RCLOSE 1260 REM initialize the score objects1280 REM create 1's H9  10's H9 1's M9  10's M9, 4x6 0,0 is UPPER LEFT1290 REM object 200-209 210-219 301-309 310-319, #vecs,21 or 20,x,y1295 REM object 400-409 410-419 501-509 510-519, #vecs,21 or 20,x,y1300 RESTORE 13101310 DATA 200,210,300,310,400,410,500,5101320 DATA 4,20,4,0,20,0,-6,20,-4,0,20,0,61330 DATA 2,21,2,0,20,0,-61340 DATA 5,20,4,0,20,0,-3,20,-4,0,20,0,-3,20,4,01350 DATA 5,20,4,0,20,0,-6,20,-4,0,21,0,3,20,4,01360 DATA 4,20,0,-3,20,4,0,21,0,3,20,0,-61370 DATA 6,21,4,0,20,-4,0,20,0,-3,20,4,0,20,0,-3,20,-4,01380 DATA 4,20,0,-6,20,4,0,20,0,3,20,-4,01390 DATA 2,20,4,0,20,0,-61400 DATA 6,20,4,0,20,0,-6,20,-4,0,20,0,6,21,0,-3,20,4,01410 DATA 5,21,4,-3,20,-4,0,20,0,3,20,4,0,20,0,-61420 READ N1430 FOR J=1 TO 81440 RESTORE 13201450 FOR I=0 TO 91460 MOVE 65,501470 ROPEN N(J)+I1480 VISIBILITY N(J)+I,01490 READ K01500 FOR K=1 TO K01510 READ K1,K2,K31520 GO TO K1-19 OF 1530,15501530 RDRAW K2,K31540 GO TO 15601550 RMOVE K2,K31560 NEXT K1570 RCLOSE 1575 IF N(J)>310 THEN 15851580 STPOINT N(J)+I,(J=1)*58+(J=2)*53+(J=3)*73+(J=4)*68,981582 GO TO 15901585 STPOINT N(J)+I,(J=5)*58+(J=6)*53+(J=7)*73+(J=8)*68,981590 NEXT I1600 NEXT J1610 M9=01620 M8=-11630 H9=01640 H8=-11650 GO TO 17701660 REM Test HIT and MISS one at a time - press return to advance1670 MOVE 54,1001680 PRINT "HIT   :  MISS"1690 FOR M9=0 TO 991700 REM M9=H91710 CALL Updatescore(H9,M9)1720 INPUT K$1730 HOME 1740 NEXT M91750 END 1760 REM init Cylon position & velocity and enable objects 100 and 1011770 GOSUB 25201780 GOSUB 25601790 STPOINT 100,I0,I11800 VISIBILITY 100,11810 STPOINT 101,I0,I11820 VISIBILITY 101,11830 REM Update Score1840 CALL Updatescore(H9,M9)1850 MOVE 53.5,1001860 PRINT "HIT   :  MISS"1870 REM **************** Start the game main loop ********************1880 REM animate the Cylon move from object 100 to 1011890 REM if the Cylon is at edge of the screen - record miss, init next1900 I0=I0+I21910 I1=I1+I31911 STPOINT 100,I0,I11912 STPOINT 101,I0,I11920 IF I0>5 AND I0<125 AND I1>5 AND I1<95 THEN 20001930 REM Cylon has escaped - record miss, init next Cylon1940 VISIBILITY 100,01950 VISIBILITY 101,01960 FOR I=1 TO 8001970 NEXT I1980 M9=M9+11990 GO TO 17702000 FOR I=1 TO 22010 NEXT I2020 REM player uses the joystick to move the Viper closer to the Cylon2030 INPUT @5,31:P,Q,A0,B0,C0,D02040 REM Joystick P/Q, A0,B0,C0,D0 are buttons 1-4 0=button pressed2050 REM use player joystick to move Cylon relative to target crosshair2060 I0=I0-P/10002070 I1=I1-Q/10002080 REM fire lasers if D0=02090 IF D0=1 THEN 19002100 VISIBILITY 10,12110 BLINK 10,0.05,0.12120 REM add laser sound effect from Invaders I2130 CALL "SOUNDS",G$2140 VISIBILITY 10,02150 CALL Cyloncheck(R,H)2160 IF H=0 THEN 19002170 REM if Cylon hit H=2 then kill otherwise continue2180 IF H>0 THEN 22002190 REM kill shot on Cylon #R2200 VISIBILITY 100,02210 VISIBILITY 101,02220 GO TO 17702230 HOME 2240 END 2250 SUB Cyloncheck(R,H)2260 REM check if this Cylon ship is hit at 65,50 targeting center2270 X6=I0-652280 X7=X9+X62290 Y6=I1-502300 Y7=Y9+Y62310 REM IF D0=0 THEN 16702320 H=INSIDE(X7,Y7,65,50)2330 IF H=0 THEN 24402340 H9=H9+12350 REM show explosion at 65,502360 VISIBILITY 4,12370 CALL "SOUNDS",H$2380 REM  MOVE X7(27),Y7(27)2390 REM  FOR I=1 TO 272400 REM  DRAW X7(I),Y7(I)2410 REM  NEXT I2420 VISIBILITY 4,02430 GO TO 24502440 M9=M9+12450 END SUB 2460 MOVE X9(27),Y9(27)2470 FOR I=1 TO 272480 DRAW @32,20:X9(I),Y9(I)2490 NEXT I2500 END 2510 REMARK        INITIALIZE Cylon POSITION2520 I0=124*RND(1)+2.962530 I1=80*RND(1)+2.962540 RETURN 2550 REMARK        INITIALIZE Cylon VELOCITY2560 I2=1.5*RND(1)-0.52570 I3=1.5*RND(1)-0.52580 RETURN 2590 REM Score Routine2600 SUB Updatescore(H9,M9)2610 REM create 1's H9  10's H9 1's M9  10's M9, 4x6 0,0 is UPPER LEFT2620 REM object 200-209 210-219 301-309 310-319, #vecs,21 or 20,x,y2625 REM object 400-409 410-419 501-509 510-519, #vecs,21 or 20,x,y2630 REM H9,M9 are new values, H8 and M8 the last HIT and MISS values2635 REM each digit has two objects to double the brightness2640 REM update HIT if necessary2650 IF H8<>-1 THEN 27102660 REM set initial HIT to 02670 H8=02680 VISIBILITY 200,12685 VISIBILITY 400,12690 GO TO 27902700 REM Check if HIT has changed2710 IF H8=H9 THEN 28102720 REM Update HIT - start with 1's digit2730 VISIBILITY 200+(H8 MOD 10),02735 VISIBILITY 400+(H8 MOD 10),02740 VISIBILITY 200+(H9 MOD 10),12745 VISIBILITY 400+(H9 MOD 10),12750 REM now check 10's digit of HIT2760 IF INT(H8/10)=INT(H9/10) THEN 27902770 VISIBILITY 210+INT(H8/10),02775 VISIBILITY 410+INT(H8/10),02780 VISIBILITY 210+INT(H9/10),12785 VISIBILITY 410+INT(H9/10),12790 H8=H92800 REM update MISS if necessary2810 IF M8<>-1 THEN 28702820 REM set initial MISS to 02830 M8=02840 VISIBILITY 300,12845 VISIBILITY 500,12850 GO TO 29502860 REM Check if MISS has changed2870 IF M8=M9 THEN 29602880 REM Update MISS - start with 1's digit2890 VISIBILITY 300+(M8 MOD 10),02895 VISIBILITY 500+(M8 MOD 10),02900 VISIBILITY 300+(M9 MOD 10),12905 VISIBILITY 500+(M9 MOD 10),12910 REM now check 10's digit of MISS2920 IF INT(M8/10)=INT(M9/10) THEN 29502930 VISIBILITY 310+INT(M8/10),02935 VISIBILITY 510+INT(M8/10),02940 VISIBILITY 310+INT(M9/10),12945 VISIBILITY 510+INT(M9/10),12950 M8=M92960 END SUB 
100 REM Battlestar Galactica filled R12 cloud - mcm MARCH 2025110 REM and Tekniques V3N1 "Shading Routine for Complex Shapes"120 INIT130 PRINT "Filled Cloud"140 INPUT G$150 F=1160 F0=1170 DIM R(90*2),R$(90*3),T(8),T$(12),U(10),U$(15)190 FIND@5:41195 FIND@6:42200 READ @5:T$,C$,R$205 WRITE @6:"Filled Cloud",C$,R$210 CALL "CHANGE",R$,R270 DIM P(2,90),W(2,91),X(90),P1(2),D0(2),Z$(3)280 REM set hatch Angle=0, no Crosshatch, hatch Distance=1290 A=0300 C=0310 D=0.127320 REM PAGE330 REM  R() to P()332 P=0334 R(1)=-R(1)336 R(2)=-R(2)340 MOVE R(1),R(2)350 FOR I=1 to 90360 P(1,I)=R(I*2-1)370 P(2,I)=R(I*2)380 DRAW P(1,I),P(2,I)390 NEXT I395 DIM P$(3246)400 N=90430 P$=""440 GO TO 3010950 CALL "AGIN",X9,Y9960 D0(1)=-X9970 D0(2)=-Y9980 CALL "CHANGE",D0,Z$990 P$=P$&Z$1000 RETURN 1010 CALL "AGIN",X9,Y91020 D0(1)=X91030 D0(2)=Y91040 CALL "CHANGE",D0,Z$1050 P$=P$&Z$1060 RETURN 3000 REM now add horizontal hatch lines to fill this polygon3010 S=1.0E+3073020 L0=-1.0E+3073030 S1=SIN(A)3040 C1=COS(A)3050 FOR I=1 TO N3060 W(1,I)=P(1,I)*C1+P(2,I)*S13070 W(2,I)=-P(1,I)*S1+P(2,I)*C13080 S=S MIN W(2,I)3090 L0=L0 MAX W(2,I)3100 NEXT I3110 W(1,N+1)=W(1,1)3120 W(2,N+1)=W(2,1)3130 Y2=S+0.5*D3140 IF Y2>L0 THEN 40003150 K=03160 FOR I=1 TO N3170 W1=W(2,I) MIN W(2,I+1)3180 IF Y2<W1 THEN 33003190 W2=W(2,I) MAX W(2,I+1)3200 IF Y2=>W2 THEN 33003210 X1=W(1,I)-(W(2,I)-Y2)*(W(1,I)-W(1,I+1))/(W(2,I)-W(2,I+1))3220 K=K+13230 J=K3240 IF J=1 THEN 32903250 IF X(J-1)=>X1 THEN 32903260 X(J)=X(J-1)3270 J=J-13280 GO TO 32403290 X(J)=X13300 NEXT I3310 FOR I=1 TO K3320 P1(1)=X(I)*C1-Y2*S13330 P1(2)=X(I)*S1+Y2*C13335 rem IF F0=1 THEN 35003340 IF 2*INT(0.5*I)-I>-0.1 THEN 33703350 MOVE P1(1),P1(2)3355 GOSUB 9503360 GO TO 33803370 DRAW P1(1),P1(2)3375 GOSUB 10103380 NEXT I3390 Y2=Y2+D3400 GO TO 31404000 WRITE@6:P$4020 HOME4030 END
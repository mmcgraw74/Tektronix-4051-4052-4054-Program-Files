100 REM Battlestar Galactica filled STAR - mcm MARCH 2025110 REM and Tekniques V3N1 "Shading Routine for Complex Shapes"120 INIT125 SET DEGREES130 PRINT "Create R12 5-point Filled STAR (10-side polygon)"150 F=1160 F0=1170 DIM R(10*2),R$(10*3),T(8),T$(12),U(10),U$(15),P$(3246),D0(2),Z$(3)171 DIM V(8*5)179 REM now create R12 STAR with first vector as MOVE180 rem  GOSUB 5000  THIS GENERATED THE OUTLINE OF THE STAR190 FIND@5:80195 FIND@6:80200 READ @5:T$,C$,R$205 WRITE @6:"Filled BRIGHT SHINING STAR","  ",R$210 CALL "CHANGE",R$,R270 DIM P(2,10),W(2,11),X(10),P1(2)280 REM set hatch Angle=0, no Crosshatch, hatch Distance=1290 A=0300 C=0310 D=0.127320 REM PAGE330 REM  R() to P()332 P=0334 R(1)=-R(1)336 R(2)=-R(2)340 MOVE R(1),R(2)350 FOR I=1 to 10360 P(1,I)=R(I*2-1)370 P(2,I)=R(I*2)380 DRAW P(1,I),P(2,I)390 NEXT I392 DRAW P(1,1),P(2,1)395 DIM P$(3246)400 N=10430 P$=""440 GO TO 3010950 CALL "AGIN",X9,Y9960 D0(1)=-X9970 D0(2)=-Y9980 CALL "CHANGE",D0,Z$990 P$=P$&Z$1000 RETURN 1010 CALL "AGIN",X9,Y91020 D0(1)=X91030 D0(2)=Y91040 CALL "CHANGE",D0,Z$1050 P$=P$&Z$1060 RETURN 3000 REM now add horizontal hatch lines to fill this polygon3010 S=1.0E+3073020 L0=-1.0E+3073030 S1=SIN(A)3040 C1=COS(A)3050 FOR I=1 TO N3060 W(1,I)=P(1,I)*C1+P(2,I)*S13070 W(2,I)=-P(1,I)*S1+P(2,I)*C13080 S=S MIN W(2,I)3090 L0=L0 MAX W(2,I)3100 NEXT I3110 W(1,N+1)=W(1,1)3120 W(2,N+1)=W(2,1)3130 Y2=S+0.5*D3140 IF Y2>L0 THEN 40003150 K=03160 FOR I=1 TO N3170 W1=W(2,I) MIN W(2,I+1)3180 IF Y2<W1 THEN 33003190 W2=W(2,I) MAX W(2,I+1)3200 IF Y2=>W2 THEN 33003210 X1=W(1,I)-(W(2,I)-Y2)*(W(1,I)-W(1,I+1))/(W(2,I)-W(2,I+1))3220 K=K+13230 J=K3240 IF J=1 THEN 32903250 IF X(J-1)=>X1 THEN 32903260 X(J)=X(J-1)3270 J=J-13280 GO TO 32403290 X(J)=X13300 NEXT I3310 FOR I=1 TO K3320 P1(1)=X(I)*C1-Y2*S13330 P1(2)=X(I)*S1+Y2*C13335 rem IF F0=1 THEN 35003340 IF 2*INT(0.5*I)-I>-0.1 THEN 33703350 MOVE P1(1),P1(2)3355 GOSUB 9503360 GO TO 33803370 DRAW P1(1),P1(2)3375 GOSUB 10103380 NEXT I3390 Y2=Y2+D3400 GO TO 31404000 WRITE@6:P$,"|EOG|"4020 HOME4030 END4997 REM find the line intersections for STAR so no crossed lines4998 REM five point star has five points on circle at 72 degrees4999 REM first draw MAP box - STAR is in center5000 REM *** Display BRIGHT STAR file SKIP ATTRIBUTION ***5010 FIND @6:785020 READ @6:T$,C$5030 PAGE5040 READ @6:P$5050 IF P$="|EOG|" THEN 50805060 CALL "RDRAW",P$,1,0,05070 GO TO 50405080 REM MAP BOX CORNERS: 40/75,78/75,78/51,40,415090 REM SO CENTER OF BOX FOR STAR: (78-40)/2,(75-51)/25100 P$=""5110 X0=(78-40)/2+405120 Y0=(75-51)/2+515130 R=05160 REM NOW STORE 5 MAIN STAR VERTICES IN r()5170 REM LEAVING SPACE TO LATER STORE COMPUTED VERTEX IN BETWEEN5200 I=15210 FOR A=90 TO -270+72 STEP -725220 MOVE X0+5*COS(A),Y0+5*SIN(A)5230 GOSUB 10105240 R(I)=D0(1)5250 R(I+1)=D0(2)5260 I=I+45270 NEXT A5280 REM NOW DRAW 5-SIDED STAR TO CHECK SHAPE WITH CROSSED LINES5290 REM outer VERTICES: R1/R2, R5/R6, R9/R10, R13/R14, R17/R185300 REM MOVE R(1),R(2)5310 REM DRAW R(9),R(10)5320 REM DRAW R(17),R(18)5330 REM DRAW R(5),R(6)5340 REM DRAW R(13),R(14)5350 REM DRAW R(1),R(2)5360 DATA 1,2,9,10,5,6,17,18,5,6,13,14,9,10,1,2,9,10,17,18,13,14,5,65370 DATA 13,14,1,2,17,18,9,10,17,18,5,6,1,2,13,145380 READ V5390 REM NOW FIND LINE INTERSECTIONS FOR FIVE INSIDE VERTICES5400 REM  https://www.cuemath.com/geometry/intersection-of-two-lines5410 REM LINE 1: POINTS X1,Y1 TO X2,Y2, SLOPE1: M1=(Y2-Y1)/(X2-X1)5420 REM LINE 2: POINTS X3,Y3 TO X4,Y4, SLOPE2: M2=(Y4-Y3)/(X4-X3)5430 REM SLOPE-INTERCEPT LINE EQUATION: y=mx+b OR x=(y-b)/m5440 REM SOLVE FOR B1 & B2 USING FIRST POINT AND SLOPE IN BOTH LINES5450 REM B1=Y1-M1X1 AND B2=Y3-M2X35460 REM @INTERSECTION: Y0=M1X0+B1 = M2X0+B25470 REM SOLVE FOR X0:  M1X0-M2X0=B2-B15480 REM                X0=(B2-B1)/(M1-M2)5490 REM THEN SOLVE FOR Y0=M1(X0-X1)+B15495 REM R(V(I)+1)=X1,R(V(I+2)=Y1,R(V(I+3))=X2,R(V(I+4)=Y2 FOR A LINE5500 REM NOW DRAW FROM ADJACENT OUTER VERTICES TO X0,Y0 FOR THE STAR5505 P$=""5510 MOVE R(1),R(2)5520 GOSUB 9505530 FOR I=0 TO 45540 X1=R(V(I*8+1))5550 Y1=R(V(I*8+2))5560 X2=R(V(I*8+3))5570 Y2=R(V(I*8+4))5580 X3=R(V(I*8+5))5590 Y3=R(V(I*8+6))5600 X4=R(V(I*8+7))5610 Y4=R(V(I*8+8))5620 M1=(Y2-Y1)/(X2-X1)5630 B1=Y1-M1*X15640 M2=(Y4-Y3)/(X4-X3)5650 B2=Y3-M2*X35660 X0=(B2-B1)/(M1-M2)5670 Y0=M1*(X0)+B15680 MOVE X0,Y05690 GOSUB 10105700 R(I*4+3)=D0(1)5710 R(I*4+4)=D0(2)5720 IF I<>4 THEN 57505730 MOVE R(1),R(2)5740 GO TO 57605750 MOVE R(I*4+5),R(I*4+6)5760 GOSUB 10105770 NEXT I5780 CALL "RDRAW",P$,1,0,05790 FIND @6:805800 WRITE @6:"Filled BRIGHT STAR","  ",P$,"|EOG|"5950 REM ADD FILLED BRIGHT STAR AFTER MAP AND TEXT ARE DRAWN5990 HOME6000 END
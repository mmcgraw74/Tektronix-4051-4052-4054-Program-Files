1000 REM  *********************
1010 REM  DRIVER FOR POLRT - FIND THE ROOTS OF A REAL POLY. 
1020 REM
1030 PRINT "ENTER DEGREE OF POLYNOMIAL AND #DIGITS ACCURACY = ";
1040 INPUT N,E
1050 E=10^-E
1060 DELETE P1,P2,Q1
1070 DIM P1(N),P2(N),Q1(N+1)
1080 PRINT "J_ENTER COEFFICIENTS OF THE POLYNOMIAL,"
1090 PRINT "ORDERED FROM SMALLEST TO LARGEST POWER:"
1100 FOR P0=1 TO N+1
1110 PRINT "J_";P0-1;" POWER = ";
1120 INPUT Q1(P0)
1130 NEXT P0
1140 PRINT "J_J_             #     REAL PART         IMAG. PART"
1150 GOSUB 1500
1160 PRINT "J_J_COMPLETION FLAG = ";F;"J_J_"
1170 END 
1180 REM  END OF DRIVER FOR POLRT.
1190 REM  ********************** 
1200 REM 
1210 REM  **********************
1220 REM  "POLYNOMIAL ROOTS" - COMPUTES THE REAL AND COMPLEX ROOTS
1230 REM                       OF A REAL POLYNOMIAL.
1240 REM  PARMETERS 
1250 REM    Q1- (INPUT)  VECTOR OF  N+1  COEFFICENTS OF THE 
1260 REM        POLYNOMIAL, ORDERED FROM SMALLEST TO
1270 REM        LARGEST POWER.
1280 REM    N - (INPUT)  ORDER OF POLYNOMIAL
1290 REM    P1- (OUTPUT)  VECTOR OF LENGTH N CONTAINING THE 
1300 REM        REAL PART OF THE ROOTS OF THE POLNOMIAL 
1310 REM    P2- (OUTPUT)  VECTOR OF LENGTH N CONTAINING THE 
1320 REM        IMAGINARY PART OF THE ROOTS OF THE POLYNOMIAL.
1330 REM    F - (OUTPUT)  ERROR CODE WITH THE MEANINGS: 
1340 REM        0 - NO ERROR
1350 REM        1 - ERROR: N<1
1360 REM        3 - ERROR: UNABLE TO DETERMINE A ROOT AFTER 
1370 REM            500 ITERATIONS ON 5 STARTING VALUES.
1380 REM        4 - HIGH ORDER COEFFICIENT IS 0.
1390 REM    E - (INPUT)  DESIRED ACCURACY (EG. 1E-6)
1400 REM
1500 DELETE Q2
1510 DIM Q2(N+1),P(14)
1520 P(9)=0
1530 P7=N
1540 F=0
1550 IF Q1(P7+1)=0 THEN 1590
1560 IF P7>0 THEN 1610
1570 F=1
1580 RETURN 
1590 F=4
1600 RETURN 
1610 P(7)=P7
1620 P(8)=P7+1
1630 P(6)=1
1640 Q7=P7+2
1650 FOR Q0=1 TO P7+1
1660 Q2(Q7-Q0)=Q1(Q0)
1670 NEXT Q0
1680 P(11)=0.00500101
1690 P(12)=0.010000101
1700 P(4)=0
1710 P8=P(11)
1720 P(11)=-10*P(12)
1730 P(12)=-10*P8
1740 P8=P(11)
1750 P9=P(12)
1760 P(4)=P(4)+1
1770 GO TO 1810
1780 P(9)=1
1790 P(13)=P8
1800 P(14)=P9
1810 P(5)=0
1820 P3=0
1830 P4=0
1840 P6=0
1850 Q3=1
1860 Q4=0
1870 P5=Q2(P7+1)
1880 IF P5=0 THEN 2350
1890 FOR P0=1 TO P7
1900 Q0=P7+1-P0
1910 Q8=Q2(Q0)
1920 Q5=P8*Q3-P9*Q4
1930 Q6=P8*Q4+P9*Q3
1940 P5=P5+Q8*Q5
1950 P6=P6+Q8*Q6
1960 P3=P3+P0*Q3*Q8
1970 P4=P4-P0*Q4*Q8
1980 Q3=Q5
1990 Q4=Q6
2000 NEXT P0
2010 P(10)=P3*P3+P4*P4
2020 IF P(10)=0 THEN 2260
2030 P(2)=(P6*P4-P5*P3)/P(10)
2040 P8=P8+P(2)
2050 P(3)=-(P5*P4+P6*P3)/P(10)
2060 P9=P9+P(3)
2070 IF ABS(P(2))+ABS(P(3))<E THEN 2140
2080 P(5)=P(5)+1
2090 IF P(5)<500 THEN 1820
2100 IF P(9)<>0 THEN 2140
2110 IF P(4)<5 THEN 1710
2120 F=3
2130 RETURN 
2140 P0=N+2
2150 FOR Q0=1 TO P(8)
2160 Q7=P0-Q0
2170 Q8=Q1(Q7)
2180 Q1(Q7)=Q2(Q0)
2190 Q2(Q0)=Q8
2200 NEXT Q0
2210 Q7=P7
2220 P7=P(7)
2230 P(7)=Q7
2240 IF P(9)=0 THEN 1780
2250 GO TO 2290
2260 IF P(9)=0 THEN 1710
2270 P8=P(13)
2280 P9=P(14)
2290 P(9)=0
2300 IF ABS(P9)<10*E*ABS(P8) THEN 2380
2310 P(1)=P8+P8
2320 P(10)=P8*P8+P9*P9
2330 P7=P7-2
2340 GO TO 2420
2350 P8=0
2360 P(7)=P(7)-1
2370 P(8)=P(8)-1
2380 P9=0
2390 P(10)=0
2400 P(1)=P8
2410 P7=P7-1
2420 Q2(2)=Q2(2)+P(1)*Q2(1)
2430 Q7=P(1)
2440 Q8=P(10)
2450 FOR Q0=2 TO P7
2460 Q2(Q0+1)=Q2(Q0+1)+Q7*Q2(Q0)-Q8*Q2(Q0-1)
2470 NEXT Q0
2480 P1(P(6))=P8
2490 P2(P(6))=P9
2500 PRINT USING "L,11X,3D,4X,S":P(6)
2510 PRINT P8,P9
2520 P(6)=P(6)+1
2530 IF P(10)=0 THEN 2570
2540 P9=-P9
2550 P(10)=0
2560 GO TO 2480
2570 IF P7>0 THEN 1680
2580 RETURN 
2590 REM  END OF "POLYNOMIAL ROOTS"
2600 REM  *************************




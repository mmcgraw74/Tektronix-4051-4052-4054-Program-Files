5000 REM * "@TIME3/NEW1" OVERLAY5070 REM * NEW CHART CONTROL5100 O=15110 GOSUB 52705120 GOSUB 80005130 GOSUB 54505140 GOSUB 136605150 GOSUB 63105160 GOSUB 66505170 GOSUB 67205180 GOSUB 68005190 IF D1=0 THEN 52305200 GOSUB 68505210 GOSUB 70305220 GOSUB 150005230 GOSUB 69205240 IF D1=0 OR N=0 THEN 52605250 GOSUB 72905260 RETURN5270 REM * SET PARAMETERS5280 A0=35290 A1=725300 B0=15310 D0=45320 L0=305330 N0=205340 R0=725350 S0=35360 X0=605370 Y0=605440 RETURN5450 REM * NEW PLOT DEFAULTS5460 A$=""5470 FOR I=1 TO A05480 J$=SEG(E$,1,A1)5490 A$=A$&J$5500 NEXT I5510 D=05520 D1=05530 F$=""5540 F0=105550 F1=105560 F2=105570 H$="NNYY"5580 G3=05590 G4=05600 G5=05610 G6=05620 L$=""5630 L=0.95640 L1=-15650 L2=-15660 N$="                                "5670 N$=REP("R",D0+1,1)5680 N=05690 O0=05695 P$="Y"5696 Q$="Y"5700 Q1=-15710 Q2=-15720 Q3=-15730 Q4=-15740 R=15750 R1=05760 R2=05770 S1=05780 S2=05785 S4=0.85790 S$=""5800 FOR I=1 TO S05810 J$=SEG(E$,1,R0)5820 S$=S$&J$5830 NEXT I5840 V1=05850 X$=" "5860 Y$=" "5870 Y=05880 Y1=05890 Y2=15900 Y3=105910 Y4=105930 RETURN6310 REM * SET X-AXIS UNITS6320 J$="WEEK   	  52MONTH  	  12QUARTER	   4YEAR   	9999OTHER         "6330 PRINT "	TIME UNIT	PERIOD'S MAX VALUE
"6340 FOR I=1 TO 56350 I$=SEG(J$,I*12-12+1,12)6360 K$=SEG(J$,I*12-12+1,1)6370 PRINT K$;"	";I$6380 NEXT I6390 PRINT "
ENTER TIME UNIT(W/M_/Q/Y/O)? ";6400 INPUT K$6410 IF K$<>"O" THEN 65006420 PRINT "
ENTER TIME UNIT DESIRED SUCH AS 'MONTH'(DEFAULT='UNIT')? ";6430 INPUT R$6435 IF R$<>"" THEN 64406436 R$="UNIT"6440 PRINT "
PERIOD'S MAX VALUE SUCH AS 12 FOR MONTHS(DEFAULT=9999)? ";6450 INPUT Z$6460 P=99996470 IF Z$="" THEN 64906480 IF Z=-1.1E+12 THEN 64406485 P=Z6490 GO TO 65806500 IF K$<>"W" THEN 65206505 R$="WEEK"6510 P=526515 GO TO 65806520 IF K$<>"M" AND K$<>"" THEN 65406525 R$="MONTH"6530 P=126535 GO TO 65806540 IF K$<>"Q" THEN 65606545 R$="QUARTER"6550 P=46555 GO TO 65806560 IF K$<>"Y" THEN 63906565 R$="YEAR"6570 P=99996580 PRINT "
ENTER # OF FIRST ";R$;" TO BE PLOTTED? ";6590 INPUT Z$6592 GOSUB 4006594 IF Z=-1.1E+12 OR Z>P THEN 65806596 Y=Z6610 PRINT "
ENTER # OF ";R$;"S TO BE PLOTTED(MAX=";N0;")? ";6620 INPUT Z$6622 GOSUB 4006630 IF Z=-1.1E+12 OR Z>N0 THEN 66106632 IF Z>1 THEN 66356633 PRINT "YOU MUST PLOT AT LEAST 2 TIME PERIODS"6634 GO TO 66106635 N=Z6640 RETURN6650 REM * X-AXIS LABEL6660 PRINT "
ENTER X-AXIS LABEL SUCH AS: 'FY78 THRU FY89'"6680 Z=X06690 GOSUB 4606700 X$=Z$6710 RETURN6720 REM * Y-AXIS LABEL6730 PRINT "
ENTER Y-AXIS LABEL SUCH AS:'DOLLARS'OR'WIDGETS'"6750 Z=Y06760 GOSUB 4606770 Y$=Z$6790 RETURN6800 REM * # OF DATA LINES6810 PRINT "ENTER # OF DATA LINES OR BAR TYPES(MAX=";D0;")? ";6820 INPUT Z$6822 GOSUB 4006824 IF Z=-1.1E+12 OR Z>D0 OR Z<0 THEN 68106826 D1=Z6840 RETURN6850 REM * DATA LINE LABELS6860 IF D1=0 THEN 69106880 FOR I1=1 TO D16890 GOSUB 112706900 NEXT I16910 RETURN6920 REM * SELECT LEGEND TYPE6930 PRINT "LEGEND TYPES ARE:"6940 PRINT "
N - NO LEGEND L - USER POSITIONED LINE LABELS"6950 PRINT "B - BOTH USER POSITIONED LINE OR BAR TYPE LEGENDS & LABELS"6960 PRINT "R - LINE OR BAR LEGENDS & LABELS LOCATED AT RIGHT OF PLOT"6970 PRINT "
SELECT ONE OF THE FOLLOWING(N/L/B/R_)? ";6980 INPUT I$6990 IF I$="N" OR I$="L" OR I$="B" THEN 70106995 IF I$<>"R" AND I$<>"" THEN 69307000 I$="R"7010 N$=REP(I$,D0+1,1)7020 RETURN7030 REM * SET LINE MODE DEFAULTS7040 F0=107050 F0(D0+1)=0.77060 F1=107070 F2=107080 IF D1<2 THEN 72807090 F0(D1)=0.27100 F1(D1)=107110 F2(D1)=0.17120 IF D1<3 THEN 72807130 F0(D1-1)=0.87140 F1(D1-1)=0.67150 F2(D1-1)=0.67160 IF D1<4 THEN 72807170 F0(2)=37180 F1(2)=107190 F2(2)=1.27200 IF D1<5 THEN 72807210 F0(3)=1.67220 F1(3)=1.27230 F2(3)=1.27240 IF D1<6 THEN 72807250 F0(4)=17260 F1(4)=1.27270 F2(4)=0.67280 RETURN7290 REM * INITIAL DATA ENTRY7300 J1=17310 J2=N7320 FOR Z3=1 TO D1 STEP 57330 I1=Z37340 I2=Z3+4 MIN D17350 GOSUB 100007360 NEXT Z37390 GOSUB 106807395 GOSUB 108107400 RETURN8000 REM * MAXIMUMS CONTROL8010 GOSUB 82308060 PRINT "
NOTE: MEMORY MUST BE POSITIVE TO EXIT"8070 PRINT "ENTER # OF PARAMETER TO CHANGE OR 'RETURN' TO CONTINUE
"8080 K0=K0+18090 IF K0<6 THEN 81208100 GOSUB 82308110 GO TO 80608120 PRINT "PARAMETER = ";8130 INPUT Z$8140 IF Z$="" AND K+(T>30000)*24589=>0 THEN 82108150 GOSUB 4008160 IF Z<1 OR Z>9 OR Z=-1.1E+12 THEN 81208165 I0=Z8170 GOSUB 84408180 GOSUB 83908190 PRINT "		BYTES OF MEMORY REMAINING = ";K+(T>30000)*245898200 GO TO 80808210 GOSUB 9008220 RETURN8230 REM * PRINT MAXS8240 PRINT "PARAMETER	        MAXIMUM"8250 PRINT "
1  MAX = ";A0;"  TITLE LINES"8260 PRINT "2  MAX = ";A1;" CHARACTERS PER TITLE LINE"8270 PRINT "3  MAX = ";D0;"  DATA LINES OR BAR SHADING TYPES"8280 PRINT "4  MAX = ";L0;" CHARACTERS PER DATA LINE LABEL"8290 PRINT "5  MAX = ";N0;" TIME PERIODS ON AXIS"8300 PRINT "6  MAX = ";X0;" CHARACTERS FOR X-AXIS LABEL"8305 PRINT "7  MAX = ";Y0;" CHARACTERS FOR Y-AXIS LABEL"8310 PRINT "8  MAX = ";S0;"  EXTRA TEXT STRINGS"8320 PRINT "9  MAX = ";R0;" CHARACTERS PER EXTRA TEXT STRING"8330 PRINT "
PARAMETER MAXIMUMS CAN BE ADJUSTED WITHIN MEMORY LIMITS"8340 PRINT "IN ORDER TO INCREASE A MAXIMUM OTHERS MAY NEED DECREASING"8350 GOSUB 83908360 PRINT "
MEMORY STATUS: FOR 32K:";K;" BYTES  VS  FOR 64K:";K+24589;8361 PRINT " BYTES"8365 PRINT "
BYTES OF MEMORY RAMAINING = ";K+(T>30000)*245898370 K0=08380 RETURN8390 REM * CALCULATE MEMORY REMAINING8400 I=A0*A1+D0*L0+S0*R0+X0+Y08410 J=2*A0+2*D0*N0+9*D0+N0+5*S08420 K=2569-(I+J*8)8430 RETURN8440 REM * INPUT NEW MAX8450 PRINT "	NEW MAXIMUM = ";8460 INPUT Z$8462 GOSUB 4008464 IF Z=-1.1E+12 THEN 85108466 J0=Z8470 IF J0<73 OR I0=1 OR I0=3 OR I0=5 OR I0=8 THEN 85008480 PRINT "72 CHARACTERS IS TEXT LINE LIMIT"8490 J0=728500 IF J0>0 AND J0=INT(J0) THEN 85308510 PRINT "ERRORMAXIMUM MUST BE INTEGER GREATER THAN ZERO"8520 GO TO 86808530 GO TO I0 OF 8535,8550,8570,8590,8610,8630,8642,8650,86708535 A0=J08540 GO TO 86808550 A1=J08560 GO TO 86808570 D0=J08580 GO TO 86808590 L0=J08600 GO TO 86808610 N0=J08620 GO TO 86808630 X0=J08640 GO TO 86808642 Y0=J08643 GO TO 86808650 S0=J08660 GO TO 86808670 R0=J08680 RETURN10000 REM * DATA INPUT LOOP10010 FOR J0=J1 TO J1+J2-110020 IF INT((J1-J0+19)/19)<>(J1-J0+19)/19 THEN 1009010030 PRINT "	DATA ENTRY INSTRUCTIONS	***********************"10040 PRINT "
1. ENTER A 'CARRIAGE RETURN' AFTER EACH DATA VALUE"10050 PRINT "2. ERRORS MAY BE CHANGED AFTER DATA ENTRY WITH USER KEY#16"10060 PRINT "3. WHERE DATA IS NOT AVAILABLE PRESS 'RETURN'"10070 PRINT "4. ENTER NUMBERS IN UNITS TO BE PLOTTED"10080 GOSUB 1031010090 J=J0+Y-110100 IF J<P+1 THEN 1013010110 J=J-P10120 GO TO 1010010130 PRINT " ";J;"       ";10140 FOR I0=I1 TO I210150 IF I0=I1 THEN 1021010160 PRINT "       ";10180 FOR K=I1+1 TO I010190 PRINT "           ";10200 NEXT K10210 INPUT Z$10220 IF Z$<>"" THEN 1025010230 D(I0,J0)=-1.1E+1210240 GO TO 1028010250 GOSUB 40010260 IF Z=-1.1E+12 THEN 1013010270 D(I0,J0)=Z10280 NEXT I010290 NEXT J010300 RETURN10310 REM * LINE LABELS AS WORDS10320 PRINT10330 FOR I=I1 TO I210340 K1(I)=I*L0-L0+110350 NEXT I10360 FOR J=1 TO INT(L0/10)+210370 K$=SEG(E$,1,10+(I2-I1)*11)10380 FOR I=I1 TO I210390 IF K1(I)>I*L0 THEN 1054410400 K0=010410 FOR K=1 TO 11 MIN I*L0+1-K1(I)10420 J$=SEG(L$,K1(I)+K-1,1)10430 IF J$<>" " THEN 1045010440 K0=K10450 NEXT K10460 IF K0<>0 THEN 1050010470 J$=SEG(L$,K1(I),10 MIN I*L0+1-K1(I))10480 K$=REP(J$,(I-I1)*11+1,LEN(J$))10490 K1(I)=K1(I)+(10 MIN I*L0+1-K1(I))10495 GO TO 1054410500 J$=SEG(L$,K1(I),K0-1)10510 K$=REP(J$,(I-I1)*11+1,LEN(J$))10520 K1(I)=K1(I)+K0-110530 K1(I)=K1(I)+110540 IF K1(I)>I*L0 THEN 1054410542 IF POS(L$," ",K1(I))=K1(I) THEN 1053010544 NEXT I10550 PRINT "       ";K$10560 NEXT J10570 PRINT "";R$;"
"10580 RETURN10630 REM * CHECK SCALE10640 GOSUB 1068010644 IF Y1+Y2*5<M1 OR M2<Y3-Y2*5 THEN 1064810646 IF M1=>Y1 AND M2<=Y3 THEN 1065010648 GOSUB 1081010650 RETURN10680 REM * CALCULATE MIN & MAX10690 M1=9.0E+1010700 M2=-9.0E+1010710 FOR I=1 TO D110720 FOR J=1 TO N10730 IF D(I,J)=-1.1E+12 THEN 1078010740 IF D(I,J)=>M1 THEN 1076010750 M1=D(I,J)10760 IF D(I,J)<=M2 THEN 1078010770 M2=D(I,J)10780 NEXT J10790 NEXT I10800 RETURN10810 REM * AUTO SCALE10820 I0=1.0E-1110830 Y1=010840 Y2=110850 Y3=1010860 IF M1<>9.0E+10 THEN 1089010870 M1=010880 M2=010890 IF M1=0 AND M2=0 THEN 1101010900 IF M1<0 AND ABS(M1)*2>M2 THEN 1098010910 Z=M210920 GOSUB 1107010930 IF M1<0 THEN 1096010940 Y1=010950 GO TO 1101010960 Y1=-(INT(ABS(M1)/Y2)+2)*Y210970 GO TO 1101010980 Z=ABS(M1) MAX ABS(M2)10990 GOSUB 1107011000 Y1=-Y311010 Y4=(Y3-Y1)/Y211020 IF Y4<12 THEN 1105011030 Y4=Y4/211040 Y2=Y2*211050 PRINT "Y-SCALE NOW RANGES FROM ";Y1;" TO ";Y3;" BY ";Y211060 RETURN11070 REM * SELECT ROUNDED MAX11080 IF LGT(Z)-INT(LGT(Z-I0))<0.84 THEN 1112011090 Y3=10^(INT(LGT(Z-I0))+1)11100 Y2=Y3/1011110 GO TO 1114011120 Y2=10^INT(LGT(Z))11130 Y3=Y2*(INT(Z/Y2)+2)11140 RETURN11270 REM * ENTER LINE LABEL I111280 I2=011290 PRINT "
LINE LABEL ";I1;"? ";11300 Z=L011310 GOSUB 46011320 GOSUB 49011370 L$=REP(Z$,I1*L0-L0+1,I2)11380 RETURN11390 REM * STRIP TRAILING BLANKS11400 FOR Z=LEN(Z$) TO 1 STEP -111410 I$=SEG(Z$,Z,1)11420 IF I$<>" " THEN 1144011430 NEXT Z11440 Z$=SEG(Z$,1,Z)11450 RETURN13660 REM * CREATE TITLES13670 A=113680 B1=013690 PRINT "TITLE LIMITS ARE SET AT ";A0;" LINES OF ";A1;" CHARACTERS"13700 PRINT @32,21:25,7613710 PRINT @32,20:25,91,55,91,55,76,25,7613720 PRINT @32,21:75,9113730 PRINT @32,20:75,96,105,96,105,76,75,76,75,91,105,9113740 PRINT "~^~

	NORMAL TITLES	        BOXED TITLES"13750 PRINT "






NORMAL OR BOXED TITLES(N/B_)? ";13760 INPUT D$13770 IF D$="N" THEN 1381013800 IF D$<>"B" AND D$<>"" THEN 1369013805 D$="B"13810 PRINT "
TITLE LINES WILL BE AUTOMATICALLY CENTERED"13815 PRINT "TITLES MAY BE LEFT JUSTIFIED BY BLANK FILLING LINES"13830 PRINT "
CHARACTER SIZE IS DEFINED SUCH THAT"13840 PRINT C1;" CHARACTERS OF SIZE '1' WILL JUST FIT ACROSS SUBPLOT"13850 I=013860 PRINT "
ENTER TITLE LINE ";I+1;" OR 'RETURN' TO STOP?"13870 Z=A113880 GOSUB 46013890 IF Z0=0 THEN 1406013900 I=I+113910 B1(I)=LEN(Z$)13920 J0=C1/B1(I)13930 A$=REP(Z$,I*A1-A1+1,B1(I))13940 PRINT "
NOTE: DEFAULT SIZE = ";J0 MIN 113945 PRINT "      MAXIMUM SIZE TO FIT ABOVE SUBPLOT = ";J013950 PRINT "ENTER CHARACTER SIZE OR 'RETURN' FOR DEFAULT? ";13960 INPUT Z$13970 IF Z$<>"" THEN 1400013980 A(I)=J0 MIN 113990 GO TO 1404014000 GOSUB 40014010 IF Z=-1.1E+12 THEN 1394014020 A(I)=Z14040 IF I=A0 THEN 1406014050 GO TO 1386014060 RETURN15000 REM * LINE MODE15010 PRINT "BARS (overlayed format) OR LINES(B/L_)? ";15020 INPUT I$15030 IF I$<>"L" AND I$<>"" THEN 1506015040 F=115050 GO TO 1508015060 IF I$<>"B" THEN 1501015070 F=215080 GOSUB F OF 15100,1553015090 RETURN15100 REM * SELECT LINE TYPE15110 PRINT "DATA VALUES CAN BE IDENTIFIED BY SYMBOLS"15120 PRINT "SOME SUGGESTED SYMBOLS ARE (*/$/#/O/X/@/+/%)"15130 PRINT "ENTER SYMBOL DESIRED OR 'RETURN' FOR NO SYMBOLS
"15140 FOR I=1 TO D115150 J$=SEG(L$,I*L0-L0+1,L0 MIN 50)15155 PRINT J$;" ? ";15160 INPUT I$15170 IF I$<>"" THEN 1520015180 I$=" "15190 GO TO 1521015200 IF LEN(I$)>1 THEN 1515015210 N$=REP(I$,I,1)15220 NEXT I15230 I$=SEG(E$,1,D1)15240 J$=SEG(N$,1,D1)15250 IF I$=J$ THEN 1532015260 PRINT "
ENTER SYMBOL SIZE DESIRED(DEFAULT=";S4;")? ";15270 INPUT Z$15280 IF Z$="" THEN 1532015290 GOSUB 40015300 IF Z=-1.1E+12 THEN 1526015310 S4=Z15320 PRINT "EXAMPLE DASH LENGTHS:"15330 PRINT "
	SOLID LINE - 10"15340 PRINT "	LONG DASH  -  2"15350 PRINT "	SHORT DASH -   .8	DOT        -   .2"15360 PRINT "

CURRENT DASH SIZES ARE:
"15370 FOR I=1 TO D115380 J$=SEG(L$,I*L0-L0+1,L0 MIN 50)15385 PRINT J$;" - ";F0(I)15390 NEXT I15400 PRINT "

CHANGE DASH SIZES(Y/N_)? ";15410 INPUT I$15420 IF I$="" OR I$="N" THEN 1552015430 PRI "

ENTER NEW DASH SIZES OR 'RETURNS' WHERE #'S DON'T CHANGE
"15440 FOR I=1 TO D115450 J$=SEG(L$,I*L0-L0+1,L0 MIN 50)15455 PRINT J$;" - ";15460 INPUT Z$15470 IF Z$="" THEN 1551015480 GOSUB 40015490 IF Z=-1.1E+12 THEN 1545015500 F0(I)=Z15510 NEXT I15520 RETURN15530 REM * SELECT BAR SHADE15540 PRINT "
BAR SHADING IS DONE USING HORIZONTAL AND VERTICAL ";15550 PRINT "LINES ONLY"15560 PRINT "
SHADING LINE GAPS RANGE AS FOLLOWS:"15570 PRINT "
	SOLID BAR  -   .1	DARK BAR   -   .3"15580 PRINT "	LIGHT BAR  -   .8	NO SHADING - 10."15590 PRINT "
CURRENT SHADING GAPS ARE AS FOLLOW:
"15600 PRINT "		HORIZONTAL	VERTICAL"15610 FOR I=1 TO D115620 J$=SEG(L$,I*L0-L0+1,L0 MIN 36)15622 PRINT J$15624 PRINT "		   ";F1(I);"	   ";F2(I)15630 NEXT I15640 PRINT "
CHANGE SHADING GAPS(Y/N_)? ";15650 INPUT I$15660 IF I$="" OR I$="N" THEN 1585015670 PRINT "
ENTER NEW GAPS OR 'RETURNS' WHERE NO CHANGE IS DESIRED"15680 PRINT "
		HORIZONTAL	VERTICAL
"15690 FOR I=1 TO D115700 J$=SEG(L$,I*L0-L0+1,L0 MIN 36)15702 PRINT J$15704 PRINT "		   ";15710 INPUT Z$15720 IF Z$="" THEN 1577015730 GOSUB 40015740 IF Z=-1.1E+12 THEN 1570015750 F1(I)=Z15760 IF F1(I)<0.1 OR F1(I)>10 THEN 1570015770 PRINT "			   ";15780 INPUT Z$15790 IF Z$="" THEN 1584015800 GOSUB 40015810 IF Z=-1.1E+12 THEN 1570015820 F2(I)=Z15830 IF F2(I)<0.1 OR F2(I)>10 THEN 1570015840 NEXT I15850 RETURN
1 GO TO 5
3 DELETE 1,15
5 DELETE 1
7 PRINT "ENTER YOUR FUNCTION AS A SUBROUTINE STARTING AT LINE #1100."
9 PRINT "A SAMPLE FUNCTION IS PROVIDED:J_J_"
11 LIST 1100,1180
13 PRINT "J_J_"
15 END 
100 REM 
110 REM  ***********************************************************
120 REM  SAMPLE DRIVER FOR CLENSHAW-CURTIS QUADRATURE 
130 PAGE 
140 PRINT 
150 PRINT "ENTER A,B = ";
160 INPUT A,B
170 PRINT 
180 PRINT "ENTER # DIGITS ACCURACY = ";
190 INPUT E
200 E=10^-E
210 PRINT 
220 PRINT "ENTER MAX. # OF TIMES FUNCTION CAN BE EVALUATED = ";
230 INPUT N
240 DELETE C
250 DIM C(N)
260 GOSUB 1500
270 PRINT 
280 PRINT "INTEGRAL = ";I
290 PRINT "		 WITH AN ERROR = ";E0
300 PRINT "		 ";N0;" FUNCTION EVALUATIONS REQUIRED"
310 PRINT "J_J_"
320 GO TO 140
330 REM  END OF SAMPLE DRIVER 
340 REM  ********************************************************** 
350 REM 
1100 REM
1110 REM **********************************************************
1120 REM  SAMPLE OF A FUNCTION TO BE INTEGRATED.  THE USER 
1130 REM   MUST PROGRAM HIS OWN FUNCTION.  FOR EXAMPLE:
1140 Y=3*X*X
1150 RETURN 
1160 REM  END OF SAMPLE FUNCTION 
1170 REM **********************************************************
1180 REM 
1190 REM **********************************************************
1200 REM                CLENSHAW CURTIS QUADRATURE
1210 REM        REF:  GENTLEMAN, W.MORVEN  ALGORITHM 424,CACM 
1220 REM
1230 REM   PARAMETERS:
1240 REM           A - LOWER BOUND OF INTERVAL (INPUT)
1250 REM           B - UPPER BOUND OF INTERVAL (INPUT)
1260 REM           E - TOLERATED RELATIVE ERROR (INPUT) 
1270 REM           N - THE MAXIMUM # OF TIMES THE FUNCTION WILL BE
1280 REM               EVALUATED MUST BE <= 39,367;(MAX. VALUE OF 
1290 REM               ARRAY 'C' (INPUT). 
1300 REM           I - VALUE OF INTEGRAL (OUTPUT) 
1310 REM           E0- ESTIMATED ABSOLUTE ERROR (OUTPUT). 
1320 REM           C - COSINE TRANSFORM ARRAY (OUTPUT).  ON INPUT IT
1330 REM               MUST BE AN ARRAY OF LENGTH AT LEAST N.
1340 REM           N0- ACTUAL # TIMES THE FUNCTION WAS EVALUATED. 
1350 REM           GOSUB  1100 - LOCATION OF USER SUPPLIED
1360 REM             ROUTINE WHICH EVALUATES THE FUNCTION BEING
1370 REM             INTEGRATED. Y=FUNC(X).  X MUST NOT BE CHANGED.
1500 DIM P(22)
1510 DIM Q(25)
1520 IF N=>7 THEN 1550
1530 PRINT "J_ERROR:  N MUST BE AT LEAST 7."
1540 END 
1550 Q(6)=1.73205080757
1560 Q8=8
1570 Q(8)=PI
1580 Q0=0.5*(A+B)
1590 Q1=0.5*(B-A)
1600 IF N<2*3^(Q8+1) THEN 1630
1610 Q(25)=2*3^(Q8+1)
1620 GO TO 1640
1630 Q(25)=N
1640 FOR P1=1 TO Q8
1650 P(P1)=1
1660 NEXT P1
1670 Q(24)=6
1680 X=A
1690 GOSUB 1100
1700 C(1)=Y
1710 X=B
1720 GOSUB 1100
1730 C(7)=Y
1740 P9=0.5*Q1*Q(6)
1750 X=Q0-P9
1760 GOSUB 1100
1770 C(2)=Y
1780 X=Q0+P9
1790 GOSUB 1100
1800 C(6)=Y
1810 P9=0.5*Q1
1820 X=Q0-P9
1830 GOSUB 1100
1840 C(3)=Y
1850 X=Q0+P9
1860 GOSUB 1100
1870 C(5)=Y
1880 X=Q0
1890 GOSUB 1100
1900 C(4)=Y
1910 Q(7)=C(1)+C(7)
1920 Q3=C(1)-C(7)
1930 Q4=2*C(4)
1940 Q5=C(2)+C(6)
1950 Q6=(C(2)-C(6))*Q(6)
1960 Q7=C(3)+C(5)
1970 Q(18)=C(3)-C(5)
1980 Q(19)=Q(7)+2*Q7
1990 Q(20)=2*Q5+Q4
2000 Q(21)=Q3+Q(18)
2010 Q(22)=Q(7)-Q7
2020 Q(23)=Q5-Q4
2030 C(1)=Q(19)+Q(20)
2040 C(2)=Q(21)+Q6
2050 C(3)=Q(22)+Q(23)
2060 C(4)=Q3-2*Q(18)
2070 C(5)=Q(22)-Q(23)
2080 C(6)=Q(21)-Q6
2090 C(7)=Q(19)-Q(20)
2100 N0=7
2110 GO TO 3460
2120 FOR P1=2 TO Q8
2130 P(P1-1)=P(P1)
2140 NEXT P1
2150 P(Q8)=3*P(Q8-1)
2160 P1=N0
2170 P8=Q(8)/(3*Q(24))
2180 FOR Q2=1 TO P(1)
2190 FOR P0=Q2 TO P(2) STEP P(1)
2200 FOR Q9=P0 TO P(3) STEP P(2)
2210 FOR P2=Q9 TO P(4) STEP P(3)
2220 FOR P3=P2 TO P(5) STEP P(4)
2230 FOR P4=P3 TO P(6) STEP P(5)
2240 FOR P5=P4 TO P(7) STEP P(6)
2250 FOR P6=P5 TO P(8) STEP P(7)
2260 P7=P8*(3*P6-2)
2270 P9=Q1*COS(P7)
2280 X=Q0-P9
2290 GOSUB 1100
2300 Q(7)=Y
2310 X=Q0+P9
2320 GOSUB 1100
2330 Q4=Y
2340 P9=Q1*SIN(P7)
2350 X=Q0+P9
2360 GOSUB 1100
2370 Q3=Y
2380 X=Q0-P9
2390 GOSUB 1100
2400 Q5=Y
2410 Q6=Q(7)+Q4
2420 Q7=Q3+Q5
2430 C(P1+1)=Q6+Q7
2440 C(P1+2)=Q(7)-Q4
2450 C(P1+3)=Q6-Q7
2460 C(P1+4)=Q3-Q5
2470 P1=P1+4
2480 NEXT P6
2490 NEXT P5
2500 NEXT P4
2510 NEXT P3
2520 NEXT P2
2530 NEXT Q9
2540 NEXT P0
2550 NEXT Q2
2560 P(9)=2*Q(24)
2570 P(10)=4
2580 Q2=N0+P(10)
2590 P0=N0+2*P(10)
2600 Q(10)=0.866025403784
2610 Q(7)=INT(0.5*(P(10)-1))
2620 P(17)=P(10)*3
2630 Q(4)=6.28318530718/P(17)
2640 FOR P6=1 TO P(9) STEP P(17)
2650 P(20)=C(Q2+P6)+C(P0+P6)
2660 Q(9)=(C(Q2+P6)-C(P0+P6))*Q(10)
2670 C(Q2+P6)=C(N0+P6)-0.5*P(20)
2680 C(P0+P6)=Q(9)
2690 C(N0+P6)=C(N0+P6)+P(20)
2700 NEXT P6
2710 P1=INT(P(10)/2+1)
2720 FOR P6=P1 TO P(9) STEP P(17)
2730 P(20)=(C(Q2+P6)+C(P0+P6))*Q(10)
2740 Q(9)=C(Q2+P6)-C(P0+P6)
2750 C(Q2+P6)=C(N0+P6)-Q(9)
2760 C(P0+P6)=P(20)
2770 C(N0+P6)=C(N0+P6)+0.5*Q(9)
2780 NEXT P6
2790 FOR P1=1 TO Q(7)
2800 Q(12)=P1+1
2810 Q(13)=P(10)-P1+1
2820 Q(14)=Q(4)*P1
2830 Q(15)=COS(Q(14))
2840 Q(16)=SIN(Q(14))
2850 Q(17)=Q(15)^2-Q(16)^2
2860 Q(18)=2*Q(16)*Q(15)
2870 FOR P5=Q(12) TO P(9) STEP P(17)
2880 P6=P5-Q(12)+Q(13)
2890 Q(20)=C(N0+P5)
2900 Q(21)=C(N0+P6)
2910 Q(22)=Q(15)*C(Q2+P5)-Q(16)*C(Q2+P6)
2920 Q(23)=Q(16)*C(Q2+P5)+Q(15)*C(Q2+P6)
2930 Q6=Q(17)*C(P0+P5)-Q(18)*C(P0+P6)
2940 Q5=Q(18)*C(P0+P5)+Q(17)*C(P0+P6)
2950 P(20)=Q(22)+Q6
2960 Q(9)=(Q(22)-Q6)*Q(10)
2970 P(22)=Q(20)-0.5*P(20)
2980 P4=Q(23)+Q5
2990 P3=(Q(23)-Q5)*Q(10)
3000 P2=Q(21)-0.5*P4
3010 C(N0+P5)=Q(20)+P(20)
3020 C(N0+P6)=P(22)+P3
3030 C(Q2+P5)=P(22)-P3
3040 C(Q2+P6)=Q(9)+P2
3050 C(P0+P5)=Q(9)-P2
3060 C(P0+P6)=Q(21)+P4
3070 NEXT P5
3080 NEXT P1
3090 P(10)=3*P(10)
3100 IF P(10)<Q(24) THEN 2580
3110 Q(7)=C(1)
3120 Q3=C(N0+1)
3130 C(1)=Q(7)+2*Q3
3140 C(N0+1)=Q(7)-Q3
3150 Q(7)=C(Q(24)+1)
3160 Q3=C(P(9)+2)
3170 C(Q(24)+1)=Q(7)+Q3
3180 C(P(9)+2)=Q(7)-2*Q3
3190 P(11)=3*Q(24)
3200 P(12)=Q(24)-1
3210 FOR P1=1 TO P(12)
3220 Q2=Q(24)+P1
3230 P0=P(11)-P1
3240 P7=P8*P1
3250 Q(1)=COS(P7)
3260 Q(3)=SIN(P7)
3270 Q(7)=Q(1)*C(Q2+2)-Q(3)*C(P0+2)
3280 Q3=(Q(3)*C(Q2+2)+Q(1)*C(P0+2))*Q(6)
3290 C(Q2+2)=C(P1+1)-Q(7)-Q3
3300 C(P0+2)=C(P1+1)-Q(7)+Q3
3310 C(P1+1)=C(P1+1)+2*Q(7)
3320 NEXT P1
3330 Q(7)=C(P(9)+1)
3340 Q3=C(P(9)+2)
3350 FOR P1=1 TO P(12)
3360 Q2=N0+P1
3370 P0=P(9)+P1
3380 C(P0)=C(Q2)
3390 C(Q2)=C(P0+2)
3400 NEXT P1
3410 C(P(11))=Q(7)
3420 C(P(11)+1)=Q3
3430 Q(24)=P(11)
3440 N0=Q(24)+1
3450 GO TO 3470
3460 P(13)=(Q(7)+2*Q4)/3
3470 P(14)=Q(24)-3
3480 P(15)=0.5*C(N0)/(1-Q(24)^2)
3490 FOR P1=1 TO P(14) STEP 2
3500 P6=Q(24)-P1
3510 P(15)=P(15)+C(P6)/(P6*(2-P6))
3520 NEXT P1
3530 P(15)=P(15)+0.5*C(1)
3540 E0=ABS(P(13)*3-P(15))
3550 IF ABS(P(15))*E=>E0 THEN 3590
3560 P(13)=P(15)
3570 IF 3*Q(24)+1<=Q(25) THEN 2120
3580 PRINT "J_";N;" IS TOO SMALL FOR DESIRED ACCURACY TO BE ACHIEVED."
3590 I=Q1*P(15)/INT(Q(24)/2)
3600 E0=Q1*E0/INT(Q(24)/2)
3610 RETURN 
3620 REM  END OF CLENSHAW-CURTIS QUADRATURE
3630 REM  ********************************************************
3640 REM 




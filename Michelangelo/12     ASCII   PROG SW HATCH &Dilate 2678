100 INIT110 WINDOW 0,130,1,100105 SET DEGREES120 PRINT "ENTER # OF SIDES IN POLYGON: ";130 INPUT N140 PRINT "ENTER ANGLE OF SHADING LINES: ";150 INPUT A152 PRINT "CROSSHATCH LINES (Y OR N): ";154 INPUT C$156 C=0157 IF C$<>"Y" AND C$<>"y" THEN 160158 C=1160 PRINT "ENTER SHADING LINE DENSITY IN GDUS': ";170 INPUT D180 PRINT "ENTER GIN DEVICE # (1)=PLOTTER OR (2)=MANUAL: ";190 INPUT Z200 rem PRINT "ENTER OUTPUT DEVICE #: ";210 rem INPUT Z1212 Z1=32214 X0=0216 Y0=0220 DIM P(4,N),W(2,N+1),X(2),P1(2)230 GO TO Z OF 1000, 1100240 GO TO 200250 S=1.0E+307260 L=-1.0E+307270 S1=SIN(A)280 C1=COS(A)290 FOR I=1 TO N300 W(1,I)=P(1,I)*C1+P(2,I)*S1310 W(2,I)=-P(1,I)*S1+P(2,I)*C1320 S=S MIN W(2,I)330 L=L MAX W(2,I)340 NEXT I350 W(1,N+1)=W(1,1)360 W(2,N+1)=W(2,1)370 Y2=S+0.5*D380 IF Y2>L THEN 1085390 K=0400 FOR I=1 TO N410 W1=W(2,I) MIN W(2,I+1)420 IF Y2<W1 THEN 540430 W2=W(2,I) MAX W(2,I+1)440 IF Y2=>W2 THEN 540450 X1=W(1,I)-(W(2,I)-Y2)*(W(1,I)-W(1,I+1))/(W(2,I)-W(2,I+1))460 K=K+1470 J=K480 IF J=1 THEN 530490 IF X(J-1)=>X1 THEN 530500 X(J)=X(J-1)510 J=J-1520 GO TO 480530 X(J)=X1540 NEXT I550 FOR I=1 TO K560 P1(1)=X(I)*C1-Y2*S1570 P1(2)=X(I)*S1+Y2*C1580 IF 2*INT(0.5*I)-I>-0.1 THEN 610590 MOVE @Z1:P1(1),P1(2)600 GO TO 620610 DRAW @Z1:P1(1),P1(2)620 NEXT I630 Y2=Y2+D640 GO TO 3801000 REM 4662 AS GIN DEVICE1010 FOR I=1 TO N1020 INPUT @1,27:P(1,I),P(2,I)1030 IF I=1 THEN 10501040 MOVE @Z:P(1,I-1),P(2,I-1)1050 DRAW @Z:P(1,I),P(2,I)1060 NEXT I1070 DRAW @Z:P(1,I),P(2,I)1080 GO TO 2501085 IF C=0 THEN 10901086 C=01087 A=A+901088 GO TO 2501089 REM show the Centroid with "o"1090 FOR I=1 TO N1091 X0=X0+P(1,I)1092 Y0=Y0+P(2,I)1093 NEXT I1094 X0=X0/N1095 Y0=Y0/N1096 MOVE X0,Y01097 PRINT "o"1098 HOME1099 GO TO 20001100 REM JOYSTICK AS GIN DEVICE (changed to manual input for emulator)1106 PRINT "MANUALLY INPUT X,Y FOR EACH OF ";N;" POINTS" 1110 FOR I=1 TO N1120 rem POINTER P(1,I),P(2,I),P$1122 INPUT P(1,I),P(2,I)1124 NEXT I1126 PAGE1128 FOR I=1 TO N1130 IF I=1 THEN 11901140 MOVE @Z1:P(1,I-1),P(2,I-1)1150 DRAW @Z1:P(1,I),P(2,I)1160 NEXT I1170 DRAW @Z1:P(1,1),P(2,1)1180 GO TO 2501190 MOVE @Z1:P(1,1),P(2,1)1200 GO TO 11602000 REM use centroid to dilate 110% larger outer polygon2010 REM subtract centroid X0,Y0 from each vertex POINT X(I),Y(I)2020 REM then multiply each POINT X,Y by 1.1 and add X0,Y02030 FOR I=1 TO N2040 P(3,I)=(P(1,I)-X0)*1.1+X0*0.92050 P(4,I)=(P(2,I)-Y0)*1.1+Y0*0.92060 NEXT I2110 MOVE P(3,1),P(4,1)2120 REM now draw larger polygon2130 FOR I=2 TO N2140 DRAW P(3,I),P(4,I)2150 NEXT I2155 DRAW P(3,1),P(4,1)2160 HOME2170 END
1 ON SRQ THEN 47002 GO TO 1004 REM*** FK1 RESTART ***5 GOSUB 1006 END 8 REM*** FK2 ACQUIRE WAVEFORMS FORM 468 ***9 GOSUB 490010 GOSUB 120011 RETURN 12 REM*** FK3 ACQUIRE WAVEFORMS FROM TAPE ***13 GOSUB 380014 RETURN 16 REM*** FK4 SAVE WAVEFORMS TO TAPE ***17 GOSUB 420018 RETURN 20 REM*** FK5 REDISPLAY WAVEFORMS ***21 GOSUB 490022 GOSUB 160023 RETURN 24 REM*** FK6 CURSORS ON ***25 GOSUB 510026 GOSUB 1210027 RETURN 28 REM*** FK7 X VS Y DISPLAY UNCAL'D ***29 GOSUB 1180030 RETURN 32 REM *** FK8 MIN/MAX PULSE PARAMETERS ***33 GOSUB 510034 GOSUB 570035 RETURN 36 REM*** FK9 HISTOGRAM OF PULSE PARAMETERS ***37 GOSUB 510038 GOSUB 660039 RETURN 40 REM*** FK10 INTEGRATE WAVEFORM ***41 GOSUB 510042 GOSUB 790043 RETURN 44 REM*** FK11 CURSOR 1 LEFT ***45 Z9=Z9-1 MAX 146 RETURN 48 REM*** FK12 CURSOR 1 RIGHT ***49 Z9=Z9+1 MIN (Z8 MIN 500*(B>499)+250*(B<300))-150 RETURN 56 REM*** FK14 CURSOR 2 LEFT ***57 Z8=Z8-1 MAX (Z9 MAX 1)+158 RETURN 60 REM*** FK15 CURSOR 2 RIGHT ***61 Z8=Z8+1 MIN 500*(B>499)+250*(B<300)62 RETURN 64 REM*** FK16 FIX CURSORS, PRINT RESULTS, AND CURSORS OFF ***65 Z7=066 RETURN 68 REM*** FK17 RMS OF WAVEFORM & PERIOD & RMS OF 1 PERIOD ***69 GOSUB 510070 GOSUB 1000071 RETURN 72 REM*** FK18 MULTIPLY CH1*CH2 STORE RESULTS IN ADD CHANNEL ***73 GOSUB 1080074 RETURN 76 REM*** FK19 FFT OF WAVEFORM ***77 GOSUB 510078 GOSUB 920079 RETURN 80 REM*** FK20 DIFFERENTIATE WAVEFORM ***81 GOSUB 510082 GOSUB 840083 RETURN 100 REM*** INITIALIZATION ***110 INIT 120 ON SRQ THEN 4700130 REM*** SET ALTERNATE EOL TO <%> (ASCII 37) ***140 PRINT @37,0:37,255,255150 DIM A$(175),C$(20),E$(20),D$(20),K$(9),L$(10),M$(5),N$(5)160 DIM O$(9),P$(9),Q$(9),R$(5),S$(5),T$(10),X$(10),Y$(10),Z$(10)170 REM*** SET VALUES FOR X AXIS DATA POINTS ***180 DATA 1,0190 REM*** J4=IS GRID DRAWN? ***200 READ J4,J6210 PRINT "
ENTER GPIB ADDRESS OF 468 (1-30) ";220 INPUT C$230 C$=C$&"A-1"240 J5=INT(VAL(C$))250 IF J5<1 OR J5>30 THEN 210260 PRINT "
IS SIGNAL PROCESSING ROM#1 INSTALLED? (YES OR NO) ";270 INPUT C$280 IF LEN(C$)=0 OR POS("YESNO",C$,1)=0 THEN 260290 IF POS("YES",C$,1)>0 THEN 330300 PRINT "
THIS PROGRAM REQUIRES SIGNAL PROCESSING ROM#1 TO EXECUTE"310 PRINT "         USE ANOTHER PROGRAM. GOODBY!"320 END 330 PRINT "
IS SIGNAL PROCESSING ROM#2 INSTALLED? (YES OR NO) ";340 INPUT C$350 IF LEN(C$)=0 OR POS("YESNO",C$,1)=0 THEN 330360 IF POS("YES",C$,1)>0 THEN 390370 PRINT "
THIS PROGRAM REQUIRES SIGNAL PROCESSING ROM#2 TO EXECUTE"380 GO TO 310390 PRINT "
POWER ON 468 OR CYCLE POWER AT THIS TIME!"400 WAIT 410 PRINT "PRESS /RETURN/ TO START WAVEFORM ACQUISTION ";420 INPUT C$430 J4=1440 PAGE 500 REM*** CALL TO SUBROUTINE TO ACQUIRE DATA ***510 GOSUB 1200520 REM*** SET EOL TO <CR> (ASCII 13) ***530 PRINT @37,26:0540 HOME 550 RETURN 600 REM*** SUBROUTINE TO DRAW SCOPE SCREEN ***610 REM** DASH LINES REPRESENT DIGITIZED DATA AREA NOT ON 468 SCREEN *620 REM*** DIGITIZED AREA IS 10.24cm IN BOTH HORZ. & VERT. ***630 WINDOW 1,500,0,255640 VIEWPORT 30,100,0,70650 FOR I=0 TO 10660 FOR J=7 TO 23 STEP 4670 MOVE 50*I+(I=0),J680 DRAW 50*I+(I=0),J690 NEXT J700 MOVE 50*I+(I=0),27710 DRAW 50*I+(I=0),227720 FOR J=231 TO 247 STEP 4730 MOVE 50*I+(I=0),J740 DRAW 50*I+(I=0),J750 NEXT J760 NEXT I770 FOR I=1 TO 500 STEP 6780 MOVE I,3790 DRAW I,3800 NEXT I810 FOR I=1 TO 500 STEP 6820 MOVE I,64.5830 DRAW I,64.5840 NEXT I850 FOR I=1 TO 500 STEP 6860 MOVE I,189.5870 DRAW I,189.5880 NEXT I890 FOR I=1 TO 500 STEP 6900 MOVE I,252910 DRAW I,252920 NEXT I930 FOR I=1 TO 9940 MOVE 1,25*I+2950 DRAW 500,25*I+2960 NEXT I970 VIEWPORT 30,100,7.5,62.3980 AXIS 10,6.4,250,127990 VIEWPORT 30,100,0,701000 MOVE 0,1861010 PRINT "100%"1020 MOVE 0,173.21030 PRINT "90%"1040 MOVE 0,73.31050 PRINT "10%"1060 MOVE 0,60.51070 PRINT "0%"1080 J4=01090 HOME 1100 PRINT "


 COUPLING"1110 PRINT " TIME/DIV"1120 PRINT " VOLTS/DIV"1130 PRINT " TRIGGER PT."1140 PRINT " MAX VOLTS"1150 PRINT " MIN VOLTS"1160 RETURN 1200 REM*** SUBROUTINE TO ACQUIRE DATA ***1210 SET NOKEY 1220 E$=""1230 DELETE Y,Y1,Y2,Y3,X$,Y$,Z$1240 Q1=MEMORY1250 DATA " "," "," ","",01260 RESTORE 12501270 READ X$,Y$,Z$,A$,J61280 REM*** SET EOL TO <CR><B> ASCII(13,10) ***1290 PRINT @37,26:11300 REM*** UNTALK,UNLISTEN BUS, AND ISSUE DEVICE CLEAR ***1310 WBYTE @95,63,20:1320 REM*** ASSIGN 468 AS TALKER ***1330 WBYTE @64+J5:1340 REM*** GET HEADER USING ALTERNATE DELIMITER OF <%> ***1350 INPUT %J5:A$1360 REM*** CHECK TO MAKE SURE HEADER WAS RECEIVED ***1370 P=POS(A$,"WFID:",5)1380 IF P=0 THEN 13301390 REM*** FIND OUT WHICH CHANNEL DATA WAS FOR ***1400 D$=SEG(A$,P,10)1410 D$=D$&"A3"1420 D$=STR(VAL(D$))1430 REM*** CHECK IF CHANNEL HAS ALREADY BEEN CAPTURED ***1440 IF POS(E$,D$,1)=0 THEN 14601450 GO TO 16001460 E$=E$&D$1470 PRINT @37,26:01480 REM*** DETERMINE NUMBER OF POINTS IN WAVEFORM ***1490 P=POS(A$,"NR.PT:",15)1500 C$=SEG(A$,P+5,5)1510 B=VAL(C$)1520 DELETE Y1530 DIM Y(B)1540 REM*** CAPTURE WAVEFORM ***1550 WBYTE @64+J5:1560 RBYTE H1,H1,Y,C1,H11570 REM*** SAVE DATA ***1580 GOSUB VAL(D$) OF 1900,2000,21001590 GO TO 13201600 REM*** GOSUB TO DRAW WAVEFORMS ***1610 WBYTE @95,63,20:1620 GOSUB LEN(X$)>5 OF 22001630 GOSUB LEN(Y$)>5 OF 24001640 GOSUB LEN(Z$)>5 OF 26001650 SET KEY 1660 RETURN 1700 REM*** SUBROUTINE TO DRAW ACQUIRED WAVEFORM ***1710 GOSUB J4 OF 6001720 WINDOW 1,500,0,2551730 IF B=512 THEN 17501740 WINDOW 1,250,0,2551750 VIEWPORT 30,100,0,701760 CALL "DISP",Y1770 RETURN 1800 REM*** SUBROUTINE TO DRAW SAVED WAVEFORM ***1810 GOSUB J4 OF 6001820 WINDOW 1,500,0,2551830 IF B=512 THEN 18501840 WINDOW 1,250,0,2551850 VIEWPORT 30,100,0,701860 CALL "DISP",Y1870 RETURN 1900 REM*** SUBROUTINE TO SAVE CHANNEL 1 DATA ***1910 DELETE X$,Y11920 Q1=MEMORY1930 DIM Y1(B),X$(LEN(A$)+5)1940 B1=B1950 Y1=Y1960 X$=A$1970 RETURN 2000 REM*** SUBROUTINE TO SAVE CHANNEL 2 DATA ***2010 DELETE Y$,Y22020 Q1=MEMORY2030 DIM Y2(B),Y$(LEN(A$)+5)2040 B2=B2050 Y2=Y2060 Y$=A$2070 RETURN 2100 REM*** SUBROUTINE TO SAVE ADD DATA ***2110 DELETE Z$,Y32120 Q1=MEMORY2130 DIM Y3(B),Z$(LEN(A$)+5)2140 B3=B2150 Y3=Y2160 Z$=A$2170 RETURN 2200 REM*** SUBROUTINE TO DRAW & ANALYZE CHANNEL 1 DATA ***2210 DELETE Y,A$2220 Q1=MEMORY2230 DIM Y(B1),A$(LEN(X$)+5)2240 Y=Y12250 B=B12260 A$=X$2270 GOSUB J6 OF 18002280 GOSUB NOT(J6) OF 17002290 GOSUB 28002300 HOME 2310 PRINT USING "16X,27A":"CHANNEL 1_________"2320 IF J6=1 THEN 23502330 PRINT USING "12X,8A":"ACQUIRED"2340 GO TO 23602350 PRINT USING "22X,9A":"FROM TAPE"2360 U$=SEG(F$,1,13+(J6=1)*10)2370 GOSUB 35002380 RETURN 2400 REM*** SUBROUTINE TO DRAW & ANALYZE CHANNEL 2 DATA ***2410 DELETE Y,A$2420 Q1=MEMORY2430 DIM Y(B2),A$(LEN(Y$)+5)2440 Y=Y22450 B=B22460 A$=Y$2470 GOSUB J6 OF 18002480 GOSUB NOT(J6) OF 17002490 GOSUB 28002500 HOME 2510 PRINT USING "36X,27A":"CHANNEL 2_________"2520 IF J6=1 THEN 25502530 PRINT USING "32X,8A":"ACQUIRED"2540 GO TO 25602550 PRINT USING "42X,9A":"FROM TAPE"2560 U$=SEG(F$,1,33+(J6=1)*10)2570 GOSUB 35002580 RETURN 2600 REM*** SUBROUTINE TO DRAW & ANALYZE CHANNEL ADD DATA ***2610 DELETE Y,A$2620 Q1=MEMORY2630 DIM Y(B3),A$(LEN(Z$)+5)2640 Y=Y32650 B=B32660 A$=Z$2670 GOSUB J6 OF 18002680 GOSUB NOT(J6) OF 17002690 GOSUB 28002700 HOME 2710 PRINT USING "56X,36A":"ADD CHANNELS____________"2720 IF J6=1 THEN 27502730 PRINT USING "52X,8A":"ACQUIRED"2740 GO TO 27602750 PRINT USING "62X,9A":"FROM TAPE"2760 U$=SEG(F$,1,53+(J6=1)*10)2770 GOSUB 35002780 RETURN 2800 REM*** SUBROUTINE TO ANALYZE HEADER INFORMATION ***2810 WINDOW 0,130,0,1002820 VIEWPORT 0,130,0,1002830 F$="                                                             "2840 F$=F$&"     "2850 REM*** DETERMINE COUPLING ***2860 P=POS(A$,"WFID:",5)2870 K$=SEG(A$,P+10,3)2880 IF POS(K$,"""",1)=0 THEN 29002890 K$=SEG(K$,1,2)2900 REM*** DETERMINE X-INCREMENT ***2910 P=POS(A$,"XINCR:",30)2920 L$=SEG(A$,P+6,3)2930 IF POS(L$,",",1)=0 THEN 29602940 L$=SEG(L$,1,LEN(L$)-1)2950 GO TO 29302960 REM*** DETERMINE TRIGGER POINT ***2970 P=POS(A$,"PT.OFF:",45)2980 M$=SEG(A$,P+7,3)2990 IF POS(M$,",",1)=0 THEN 30103000 M$=SEG(M$,1,2)3010 REM*** DETERMINE X-UNITS ***3020 P=POS(A$,"XUNIT:",50)3030 N$=SEG(A$,P+6,2)3040 IF POS(N$,",",1)=0 THEN 30603050 N$=SEG(N$,1,1)3060 REM*** DETERMINE Y-MULIPLIER ***3070 P=POS(A$,"YMULT:",60)3080 O$=SEG(A$,P+6,6)3090 IF POS(O$,",",1)=0 THEN 31203100 O$=SEG(O$,1,LEN(O$)-1)3110 GO TO 30903120 REM*** DETERMINE GROUND REFERENCE ***3130 P=POS(A$,"YOFF:",70)3140 P$=SEG(A$,P+5,9)3150 IF POS(P$,",",1)=0 THEN 31803160 P$=SEG(P$,1,LEN(P$)-1)3170 GO TO 31503180 REM*** DETERMINE Y-UNITS ***3190 P=POS(A$,"YUNIT:",75)3200 Q$=SEG(A$,P+6,3)3210 IF POS(Q$,",",1)=0 THEN 32403220 Q$=SEG(Q$,1,LEN(Q$)-1)3230 GO TO 32103240 REM*** TIME/DIVISION ***3250 T1=(50*(B>500)+25*(B<300))*VAL(L$)3260 REM*** VOLTS/DIVISION ***3270 V1=25*VAL(O$)3280 REM*** TRIGGER TIME AFTER START OF SWEEP ***3290 T2=T1/(50*(B>500)+25*(B<300))*VAL(M$)3300 Y5=VAL(P$)3310 Y6=VAL(O$)3320 REM*** FIND MIN & MAX VOLTAGE LEVELS OF DISPLAYED WAVEFORMS ***3330 DIM Y(500*(B>500)+250*(B<300))3340 CALL "MIN",Y,V2,I13350 CALL "MAX",Y,V3,I33360 V2=Y6*(V2-Y5)3370 V3=Y6*(V3-Y5)3380 DIM Y(B)3390 RETURN 3400 REM*** CHANGE TIME REFERENCE ***3410 P=POS(" SMSUSNS",N$,1)3420 R$=SEG("SMSUSNS",P-2,2)3430 RETURN 3450 REM*** CHANGE VOLTAGE REFERENCE ***3460 P=POS(" VMVUVDIV",Q$,1)3470 S$=SEG("VMVUVDIV",P-2,2)3480 RETURN 3500 REM*** PRINT HEADER INFORMATION ***3510 PRINT "
";U$;K$3520 R$=N$3530 IF T1<1000 THEN 35603540 T1=T1/10003550 GOSUB 34003560 PRINT USING "FA,FD.2D,A,FA":U$;T1;" ";R$3570 S$=Q$3580 IF V1<1000 THEN 36203590 V1=V1/10003600 GOSUB 34503610 GO TO 35803620 PRINT USING "FA,FD.2D,A,FA":U$;V1;" ";S$3630 R$=N$3640 IF T2<1000 THEN 36703650 T2=T2/10003660 GOSUB 34003670 PRINT USING "FA,FD.2D,A,FA":U$;T2;" ";R$3680 S$=Q$3690 IF ABS(V3)<1000 THEN 37203700 V3=V3/10003710 GOSUB 34503720 PRINT USING "FA,FD.3D,A,FA":U$;V3;" ";S$3730 S$=Q$3740 IF ABS(V2)<1000 THEN 37703750 V2=V2/10003760 GOSUB 34503770 PRINT USING "FA,FD.3D,A,FA":U$;V2;" ";S$3780 RETURN 3800 REM*** SUBROUTINE TO ACQUIRE WAVEFORMS FROM TAPE ***3810 PRINT "

"3820 J4=13830 PRINT @37,26:03840 F1=43850 PRINT @33,0:0,0,13860 FIND F13870 INPUT @33:F$3880 PRINT @33,0:0,0,03890 IF POS(F$," LAST ",1)<>0 THEN 39703900 FIND F13910 F$="<EMPTY>"3920 IF TYP(0)<>4 THEN 39403930 READ @33:F$3940 PRINT "	";F1-3;")     ";F$3950 F1=F1+13960 GO TO 38503970 PRINT "
	ENTER NUMBER OF FILE WAVEFORMS ARE ON: ";3980 INPUT C$3990 C$=C$&"A-4"4000 F2=INT(VAL(C$)+3)4010 IF F2<4 OR F2>F1 THEN 39704020 FIND F24030 READ @33:F$4040 DELETE X$,Y$,Z$,Y1,Y2,Y34050 Q1=MEMORY4060 READ @33:A3,B14070 DIM X$(A3),Y1(B1)4080 READ @33:X$,Y14090 READ @33:A3,B24100 DIM Y$(A3),Y2(B2)4110 READ @33:Y$,Y24120 READ @33:A3,B34130 DIM Z$(A3),Y3(B3)4140 READ @33:Z$,Y34150 J6=14160 PAGE 4170 GOSUB 16004180 RETURN 4200 REM*** SUBROUTINE TO SAVE WAVEFORMS TO TAPE ***4210 PRINT "

"4220 J4=14230 PRINT @37,26:04240 PRINT @33,0:0,0,14250 F1=44260 FIND F14270 INPUT @33:F$4280 IF POS(F$," LAST ",1)<>0 THEN 43304290 F$=SEG(F$,6,40)4300 IF POS(F$," NEW ",1)<>0 AND VAL(F$)=>11000/256 THEN 43604310 F1=F1+14320 GO TO 42604330 PRINT @33,0:0,0,04340 FIND F14350 MARK 1,110004360 PRINT "

ENTER NAME YOU WISH TO STORE WAVEFORM UNDER"4370 INPUT F$4380 IF LEN(F$)=0 THEN 43604390 PRINT @33,0:0,0,04400 F$=SEG(F$,1,40)4410 FIND F14420 WRITE @33:F$4430 IF LEN(X$)>20 THEN 44804440 X$=" "4450 B1=14460 DIM Y1(1)4470 Y1=14480 A3=LEN(X$)+54490 WRITE @33:A3,B1,X$,Y14500 IF LEN(Y$)>20 THEN 45504510 Y$=" "4520 B2=14530 DIM Y2(1)4540 Y2=14550 A3=LEN(Y$)+54560 WRITE @33:A3,B2,Y$,Y24570 IF LEN(Z$)>20 THEN 46204580 Z$=" "4590 B3=14600 DIM Y3(1)4610 Y3=14620 A3=LEN(Z$)+54630 WRITE @33:A3,B3,Z$,Y34640 CLOSE @33:4650 RETURN 4700 REM*** 468 SRQ HANDLER ***4710 POLL A1,A2;J54720 IF A2<>65 THEN 47604730 PRINT "

	POWER ON SRQ COMPLETE"4740 J4=14750 RETURN 4760 IF A2<>195 THEN 47904770 REM*** TRANSMIT SRQ RETURN TO WHAT OPERATION IN PROCESS ***4780 RETURN 4790 IF A2<>196 THEN 48204800 REM*** TALK ONLY MODE TRANSMIT SRQ GO ACQUIRE DATA4810 GOSUB 12004820 RETURN 4900 REM*** SUBROUTINE TO ERASE SCREEN ***4910 J4=14920 PAGE 4930 RETURN 5000 REM*** KEEP SRQ ENABLED ***5010 SET KEY 5020 ON SRQ THEN 47005030 SET KEY 5040 WAIT 5050 GO TO 50005100 REM*** SUBROUTINE TO DETERMINE WHICH WAVEFORM TO ANALYZE ***5110 GOSUB 49005120 PRINT USING "L,26X,FA":"WAVEFORM ANALYSIS"5130 C$=""5140 IF LEN(X$)>5 OR LEN(Y$)>5 OR LEN(Z$)>5 THEN 51705150 GOSUB 85160 GO TO 51805170 CALL "WAIT",0.55180 IF LEN(X$)>5 AND LEN(Y$)<5 AND LEN(Z$)<5 THEN 54005190 IF LEN(Y$)>5 AND LEN(X$)<5 AND LEN(Z$)<5 THEN 55005200 IF LEN(Z$)>5 AND LEN(X$)<5 AND LEN(Y$)<5 THEN 56505210 PRINT "
WHICH WAVEFORM IS TO BE ANALYZED?"5220 IF LEN(X$)<5 THEN 52505230 PRINT USING "L,10X,FA":"1)  WAVEFORM CHANNEL 1"5240 C$=C$&"1"5250 IF LEN(Y$)<5 THEN 52805260 PRINT USING "L,10X,FA":"2)  WAVEFORM CHANNEL 2"5270 C$=C$&"2"5280 IF LEN(Z$)<5 THEN 53105290 PRINT USING "L,10X,FA":"3)  WAVEFORM ADD CHANNELS"5300 C$=C$&"3"5310 PRINT USING "L,15X,FA,S":"ENTER NUMBER: "5320 INPUT V$5330 IF LEN(V$)=0 OR POS(C$,V$,1)=0 THEN 53105340 V$=V$&"BAD-1"5350 IF VAL(V$)=1 THEN 54005360 IF VAL(V$)=2 THEN 55005370 IF VAL(V$)=3 THEN 56005380 GO TO 53105400 REM*** ANALYZE CHANNEL 1 WAVEFORM DATA ***5410 DELETE Y,A$5420 DIM Y(B1),A$(LEN(X$)+5)5430 Y=Y15440 B=B15450 A$=X$5460 RETURN 5500 REM*** ANALYZE CHANNEL 2 WAVEFORM DATA ***5510 DELETE Y,A$5520 DIM Y(B2),A$(LEN(Y$)+5)5530 Y=Y25540 B=B25550 A$=Y$5560 RETURN 5600 REM*** ANALYZE ADD CHANNELS WAVEFORM DATA ***5610 DELETE Y,A$5620 DIM Y(B3),A$(LEN(Z$)+5)5630 Y=Y35640 B=B35650 A$=Z$5660 RETURN 5700 REM*** SUBROUTINE FOR SIMPLE MIN/MAX PULSE PARAMETERS ***5710 SET NOKEY 5720 J9=295730 GOSUB 49005740 GOSUB 28005750 S$=Q$5760 Y=Y-Y55770 Y=Y*Y65780 IF V1<1000 THEN 58405790 V1=V1/10005800 Y=Y/10005810 GOSUB 34505820 V2=V2/10005830 V3=V3/10005840 IF T1<1000 THEN 58705850 T1=T1/10005860 GOSUB 34005870 VIEWPORT 16,120,50,905880 GOSUB 73005890 PRINT @32,21:34,955900 PRINT "PULSE PARAMETERS FROM MIN AND MAX";5910 GOSUB 59405920 SET KEY 5930 RETURN 5940 REM*** SUBROUTINE TO COMPUTE PULSE PARAMETERS 5950 REM INPUT: array Y, min V2, max V3, J (number of dashes)5960 REM OUTPUT: 10%,50%,90% levels (V4,V5,V6)5970 REM COMPUTE V4,V5 AND V6 ***5980 V4=0.1*(V3-V2)+V25990 V5=0.5*(V3-V2)+V26000 V6=0.9*(V3-V2)+V26010 REM*** COMPUTE VOLTAGE CROSSING POINTS ***6020 CALL "CROSS",Y,V4,T36030 CALL "CROSS",Y,V5,T46040 CALL "CROSS",Y,V6,T56050 CALL "CROSS",Y,V6,T7,26060 CALL "CROSS",Y,V5,T8,26070 CALL "CROSS",Y,V4,T9,26080 CALL "CROSS",Y,V5,T0,36090 REM*** DRAW DOTTED LINES AT VOLTAGE CROSSING POINTS ***6100 MOVE 1,V26110 GOSUB 64006120 MOVE 1,V36130 GOSUB 64006140 MOVE 1,V46150 GOSUB 64006160 MOVE 1,V56170 GOSUB 64006180 MOVE 1,V66190 GOSUB 64006200 PRINT @32,21:0,406210 PRINT USING "13T,""W A V E F O R M   P A R A M E T E R S"",L":6220 PRINT USING 6480:"  0%",V2,S$6230 PRINT USING 6480:" 10%",V4,S$6240 PRINT USING 6480:" 50%",V5,S$6250 PRINT USING 6480:" 90%",V6,S$6260 PRINT USING 6480:"100%",V3,S$6270 PRINT "";6280 PRINT USING 6460:"RISE TIME",(T5-T3)*S1,R$6290 IF T7<0 THEN 63906300 PRINT USING 6460:"90% WIDTH",(T7-T5)*S1,R$6310 IF T8<0 THEN 63906320 PRINT USING 6460:"50% WIDTH",(T8-T4)*S1,R$6330 IF T9<0 THEN 63906340 PRINT USING 6460:"10% WIDTH",(T9-T3)*S1,R$6350 PRINT USING 6460:"FALL TIME",(T9-T7)*S1,R$6360 IF T0<0 THEN 63906370 PRINT USING 6460:"PERIOD AT 50% WIDTH",(T0-T4)*S1,R$6380 PRINT USING 6470:"SYMMETRY AT 50% WIDTH",(T8-T4)/(T0-T4)*100,"%"6390 RETURN 6400 REM*** SUBROUTINE TO DRAW DASH LINES ***6410 FOR I=1 TO J96420 PRINT " _";6430 NEXT I6440 RETURN 6450 REM*** PRINT IMAGES ***6460 IMAGE 32T,23A,3E,X,3A6470 IMAGE 32T,24A,2D.2D,X,A6480 IMAGE 3T,4A," LEVEL:",5D.2D,X,FA6490 IMAGE 10T,12A,6E,"S"6500 IMAGE 4D.2D6510 END 6600 REM*** SUBROUTINE FOR HISTOGRAM PULSE PARAMETERS ***6610 SET NOKEY 6620 REM DIMENSION AND COMPUT HISTOGRAM6630 REM KEEP TWO HALVES TO FACILITATE FINDING BOTH PEAKS6640 DELETE V7,V86650 H1=MEMORY6660 REM*** IF NOT ENOUGH ROOM MUST DELETE A WAVEFORM ***6670 IF H1-(36+16*(B/2))>300 THEN 67006680 GOSUB 129006690 SET NOKEY 6700 DIM V7(B/2),V8(B/2)6710 GOSUB 49006720 GOSUB 28006730 S$=Q$6740 Y=Y-Y56750 Y=Y*Y66760 IF V1<1000 THEN 68006770 V1=V1/10006780 Y=Y/10006790 GOSUB 34506800 VIEWPORT 16,95,50,906810 GOSUB 73006820 HOME 6830 PRINT USING "19T,""
PULSE PARAMETERS BY HISTOGRAM METHOD""":6840 V7=06850 V8=06860 M3=B/(W2-W1)6870 FOR I9=1 TO 500*(B>500)+250*(B<300)6880 J=INT((Y(I9)-W1)*M3)+16890 IF J>B/2 THEN 69206900 V7(J MAX 1)=V7(J MAX 1)+16910 GO TO 69306920 V8(J-B/2)=V8(J-B/2)+16930 NEXT I96940 VIEWPORT 99,129,50,906950 V7=V7/Y66960 V7=V7+Y56970 V8=V8/Y66980 V8=V8+Y56990 CALL "MAX",V7,M4,M17000 CALL "MAX",V8,M5,M27010 M3=M4 MAX M57020 CALL "MIN",V8,M6,I97030 CALL "MIN",V8,M7,I97040 M6=M6 MIN M77050 WINDOW M6,M3,0,B7060 HOME 7070 PRINT USING "54T,""

HISTOGRAM""":7080 AXIS M3/5,64,M6,07090 MOVE V7(1),17100 FOR I9=1 TO B/27110 DRAW V7(I9),I97120 NEXT I97130 MOVE V8(1),B/27140 FOR I9=1 TO B/27150 DRAW V8(I9),I9+B/27160 NEXT I97170 DELETE V8,V77180 REM NOW RE-CONVERT M1&M2 (H INDEXES) TO 0% AND 100% LEVELS7190 M3=(B-1)/(W2-W1)7200 V2=(M1-1)/M3+W17210 V3=(M2+256-1)/M3+W17220 REM RESTORE PROPER WINDOW & VIEWPORT7230 WINDOW 1,B,W1,W27240 J9=227250 VIEWPORT 16,80,50,907260 GOSUB 59407270 SET KEY 7280 RETURN 7300 REM*** SUBROUTINE TO GRAPH WAVEFORM TO BE ANALYZED ***7310 IF T1<1000 THEN 73407320 T1=T1/10007330 GOSUB 34007340 S1=T1/B*10.247350 CALL "MIN",Y,W1,W37360 CALL "MAX",Y,W2,W37370 REM ROUND MIN TO 2 DIGITS7380 IF W1=0 THEN 74107390 W3=INT(LGT(ABS(W1)))7400 W1=INT(W1*10^(1-W3))*10^(W3-1)7410 REM COMPUTE MINIMUM POSSIBLE INTERVAL7420 W2=(W2-W1)/87430 IF W2<>0 THEN 74507440 W2=0.1397450 REM ROUND INTERVAL TO NEXT GREATER 2 SIG DIGITS7460 W3=10^(1-INT(LGT(W2)))7470 W2=INT(W2*W3+0.5)+17480 W2=W2/W37490 REM FINALLY, COMPUTE TOP OF GRAPH7500 W2=W1+8*W27510 WINDOW 1,500*(B>500)+250*(B<300),W1,W27520 AXIS (500*(B>500)+250*(B<300))/10,(W2-W1)/8,1,W17530 REM SET W3 AS VERTICAL LABLE SCALING7540 V$=""7550 W3=INT(LGT(ABS(W2)))7560 IF W3=0 THEN 75907570 V$=STR(10^W3)7580 V$=V$&" "7590 V$=V$&S$7600 MOVE 1,W27610 PRINT "";V$;7620 REM PRINT VERTICAL LABLES7630 FOR I=0 TO 87640 MOVE 1,(W2-W1)/8*I+W17650 PRINT USING """"",4D.2D":((W2-W1)/8*I+W1)/10^W3;7660 NEXT I7670 REM SET W3 TO HORIZONTAL LABLE SCALING7680 W3=INT(LGT(S1*(500*(B>500)+250*(B<300))))7690 V$=""7700 IF W3=0 THEN 77307710 V$=STR(10^W3)7720 V$=V$&" "7730 V$=V$&R$7740 MOVE B/2,W17750 PRINT "

";V$;7760 REM PRINT HORIZONTAL LABLES7770 B4=500*(B>500)+250*(B<300)7780 FOR I=0 TO 107790 MOVE I*(B4-1)/10+1,W17800 PRINT USING """
"",2D.D,S":I*(B4-1)/10*S1/10^W3;7810 NEXT I7820 DIM Y(500*(B>500)+250*(B<300))7830 CALL "DISP",Y7840 RETURN 7900 REM*** SUBROUTINE TO INTEGRATE WAVEFORM ***7910 SET NOKEY 7920 GOSUB 49007930 GOSUB 28007940 R$=N$7950 S$=Q$7960 Y=Y-Y57970 Y=Y*Y67980 IF V1<1000 THEN 80207990 V1=V1/10008000 Y=Y/10008010 GOSUB 34508020 IF T1<1000 THEN 80508030 T1=T1/10008040 GOSUB 34008050 VIEWPORT 16,120,55,908060 GOSUB 73008070 PRINT @32,21:50,958080 PRINT "ORIGINAL WAVEFORM"8090 VIEWPORT 16,120,10,458100 CALL "INT",Y,Y8110 IF S$<>"MV" THEN 81408120 Y=Y/10008130 S$="V"8140 IF S$<>"UV" THEN 81708150 Y=Y/10000008160 S$="V"8170 IF R$<>"NS" THEN 81908180 Y=Y*(T1/(50*(B>500)+25*(B<300))*1.0E-9)8190 IF R$<>"US" THEN 82108200 Y=Y*(T1/(50*(B>500)+25*(B<300))*1.0E-6)8210 IF R$<>"MS" THEN 82308220 Y=Y*(T1/(50*(B>500)+25*(B<300))*1.0E-3)8230 S$="VS"8240 GOSUB 73008250 PRINT @32,21:50,458260 PRINT "INTEGRATED WAVEFORM"8270 S$=Q$8280 SET KEY 8290 HOME 8300 RETURN 8400 REM*** SUBROUTINE TO DIFFERENTIATE WAVEFORM ***8410 SET NOKEY 8420 PRINT "

2-POINT OR 3-POINT DIFFERENTIATION? (ENTER 2 OR 3):";8430 INPUT T$8440 T$=T$&"BAD-1"8450 GOSUB 49008460 IF VAL(T$)<>2 AND VAL(T$)<>3 THEN 84208470 GOSUB 28008480 R$=N$8490 S$=Q$8500 Y=Y-Y58510 Y=Y*Y68520 IF V1<1000 THEN 85608530 V1=V1/10008540 Y=Y/10008550 GOSUB 34508560 IF T1<1000 THEN 85908570 T1=T1/10008580 GOSUB 34008590 VIEWPORT 16,120,55,908600 GOSUB 73008610 PRINT @32,21:53,908620 PRINT "ORIGINAL WAVEFORM"8630 VIEWPORT 16,120,10,458640 IF VAL(T$)<>2 THEN 86708650 CALL "DIF2",Y,Y8660 GO TO 86808670 CALL "DIF3",Y,Y8680 IF S$<>"MV" THEN 87108690 Y=Y/10008700 S$="V"8710 IF S$<>"UV" THEN 87308720 Y=Y/10000008730 S$="V"8740 IF R$<>"NS" THEN 87608750 Y=Y/(T1/(50*(B>500)+25*(B<300))*1.0E-9)8760 IF R$<>"US" THEN 87808770 Y=Y/(T1/(50*(B>500)+25*(B<300))*1.0E-6)8780 IF R$<>"MS" THEN 88008790 Y=Y/(T1/(50*(B>500)+25*(B<300))*1.0E-3)8800 S$="V/S"8810 GOSUB 73008820 PRINT @32,21:40,458830 PRINT "DIFFERENTIATED WAVEFORM ";VAL(T$);" POINT"8840 HOME 8850 S$=Q$8860 SET KEY 8870 RETURN 8900 REM*** SUBROUTINE TO APPLY COSINE WINDOW ***8910 SET NOKEY 8920 PRINT "
APPLY COSINE WINDOW? (Y OR N): ";8930 INPUT T$8940 IF LEN(T$)=0 OR POS("YESNO",T$,1)=0 THEN 89208950 IF POS("NO",T$,1)>0 THEN 91708960 GOSUB 28008970 IF T1<1000 THEN 90008980 T1=T1/10008990 GOSUB 34009000 PRINT "
ENTER PERCENT OF TAPER (0 TO 50): ";9010 INPUT T$9020 T$=T$&"BAD-1"9030 IF VAL(T$)<0 OR VAL(T$)>50 THEN 90009040 GOSUB 49009050 VIEWPORT 16,120,55,909060 GOSUB 73009070 PRINT @32,21:54,959080 PRINT "ORIGINAL WAVEFORM"9090 CALL "TAPER",Y,VAL(T$)/1009100 VIEWPORT 16,120,10,459110 GOSUB 73009120 PRINT @32,21:40,459130 PRINT "WAVEFORM WITH ";VAL(T$);"% COSINE TAPER"9135 DIM Y(B)9140 HOME 9150 CALL "WAIT",2.59160 SET KEY 9170 RETURN 9200 REM*** SUBROUTINE FOR FFT OF WAVEFORM ***9210 SET NOKEY 9220 DELETE Y7,Y8,Z1,H1,I39230 H1=MEMORY9240 IF H1-(36+16*(B/2+1))>300 THEN 92809250 REM*** NOT ENOUGH ROOM MUST DELETE A WAVEFORM ***9260 GOSUB 129009270 SET NOKEY 9280 GOSUB 28009290 S$=Q$9300 Y=Y-Y59310 Y=Y*Y69320 IF V1<1000 THEN 93609330 V1=V1/10009340 Y=Y/10009350 GOSUB 34509360 GOSUB 89009370 CALL "FFT",Y9380 DIM Y7(B/2+1),Y8(B/2+1)9390 CALL "POLAR",Y,Y7,Y89400 GOSUB 49009410 Y7=Y7/(B/2)9420 CALL "MAX",Y7,Z1,H19430 Z1=INT(Z1*100)/1009440 IF Z1<1000 THEN 94809450 Z1=Z1/10009460 Y7=Y7/10009470 GOSUB 34509480 IF T1<1000 THEN 95109490 T1=T1/10009500 GOSUB 34009510 Z3=09520 Z3=1.0E-9*(R$="NS")+1.0E-6*(R$="US")+1.0E-3*(R$="MS")9530 Z3=Z3*(T1/50*(B>500)+T1/25*(B<300))9540 Z3=1/Z3/29550 WINDOW 0,B/2+1,0,Z19560 VIEWPORT 16,120,55,959570 AXIS B/2/10,Z1/5,0,09580 CALL "DISP",Y79590 MOVE 0,Z19600 PRINT "";S$;9610 FOR I=0 TO Z1 STEP Z1/59620 MOVE 0,I9630 PRINT USING "FA,FD.2D":"";INT(I*100)/100;9640 NEXT I9650 FOR I=0 TO 1 STEP 0.19660 MOVE I*(B/2),09670 PRINT USING "FA,FD.2D":"
";I;9680 NEXT I9690 PRINT USING "30X,FD,X,FA":Z3,"Hz";9700 PRINT @32,21:50,959710 PRINT "FFT MAGNITUDE";9720 WINDOW 0,B/2+1,-PI,PI9730 VIEWPORT 16,120,10,459740 AXIS B/2/10,PI/2,0,-PI9750 CALL "DISP",Y89760 MOVE 0,PI9770 PRINT "RADIANS";9780 FOR I=0 TO 1 STEP 0.19790 MOVE I*(B/2),-PI9800 PRINT USING "FA,FD.2D":"
";I;9810 NEXT I9820 PRINT USING "30X,FD,X,FA":Z3;"Hz";9830 FOR I=-PI TO PI STEP PI/29840 MOVE 0,I9850 PRINT USING "FA,FD.3D":"";I9860 NEXT I9870 PRINT @32,21:50,459880 PRINT "FFT PHASE"9890 DELETE Y7,Y8,Z19900 Z3=MEMORY9910 HOME 9920 SET KEY 9930 RETURN 10000 REM*** SUBROUTINE FOR RMS OF WAVEFORM PERIOD & RMS OF PERIOD ***10010 SET NOKEY 10020 GOSUB 490010030 GOSUB 280010040 R$=N$10050 S$=Q$10060 Y=Y-Y510070 Y=Y*Y610080 IF V1<1000 THEN 1012010090 V1=V1/100010100 Y=Y/100010110 GOSUB 345010120 DIM Y(500*(B>500)+250*(B<300))10130 IF T1<1000 THEN 1016010140 T1=T1/100010150 GOSUB 340010160 VIEWPORT 16,120,55,9010170 GOSUB 730010180 PRINT @32,21:50,9510190 PRINT "ORIGINAL WAVEFORM"10200 PRINT @32,21:0,4010210 PRINT USING "13T,""W A V E F O R M  P A R A M E T E R S"",L":10220 DELETE Y8,V2,V3,V5,H1,Y9,Y7,Y910230 H1=MEMORY10240 IMAGE 3X,35A,A,3X,FD.4D,X,FA10250 Y9=500*(B>499)+250*(B<300)10260 Y7=010270 Y8=010280 FOR H1=1 TO Y910290 Y8=Y8+Y(H1)^210300 Y7=Y7+Y(H1)10310 NEXT H110320 PRINT USING 10240:"MEAN OF WAVEFORM (AC+DC)","=",Y7/Y9,S$10330 PRINT USING 10240:"RMS OF WAVEFORM (AC+DC)","=",(Y8/Y9)^0.5,S$10340 CALL "MIN",Y,V2,H110350 CALL "MAX",Y,V3,H110360 PRINT USING 10240:"MAX OF WAVEFORM","=",V3,S$10370 PRINT USING 10240:"MIN OF WAVEFORM","=",V2,S$10380 V5=0.5*(V3-V2)+V210390 CALL "CROSS",Y,V5,T5,110400 CALL "CROSS",Y,V5,T2,210410 CALL "CROSS",Y,V5,T3,310420 DELETE Y7,Y8,Y910430 H1=MEMORY10440 IF T3<0 THEN 1067010450 Y7=010460 Y9=010470 FOR I=INT(T5) TO INT(T3)10480 Y7=Y7+Y(I)10490 Y9=Y9+Y(I)^210500 NEXT I10510 T4=T3-T510520 PRINT USING 10240:"MEAN OF ONE CYCLE (AC+DC)","=",Y7/T4,S$10530 PRINT USING 10240:"RMS OF ONE CYCLE (AC+DC)","=",(Y9/T4)^0.5,S$10540 PRINT USING 10240:"PERIOD OF ONE CYCLE","=",T4*S1,R$10550 T4=(T2-T5)/(T3-T5)*10010560 PRINT USING 10240:"SYMMETRY AT 50% LEVEL","=",T4,"%"10570 MOVE T5,V510580 GOSUB 1070010590 MOVE T2,V510600 GOSUB 1070010610 MOVE T3,V510620 GOSUB 1070010630 HOME 10640 DELETE Y7,Y8,Y9,V5,T2,T3,T5,I,I3,T410650 T4=MEMORY10660 SET KEY 10670 RETURN 10700 REM*** SUBROUTINE TO MARK 50% POINT FOR FK#17 ***10710 INPUT @32,24:T5,T610720 PRINT @32,21:T5-2,T6+210730 PRINT @32,20:T5+2,T6-210740 PRINT @32,21:T5-2,T6-210750 PRINT @32,20:T5+2,T6+210760 RETURN 10800 REM*** SUBROUTINE TO MULTIPLY CH1*CH2 STORE RESULTS IN ADD ***10810 SET NOKEY 10820 GOSUB 490010830 PRINT USING "L,26X,FA":"WAVEFORM ANALYSIS"10840 PRI USI "2L,5X,FA":"MULTIPLY CHANNEL1 * CHANNEL2 STORE RESULTS IN"10850 PRINT USING "10X,FA":"ADD CHANNELS"10860 IF LEN(X$)>5 AND LEN(Y$)>5 THEN 1089010870 PRINT USING "2L,5X,FA":"NEDD WAVEFORMS FOR BOTH CHANNELS 1 & 2."10880 RETURN 10890 IF LEN(Z$)<10 THEN 1097010900 PRINT USING "2L,5X,FA":"THERE IS ALREADY DATA IN ADD CHANNEL."10910 PRI USI "10X,FA":"CONTINUING WILL DESTROY THAT DATA. CONTINUE?"10920 PRINT USING "10X,FA,S":"ENTER (YES OR NO) "10930 INPUT V$10940 IF LEN(V$)=0 OR POS("YESNO",V$,1)=0 THEN 1090010950 IF POS("YES",V$,1)>0 THEN 1097010960 RETURN 10970 DELETE Z$,Y3,Y7,V4,Y8,V510980 V4=MEMORY10990 DIM Z$(LEN(Y$)+20),Y3(B2)11000 Z$=Y$11010 REM*** MATCH Y-UNITS OF CHANNEL1 TO CHANNEL2 ***11020 P=POS(Z$,"YUNIT:",75)11030 K$=SEG(Z$,P+6,3)11040 IF POS(K$,",",1)=0 THEN 1107011050 I3=POS(K$,",",1)11060 K$=SEG(K$,1,I3-1)11070 P=POS(X$,"YUNIT:",75)11080 L$=SEG(X$,P+6,3)11090 IF POS(L$,",",1)=0 THEN 1112011100 I3=POS(L$,",",1)11110 L$=SEG(L$,1,I3-1)11120 REM** V4 CORRECTION FACTOR TO MATCH CHANNEL1 TO CHANNEL2 UNITS **11130 V4=111140 IF K$=L$ THEN 1118011150 V4=10^3*(L$="V" AND K$="MV")+10^6*(L$="V" AND K$="UV")11160 V4=V4+10^-3*(L$="MV" AND K$="V")+10^3*(L$="MV" AND K$="UV")11170 V4=V4+10^-6*(L$="UV" AND K$="V")+10^-3*(L$="UV" AND K$="MV")11180 Y7=10^3*(L$="MV")+10^6*(L$="UV")11190 Y7=Y7 MAX 111200 REM*** ANALYZE CH1 & CH2 DATA. CREATE ADD CH DATA ***11210 GOSUB 540011220 GOSUB 280011230 Y3=Y-Y511240 Y3=Y3*Y611250 V5=V1/25*V411260 GOSUB 550011270 GOSUB 280011280 Y=Y-Y511290 Y=Y*Y611300 Y3=Y3*Y11310 V5=V5*(V1/25)11320 Y3=Y3/V511330 Y3=Y3/Y711340 CALL "MIN",Y3,V6,I311350 CALL "MAX",Y3,V7,I311360 V8=127-(V7+V6)/211370 Y3=Y3+V811380 REM*** Y-MULTIPLIER ***11390 V5=INT(V5*10000)/1000011400 L$=STR(V5)11410 L$=SEG(L$,2,LEN(L$))11420 P=POS(Z$,"YMULT:",60)11430 K$=SEG(Z$,P+6,8)11440 IF POS(K$,",",1)=0 THEN 1147011450 I3=POS(K$,",",1)11460 K$=SEG(K$,1,I3-1)11470 Z$=REP(L$,P+6,LEN(K$))11480 REM*** GROUND REFERENCE ***11490 P=POS(Z$,"YOFF:",70)11500 K$=SEG(Z$,P+5,8)11510 IF POS(K$,",",1)=0 THEN 1154011520 I3=POS(K$,",",1)11530 K$=SEG(K$,1,I3-1)11540 V8=INT(V8*1000)/100011550 L$=STR(V8)11560 L$=SEG(L$,2,LEN(L$))11570 Z$=REP(L$,P+5,LEN(K$))11580 REM*** CHANGE TO ADD CHANNEL FROM CHANNEL2 ***11590 Z$=REP("ADD",14,3)11600 REM*** DETERMINE COUPLING ***11610 P=POS(Z$,"WFID:",5)11620 K$=SEG(Z$,P+10,3)11630 I3=POS(X$,"WFID:",5)11640 L$=SEG(X$,I3+10,3)11650 IF K$=L$ THEN 1169011660 IF POS(K$,"""",1)=0 THEN 1168011670 K$=SEG(K$,1,2)11680 Z$=REP("UNK",P+10,LEN(K$))11690 REM*** ANALYZE ADD CHANNEL DATA ***11700 B3=B211710 DELETE Y7,Y8,V4,V5,I3,V1,V811720 V4=MEMORY11730 GOSUB 560011740 GOSUB 1000011750 SET KEY 11760 RETURN 11800 REM*** SUBROUTINE TO DO X VS. Y (PHASE) MEASUREMENTS ***11810 GOSUB 490011820 PRINT USING "2L,25T,FA":"CHANNEL 1 vs. CHANNEL 2 DISPLAY"11830 PRINT USING "30T,FA":"AMPLITUDE UNCALIBRATED"11840 IF LEN(X$)>10 AND LEN(Y$)>10 THEN 1188011850 PRINT USING "2L,10T,FA":"NEED DATA FOR BOTH CHANNELS."11860 PRINT USING "15T,FA":"SELECT ANOTHER FUNCTION"11870 GO TO 1200011880 WINDOW 0,255,0,25511890 VIEWPORT 45,95,25,7511900 MOVE Y1(1),Y2(1)11910 FOR I9=1 TO B11920 DRAW Y1(I9),Y2(I9)11930 NEXT I911940 MOVE 0,011950 DRAW 255,011960 DRAW 255,25511970 DRAW 0,25511980 DRAW 0,011990 HOME 12000 RETURN 12100 REM*** CURSOR ANALYSIS OF WAVEFORM ***12110 GOSUB 490012120 SET NOKEY 12130 GOSUB 280012140 R$=N$12150 S$=Q$12160 Y=Y-Y512170 Y=Y*Y612180 IF V1<1000 THEN 1222012190 V1=V1/100012200 Y=Y/100012210 GOSUB 345012220 DIM Y(500*(B>499)+250*(B<300))12230 IF T1<1000 THEN 1226012240 T1=T1/100012250 GOSUB 340012260 VIEWPORT 16,120,55,9012270 GOSUB 730012280 PRINT @32,21:50,9512290 PRINT "ORIGINAL WAVEFORM"12300 PRINT @32,21:0,4012310 PRINT USING "28T,""CURSOR PARAMETERS"",L":12320 PRINT USING "9T,""CURSOR 1"",33T,""CURSOR 2"",58T,""DELTA""":12330 PRINT USING "3T,3(""VOLTAGE"",5X,""TIME"",8X)":12340 Z9=112350 Z8=500*(B>499)+250*(B<300)12360 Z7=112370 GIN Z5,Z612380 PRINT USING "72(""M""),72(""""),72(""W""),72(""""),72(""8""),S":12390 PRINT USING "72(""""),72(""*""),72(""""),72(""#"")":12400 DELETE U$12410 DIM U$(90)12420 U$="FD.2D,X,2A,14T,FD.2D,X,2A,25T,FD.2D,X,2A,37T,FD.2D,X,2A"12430 U$=U$&"49T,FD.2D,X,2A,62T,FD.2D,X,2A"12440 T9=T1/(50*(B>499)+25*(B<300))12450 REM*** LOOP FOR CURSOR POSITIONING AND READOUTS ***12460 SET KEY 12470 MOVE Z9,Y(Z9)12480 DRAW Z9,Y(Z9)12490 MOVE Z8,Y(Z8)12500 DRAW Z8,Y(Z8)12510 MOVE Z5,Z612520 SET NOKEY 12530 IF Z7 THEN 1255012540 PRINT "
"12550 Z4=Z9*T912560 Z3=Z8*T912570 Z2=ABS(Y(Z9)-Y(Z8))12580 Z1=Z3-Z412590 PRINT USING U$:Y(Z9),S$,Z4,R$,Y(Z8),S$,Z3,R$,Z2,S$,Z1,R$12600 IF Z7 THEN 1246012610 MOVE Z9,Y(Z9)12620 GOSUB 1070012630 MOVE Z8,Y(Z8)12640 GOSUB 1070012650 MOVE Z5,Z612660 PRINT USING "4L,25T,""VALUES BETWEEN CURSORS"",L":12670 DATA 0,-3.0E+302,3.0E+302,012680 RESTORE 1267012690 READ Z7,Z6,Z5,Z412700 FOR I3=Z9 TO Z812710 Z7=Z7+Y(I3)12720 Z6=Z6 MAX Y(I3)12730 Z5=Z5 MIN Y(I3)12740 Z4=Z4+Y(I3)^212750 Z1=Z1+112760 NEXT I312770 U$="10T,""MIN = "",FD.3D,X,2A,45T,""MAX = "",FD.3D,X,2A,L"12780 PRINT USING U$:Z5,S$,Z6,S$12790 U$="10T,""MEAN (AC+DC) = "",FD.4D,X,2A,45T,""RMS (AC+DC) = "","12800 U$=U$&"FD.4D,X,2A,S"12810 PRINT USING U$:Z7/(Z8-Z9),S$,(Z4/(Z8-Z9))^0.5,S$12820 DELETE U$,Z1,Z2,Z3,Z4,Z5,Z6,Z7,Z8,Z9,T912830 I3=MEMORY12840 HOME 12850 RETURN 12900 REM*** NOT ENOUGH ROOM TO DO FFT WITH 3 WAVEFORMS IN MEMORY ***12910 SET KEY 12920 IMAGE P,2L,10T,"NOT ENOUGH ROOM IN MEMORY DELETE A WAVEFORM",2L12930 PRINT USING 12920:12940 IMAGE 20T,2A," DELETE WAVEFORM #",D,L12950 PRINT USING 12940:"1)",112960 PRINT USING 12940:"2)",212970 PRINT USING 12940:"3)",312980 PRINT USING "2L,25T,""ENTER NUMBER "",S":12990 INPUT V$13000 IF LEN(V$)=0 THEN 1290013010 V$=V$&"BAD-1"13020 IF VAL(V$)<1 OR VAL(V$)>3 THEN 1290013030 IF INT(VAL(V$))<>1 THEN 1306013040 DELETE Y1,B1,X$13050 X$=" "13060 IF INT(VAL(V$))<>2 THEN 1309013070 DELETE Y2,B2,Y$13080 Y$=" "13090 IF INT(VAL(V$))<>3 THEN 1312013100 DELETE Y3,B3,Z$13110 Z$=" "13120 H1=MEMORY13130 RETURN  18     ASCII   PROG /UTIL III /  127     
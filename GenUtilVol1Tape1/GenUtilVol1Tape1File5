1000 REM *
1010 REM *  TAPE DUPLICATOR (ASCII)
1020 REM *       DAN TAYLOR, GS SOFT. ENGR., JUNE 1976
1030 REM *
1040 PRINT "	** TAPE DUPLICATOR (ASCII) **"
1050 INIT 
1060 DATA 500,1000
1070 READ A2,A5
1080 PRINT "J_INSERT MASTER AND LEAVE IT IN UNTIL TOLD TO DO OTHERWISE."
1090 PRINT "J_BEGIN WITH FILE # ";
1100 INPUT J2
1110 PRINT "J_  END WITH FILE # ";
1120 INPUT J3
1130 A2=A2 MAX 100
1140 DIM B$(1),C$(1),E$(A2),H$(8),A1((J3-J2 MAX 0)+2)
1150 A3=MEMORY-200
1160 DIM A$(A3)
1170 A5=A5 MAX 0
1180 PRINT "J_DO YOU WANT THE FILES ""MARK""'ED AUTOMATICALLY: ";
1190 INPUT C$
1200 J0=0
1210 IF C$="Y" THEN 1240
1220 IF C$<>"N" THEN 1180
1230 J0=1
1240 PRINT "J_J_"
1250 C$=CHR(13)
1260 H$=C$&C$
1270 H$=H$&H$
1280 H$=H$&"DANT"
1290 A$=""
1300 DATA 0,0,1
1310 READ A0,W0,W1
1320 A4=A3-220
1330 FOR J1=J2 TO J3
1340 PRINT "	READING FILE # ";J1
1350 FIND J1
1360 ON EOF (0) THEN 1450
1370 INPUT @33:E$
1380 IF LEN(A$)>A4 THEN 1530
1390 E$=E$&C$
1400 A$=REP(E$,W1+LEN(A$),W0)
1410 GO TO 1370
1420 REM  *
1430 REM  *                 ALL OF FILE J1 HAS BEEN READ INTO A$
1440 REM  *
1450 A$=REP(H$,W1+LEN(A$),W0)
1460 A0=A0+W1
1470 REM *
1480 REM *                 YOU MIGHT WANT TO CHANGE THE NEXT LINE TO:
1490 REM *                 INPUT A1(A0)     OR MAYBE    A1(A0)=J1+3
1500 REM *
1510 A1(A0)=J1
1520 GO TO 1650
1530 IF A0>W0 THEN 1560
1540 PRINT "J_FILE # ";J1;" IS TOO LONG TO BE READ IN."
1550 END 
1560 PRINT "	NOT ENOUGH ROOM FOR FILE # ";J1
1570 PRINT "	IT WILL BE TRANSFERRED IN THE NEXT BATCH."
1580 J1=J1-W1
1590 GOSUB 1730
1600 A0=W0
1610 A$=""
1620 PRINT "J_ RE-INSERT THE MASTER AND PRESS RETURN. ";
1630 INPUT B$
1640 PRINT "J_"
1650 NEXT J1
1660 IF A$="" THEN 1680
1670 GOSUB 1730
1680 PRINT "J_	ALL FILES TRANSFERRED."
1690 END 
1700 REM  *
1710 REM  *         STORE ONTO DUPLICATE TAPE(S)
1720 REM  *
1730 PRINT "J_READY TO TRANSFER FILES # ";A1(W1);" TO # ";A1(A0)
1740 J6=W1
1750 PRINT "TYPE ""LAST"" AFTER THE LAST COPY HAS BEEN MADE."
1760 PRINT "J_INSERT A DUPLICATE TAPE AND PRESS ""RETURN"" ";
1770 IF J6 THEN 1790
1780 PRINT "OR TYPE ""LAST"".  ";
1790 INPUT B$
1800 PRINT "J_"
1810 IF B$="L" THEN 2130
1820 IF B$<>"" THEN 1760
1830 J6=W1
1840 FOR J5=W1 TO A0
1850 J7=POS(A$,H$,J6)
1860 J8=J6
1870 PRINT USING "16A,3D,S":"	STORING FILE # ";A1(J5);
1880 PRINT USING "8D,"" CHARACTERS"",S":J7-J6
1890 IF J0 THEN 1980
1900 IF A1(J5)>W1 THEN 1930
1910 FIND W0
1920 MARK W1,W1
1930 J9=INT(J7-J6)+A5
1940 FIND A1(J5)
1950 PRINT "   MARK 1,";J9;
1960 MARK W1,J9
1970 GO TO 1980
1980 PRINT 
1990 FIND A1(J5)
2000 IF J7-A2<J6 THEN 2050
2010 FOR J8=J6 TO J7-A2 STEP A2
2020 E$=SEG(A$,J8,A2)
2030 PRINT @33:E$;
2040 NEXT J8
2050 IF J8=J7 THEN 2080
2060 E$=SEG(A$,J8,J7-J8)
2070 PRINT @33:E$;
2080 J6=J7+LEN(H$)
2090 CLOSE 
2100 NEXT J5
2110 J6=W0
2120 GO TO 1760
2130 RETURN 


